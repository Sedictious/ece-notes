\documentclass[11pt,a4paper,notitlepage,fleqn,final]{article}

\input{preamble.tex}

\title{ΣΑΕ 1
	\\
	{ 
		\normalsize Συστήματα Αυτομάτου Ελέγχου I
		\\
		\normalsize Σημειώσεις από τις παραδόσεις
	}}
\date{Οκτώβριος\textendash Ιανουάριος 2017 \textendash~2018
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=1.00]{Liberation Serif}

\hypersetup{pdftitle = {ΣΑΕ 1}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}

\begin{infobox}{Λάθη \& Διορθώσεις}
	Οι τελευταίες εκδόσεις των σημειώσεων βρίσκονται στο Github
	(\url{https://github.com/kongr45gpen/ece-notes/raw/master/sae1.pdf}) ή
	στη διεύθυνση \url{http://helit.org/ece-notes/sae1.pdf}.
	
	Περιέχουν διορθώσεις σε λάθη και τυχόν βελτιώσεις.
	
	\tcblower
	
	Μπορείτε να ενημερώνετε για οποιοδήποτε λάθος και πρόταση
	μέσω PM στο forum, issue στο Github, ή οποιουδήποτε άλλου τρόπου!
\end{infobox}
	
Υπεύθυνη καθηγήτρια: Ζωή Δουλγέρη, ασκήσεις από τον Παπαγεωργίου Δημήτρη - δεν υπάρχει διαχωρισμός ασκήσεων και θεωρίας.

\newpage

\tableofcontents

\newpage

\section{Συστήματα}
Γνωρίζουμε από τα προηγούμενα μαθήματα τι είναι το σύστημα. Σκοπός του μαθήματος είναι να σχεδιάσουμε έναν "ελεγκτή" ώστε ένα σύστημα να έχει μια επιθυμητή έξοδο.

Για παράδειγμα, αν έχουμε έναν κινητήρα που επιθυμούμε να ελέγξουμε, μπορούμε να τον παραστήσουμε με το παρακάτω σχήμα:

\begin{tikzpicture}
\draw (0,0) rectangle (1,1) node[midway] {$\Sigma$};
\draw[->] (1,0.5) -- ++(1,0) node[right] {$y$};
\draw (1.5,0.5) -- (1.5,-1) -- (0,-1);
\draw (0,-0.75) rectangle (-0.5,-1.25) node[midway] {$H$};
\draw[->] (-0.5,-1) -- (-2,-1) -- (-2,0.25);
\draw (-2,0.5) circle (0.25);
\draw[->] (-3,0.5) -- (-2.25,0.5) node[above,midway] {$r$};
\draw (-1.35,0.25) rectangle (-0.65,0.85) node[midway] {$E$};
\draw (-1.75,0.5) -- (-1.35,0.5) ;
\draw (-0.65,0.5) -- (0,0.5) node[above left] {$u$};
\end{tikzpicture}

όπου:
\begin{itemize}
	\item \( \Sigma \) είναι ο κινητήρας
	\item \( u \) είναι η τάση εισόδου (που ρυθμίζουμε εμείς)
	\item \( y \) είναι η έξοδος του συστήματος, εδώ η ταχύτητα του κινητήρα
	\item Η ροπή του φορτίου εκφράζει την είσοδο της διαταραχής
	\item \( H \) είναι ένας μετρητής που μπορούμε να έχουμε για να ελέγχουμε την ταχύτητα
	του κινητήρα
	\item \( E \) είναι ο ελεγκτής που θέλουμε να υλοποιήσουμε, ώστε να ρυθμίζει την
	τάση \( u \) εισόδου του κινητήρα για να πετύχουμε την επιθυμητή ταχύτητα.
\end{itemize}

Έχουμε και μία \textbf{είσοδο αναφοράς} \( r \) που καθορίζει την επιθυμητή έξοδο του συστήματος.

Στα πλαίσια των ΣΑΕ βρίσκουμε το μαθηματικό μοντέλο του συστήματος, καθώς και το μαθηματικό
μοντέλο του ελεγκτή, και τα υλοποιούμε με φυσικό τρόπο (για παράδειγμα μέσω κυκλωματικών
στοιχείων, μικροελεγκτών, arduino κ.ά).

Παραδείγματα συστημάτων αυτομάτου ελέγχου είναι: Τα αμορτισέρ του αυτοκινήτου, οι κινητήρες
των CD drives, οι κινητήρες των γραμμών παραγωγής (ώστε για παράδειγμα να είμαστε σίγουροι
ότι τα υλικά περνάν από έναν κλίβανο ακριβώς για 30 λεπτά, διατηρώντας σταθερή την
ταχύτητα μεταφοράς τους), κ.ά.

\subsection{Μοντελοποίηση συστημάτων}
\paragraph{}
Για το σύστημα ενός σώματος στο οποίο ασκείται δύναμη, έχουμε πολύ απλά:
\[
	F = m\ddot x
\]

Για μια δύναμη ελατηρίου, ισχύει \( F = \kappa \cdot \delta x \), και για μια δύναμη
απόσβεσης/ιξώδους: \( F = d\dot x \)

\paragraph{Ανάρτηση αυτοκινήτου}
Θεωρούμε ότι η ανάρτηση ενός αυτοκινήτου αποτελείται από ένα ελατήριο και έναν αποσβεστήρα:

\begin{tikzpicture}
\draw (0,0) rectangle (2,1) node[midway] {$m$};
\draw (0.5,0) -- ++(0,-0.4)
-- ++(-30:0.2)
-- ++(-150:0.4)
-- ++(-30:0.4)
-- ++(-150:0.4)
-- ++(-30:0.4)
-- ++(-150:0.4)
-- ++(-30:0.2)
-- (0.5,-2);
;
\draw (1.5,0) -- (1.5,-1);
\draw (1.25,-1) -- (1.75,-1);
\draw (1.1,-0.9) -- (1.1,-1.2) -- (1.9,-1.2) -- (1.9,-0.9);
\draw (1.5,-1.2) -- (1.5,-2);

\draw (-0.5,-2) -- (2.5,-2);
\draw[gray] (2.5,1.2) -- (2.5,-2.7);

\draw (1,-2) -- (1,-2.5);
\filldraw (1,-2.5) circle(1pt) node[below left] {$\rho$};

\draw[dashed] (0.5,0) -- (3,0) node[right] {$x_0$};
\draw[dashed] (0.5,-2) -- (3,-2) node[right] {$x_i$};
\end{tikzpicture}

Και όπως πριν προκύπτει η σχέση:
\[
m\ddot x_0 + b(\dot x_0 - \dot x_i) + \kappa (x_0-x_i) = 0
\]
η οποία μπορεί να μετασχηματιστεί κατά Laplace:
\begin{align*}
	m\ddot x_0 + b\dot x_0 + \kappa x_0 &= b\dot x_i + \kappa \dot x_i \\
	ms^2X_0(s) + bsX_0(s) + \kappa X_0(s) &= X_1(s)bs + \kappa X_1(s) \\
	\Aboxed{\frac{X_0(s)}{X_1(s)} &= \frac{bs+\kappa}{ms^2+bs+\kappa} }
\end{align*}



Αυτή είναι μία απλή μέθοδος μοντελοποίησης συστημάτων, αλλά η μοντελοποίηση δεν είναι
αντικείμενο αυτού του μαθήματος.

\subsection{Ορισμοί}

\begin{defn}{Συνάρτηση μεταφοράς}{}
	\begin{itemize}
	\item
	\textbf{Συνάρτηση μεταφοράς:} \(
	\displaystyle G(s) = \frac{Y(s)\quad\text{\small (έξοδος)}}{U(s) \quad
		\text{\small (είσοδος)} }
	= \frac{N(s)\quad \text{\small (αριθμητής)}}{D(s)\quad \text{\small (παρονομαστής)} }
	\)
	\item \textbf{Χαρακτηριστικό πολυώνυμο:} \( D(s) \)
    \end{itemize}
\end{defn}
Θυμόμαστε ότι στα φυσικά συστήματα δεν γίνεται να έχουμε βαθμό του αριθμητή μεγαλύτερο από
το βαθμό του παρονομαστή.
\begin{defn}{Μορφές έκφρασης συνάρτησης μεταφοράς}{}
	\begin{align*}
		H(s) &= \frac{K(s+z_1)\cdots(s+z_m)}{(s+p_1)\cdots(s+p_n)} \\
		H(s) &= \frac{G(1+s\tau_{n+1})\cdots(1+s\tau_{n+m})}{(1+s\tau_1)\cdots(1+s\tau_n)}
		\quad \text{όπου } G=\frac{kz_1\cdots z_m}{p_1\cdots p_m}
	\end{align*}
\end{defn}
\begin{defn}{Πόλοι \& Μηδενικά}{}
	\begin{itemize}
    \item \textbf{Πόλοι} ονομάζονται οι τιμές \( p \) για τις οποίες ισχύει:
    \[
    \mathlarger{\lim_{s\to p}  \left\lvert H(s) \right\rvert} = \infty
    \]
    \item \textbf{Μηδενικά} ονομάζονται οι τιμές \( z \) για τις οποίες ισχύει:
    \[
    \mathlarger{\lim_{s\to z}  \left\lvert H(s) \right\rvert} = 0
    \]
    \end{itemize}
\end{defn}
\begin{defn}{DC κέρδος}{}
	\textbf{DC κέρδος} ονομάζεται η τιμή της συνάρτησης μεταφοράς για \( s = 0\):
	\[
	\text{dc gain} = H(0)
	\]
	
	Ουσιαστικά αντιστοιχεί στην τιμή της απόκρισης σε μοναδιαία βηματική συνάρτηση για
	\( t\to\infty \).
\end{defn}
\begin{theorem}{Σύνδεση εν σειρά}{}
	Όταν συνδέουμε δύο απομονωμένα συστήματα εν σειρά, για τις συναρτήσεις μεταφοράς τους
	ισχύει:
	\[
	G(s) = G_1(s)G_2(s)
	\]
	
	\begin{center}
	\begin{tikzpicture}[scale=1.2]
	\draw[->] (0,0) -- (1,0) node[above,midway] {$X_1(s)$};
	\draw (1,-0.3) rectangle (2,0.3) node[midway] {$G_1(s)$};
	\draw (2,0) -- (3,0) node[above,midway] {$X_2(s)$};
	\draw (3,-0.3) rectangle (4,0.3) node[midway] {$G_2(s)$};
	\draw[->] (4,0) -- (5,0) node[above,midway] {$X_3(s)$};
	\end{tikzpicture}
    \end{center}
\end{theorem}
\paragraph{Παράδειγμα} \hspace{0pt}


\begin{circuitikz}[american,scale=1.4]
	\ctikzset{bipoles/thickness=3}
	\draw (0,2) to [V=$u(s)$] (0,0);
	\draw[color=green!50!black] (0,2)
	to[R=$R_1$] (2,2)
	to[C=$C_1$] (2,0)
	-- (0,0);
	
	\draw[color=green!50!cyan!50!black] (2,2)
	to[R=$R_2$] (4,2)
	to[C=$C_2$] (4,0)
	-- (2,0);
	
	\draw (4,2) to[short,-*] (5,2);
	\draw (4,0) to[short,-*] (5,0);
	\draw (5,2) to[open, v^=$y$] (5,0);
\end{circuitikz}

Για το παραπάνω κύκλωμα, αν και έχουμε δύο συστήματα ενωμένα σε σειρά, δεν μπορούμε να
εφαρμόσουμε το θεώρημα στο παραπάνω κύκλωμα, αφού τα επιμέρους κυκλώματα δεν είναι απομονωμένα
και παρουσιάζουν σύνθετες αντιστάσεις εισόδου και εξόδου. Πράγματι, αν επιλύσουμε το
κύκλωμα:
\begin{align*}
	G_1(s)G_2(s) &= \frac{1}{(R_1C_1s+1)}\frac{1}{(R_2C_2s+1)} \\
	\frac{y(s)}{u(s)} &= \frac{1}{R_1C_1R_2C_2s^2+(R_1C_1+R_2C_2+\underline{R_1C_2})s+1}
\end{align*}
Παρατηρούμε τον όρο \( R_1C_2s \) που δεν υπάρχει στον απλό πολλαπλασιασμό των δύο
συστημάτων.

\begin{exercise}
Ποιές από τις παρακάτω συναρτήσεις μεταφοράς έχουν \textbf{ρυθμούς} (ρίζες του παρονομαστή)
που δεν είναι πόλοι;
\begin{enumroman}
	\item \( \displaystyle \frac{s+8}{(s+3)(s+10)} \)
	\item \( \displaystyle \frac{s+1}{(s+1)^2(s+2)} \)
	\item \( \displaystyle \frac{s+9}{(s+2)^2+9} \)
	\item \( \displaystyle \frac{s+1}{(s+1)(s+2)} \)
\end{enumroman}
\tcblower
\begin{enumroman}
	\item Έχει μηδενικό στο \( -8 \) και πόλους στα \( -3 \) και \( -10 \).
	\item Έχει μόνο έναν πόλο στο \( -1 \) και στο \( -2 \).
	\item Έχει μηδενικό στο \( -9 \) και πόλους στα \( -2+j3 \) και \( -2-j3 \).
	\item Έχει μόνο πόλο στο \( -2 \).
\end{enumroman}

Η λύση αυτή μπορεί να προκύψει από τους ορισμούς του πόλου και του μηδενικού.
\end{exercise}

\subsection{Σύστημα κλειστού βρόχου}

\begin{tikzpicture}[scale=1.3]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0) node[above,midway,green!50!black,scale=0.8] {$w(s)$};
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$G(s)$};
\draw (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw[->] (4.25,0) -- ++(1,0) node[above right] {$y$};

\draw[<-] (4,0.25)  node[left] {$+$} --++ (0,0.5)
node[above,rectangle,align=center,scale=0.8]
{είσοδος\\διαταραχής\\$d(s)$};

\draw (4.5,0) -- ++(0,-1.5) -- (3,-1.5);
\draw (1.5,-2) rectangle (3,-1) node[midway] {$H(s)$};
\draw[->] (1.5,-1.5) -- (0.75,-1.5) node[above,midway,green!50!black,scale=0.8] {$f(s)$} 
-- ++(0,1.25) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Ορίζουμε:
\begin{alignat*}{2}
\text{\textbf{συνάρτηση μεταφοράς κλειστού βρόχου}: } && T(s) &= \frac{y(s)}{r(s)} \\
\text{\textbf{συνάρτηση μεταφοράς εισόδου διαταραχής}: } && T_d(s) &= \frac{y(s)}{d(s)}
\end{alignat*}


Για να υπολογίσουμε την έξοδο του συστήματος, αν δεν λάβουμε υπ' όψιν
την είσοδο διαταραχής:
\begin{align*}
	y(s) &= G(s)w(s)
	\\ &= G(s)\left( r(s)-f(s) \right) \\
	y(s) &= G(s)\left[ r(s)-H(s)y(s) \right] \\
	y(s)\left[1+G(s)H(s)\right] &= G(s)r(s) \\
	y(s) &= \frac{G(s)r(s)}{1+G(s)H(s)} \\
	T(s) &= \frac{G(s)}{1+G(s)H(s)}
\end{align*}

Αν συμπεριλάβουμε και την είσοδο διαταραχής, το ζητούμενο είναι η είσοδος αυτή να μην
επηρεάζει καθόλου (ή όσο το δυνατόν λιγότερο) την έξοδο. Έχουμε:
\begin{align*}
    y(s) &= d(s) + G(s)w(s)
    \\ &= d(s) - G(s)f(s) \\ &= d(s) - G(s)H(s)y(s) \implies \\
    y(s)\left[ 1+G(s)H(s) \right] &= d(s) \implies \\
	T_d(s) &= \frac{y(s)}{d(s)} = \frac{1}{1+G(s)H(s)}
\end{align*}

Συνοπτικά:
\begin{theorem}{Συναρτήσεις μεταφοράς σε σύστημα κλειστού βρόχου}{}
	Για ένα σύστημα κλειστού βρόχου με είσοδο \( r(s) \), είσοδο διαταραχής
	\( d(s) \), συνάρτηση \( G(s) \) στην ευθεία διαδρομή και \( H(s) \) στη
	διαδρομή ανάδρασης, οι συναρτήσεις μεταφοράς είναι:
	\begin{align*}
		T(s) &= \left. \frac{y(s)}{r(s)} \right\rvert_{d(s) = 0}
		= \frac{G(s)}{1+G(s)H(s)} \\
		T_{d}(s) &= \left. \frac{y(s)}{d(s)} \right\rvert_{r(s) = 0}
		=
		\frac{1}{1+G(s)H(s)}
	\end{align*}
	και η συνολική έξοδος του συστήματος είναι:
	\[
	y(s) = T(s)r(s) + T_d(s)d(s)
	\]
\end{theorem}

Παρατηρούμε ότι το χαρακτηριστικό πολυώνυμο είναι το ίδιο στις δύο συναρτήσεις μεταφοράς.

\begin{attnbox}{Συναρτήσεις μεταφοράς ανοιχτού και κλειστού βρόχου}
	Πρέπει να δοθεί προσοχή στη διαφορά των συναρτήσεων μεταφοράς \textbf{ανοιχτού}
	και \textbf{κλειστού} βρόχου.
	
	\begin{center}
		\begin{tikzpicture}
		\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
		\draw (0.75,0) circle (0.25);
		\draw (1,0) -- ++(0.5,0);
		\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$\displaystyle G(s)$};
		\draw (3,0) -- (4,0);
		\draw[->] (4,0) -- ++(1,0) node[above right] {$y$};
		
		\draw (4,0) -- ++(0,-1.5) -- (3,-1.5);
		\draw (1.5,-2) rectangle (3,-1) node[midway] {$\displaystyle H(s)$};
		\draw (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[below right] {$-$};
		\end{tikzpicture}
	\end{center}
	
	Σε ένα σύστημα με μοναδιαία αρνητική ανάδραση, όπως το παραπάνω, η
	\textbf{συνάρτηση μεταφοράς ανοιχτού βρόχου} (ΣΜΑΒ) είναι η \( G(s)H(s) \), ενώ η
	\textbf{συνάρτηση μεταφοράς κλειστού βρόχου} (ΣΜΚΒ) είναι η συνάρτηση μεταφοράς ολόκληρου
	του συστήματος:
	\begin{align*}
	\text{\textbf{συνάρτηση μεταφοράς \textit{ανοιχτού} βρόχου}:} &\quad G(s)H(s)\\
	\text{\textbf{συνάρτηση μεταφοράς \textit{κλειστού} βρόχου}:}&\quad T(s) = \frac{G}{1+GH}
	\end{align*}
\end{attnbox}

\paragraph{Παράδειγμα} \hspace{0pt}

\begin{tikzpicture}
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$\displaystyle\frac{\kappa}{s+a}$};
\draw (3,0) -- (4,0);
\draw[->] (4,0) -- ++(1,0) node[above right] {$y$};

\draw (4,0) -- ++(0,-1.5) -- (3,-1.5);
\draw[dashed] (3,-1.5) -- (1.5,-1.5);
\draw (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[below right] {$-$};
\end{tikzpicture}

Θα υπολογίσουμε την έξοδο του συστήματος \underline{χωρίς ανάδραση} και \underline{με ανάδραση} σε βηματική είσοδο \( r(s) \rightarrow \mathrm u(t) \).
\subparagraph{Χωρίς ανάδραση} \hspace{0pt}

Το σύστημα χωρίς ανάδραση είναι το παραπάνω χωρίς τον κάτω βρόχο:
\begin{tikzpicture}[baseline,scale=0.7]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$\frac{\kappa}{s+a}$};
\draw (3,0) -- (4,0);
\draw[->] (4,0) -- ++(1,0) node[above right] {$y$};
\end{tikzpicture}

Και ισχύει:
\begin{align*}
	y(s) &= r(s)\frac{\kappa}{s+a} \\
	y(s) &= \kappa\frac{1}{s}\frac{1}{s+a} \\
	y(t) &= \kappa\left( 1-e^{\sfrac{-t}{\tau}} \right)
\end{align*}
(όπου η σταθερά χρόνου \( \tau = \frac{1}{a} \))

Για \( t\to \infty \) το αποτέλεσμα είναι \( y(t) = \kappa \).

\subparagraph{Με ανάδραση}
\begin{align*}
	y(s) &= \frac{G(s)r(s)}{1+G(s)} \implies \dots \implies
	\tau' = \frac{1}{a+\kappa}
\end{align*}
Παρατηρούμε πως το σύστημα αυτό φτάνει πολύ πιο γρήγορα στην τελική του τιμή. Αυτό φαίνεται
αν συγκρίνουμε τις σταθερές χρόνου μεταξύ τους, σκεπτόμενοι ότι λειτουργούν ως συντελεστές
στην εκθετική συνάρτηση:

\begin{tikzpicture}
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);

\draw (-1.5,0) node[cross=4pt,thick,blue] {} node[below,yshift=-1mm] {$-a-\kappa$};
\draw (-0.5,0) node[cross=4pt,thick,yellow!50!brown!50!red] {} node[above,yshift=1mm] {$-a$};

\begin{scope}[xshift=4cm]
\draw (-1,0) -- (3,0);
\draw (0,-2) -- (0,2);

\draw [very thick, color=yellow!50!brown!50!red, domain=0:3,variable=\t, samples=\gsamples, smooth]
plot (\t,{ 1-exp(-\t) }) node[below] {$-a$};
\draw [very thick, color=blue, domain=0:3,variable=\t, samples=\gsamples, smooth]
plot (\t,{ 1-exp(-5*\t) }) node[above,xshift=-2cm] {$-a-k$};
\end{scope}
\end{tikzpicture}

\subsection{Ισοδύναμα λειτουργικά διαγράμματα}
Για τη διευκόλυνσή της εύρεσης της συνάρτησης μεταφοράς, μπορούμε αντί να βρούμε την έξοδο
αλγεβρικά χρησιμοποιώντας ενδιάμεσες συναρτήσεις, να εφαρμόσουμε κανόνες όπως τους
παρακάτω:
\begin{infobox}{}
	\begin{itemize}
		\item
		\begin{tikzpicture}[scale=1.3,baseline]
		\begin{scope}[yshift=2mm]
		\draw[->] (0,0) -- (0.75,0);
		\draw (0.75,-0.7/2) rectangle ++(1,0.7) node[midway] {$H$};
		\draw[->] (1.75,0) -- (2.5,0) node[right] {$y_1$};
		\draw[->] (2,0) -- (2,-0.5) -- (2.5,-0.5) node[right] {$y_2$};
		\end{scope}
		
		\draw[->,very thick,gray!20!black] (4,0) to[bend left=10] ++(1.5,0);
		
		\begin{scope}[xshift=6.5cm]
		\draw (0,0) -- (0.5,0);
		\draw (0.5,0) -- (0.5,0.3) -- (1,0.3);
		\draw (0.5,0) -- (0.5,-0.3) -- (1,-0.3);
		\draw (1,-0.5) rectangle (1.7,-0.1) node[midway] {$H$};
		\draw[->] (1.7,-0.3) -- ++(0.5,0) node[right] {$y_2$};
		\draw (1,0.5) rectangle (1.7,0.1) node[midway] {$H$};
		\draw[->] (1.7,0.3) -- ++(0.5,0) node[right] {$y_1$};
		\end{scope}
		\end{tikzpicture}
		\item
		\begin{tikzpicture}[scale=1.3,baseline]
		\begin{scope}[]
		\draw[->] (0,0) -- (0.75,0) node[above,midway] {$u$};
		\draw (0.75,0) -- (0.75,0.5) -- (1.25,0.5);
		\draw (1.25,0.5-0.7/2) rectangle ++(1,0.7) node[midway] {$H$};
		\draw[->] (2.25, 0.5) -- (2.75,0.5) node[right] {$y$};
		\draw[->] (0.75,0) -- (0.75,-0.5) -- (2.75, -0.5) node[right]{$y_1$};
		\end{scope}
		
		\draw[->,very thick,gray!20!black] (4,0) to[bend left=10] ++(1.5,0);
		
		\begin{scope}[xshift=6.5cm,yshift=0.3cm]
		\draw[->] (0,0) -- (0.75,0) node[above,midway] {$u$};
		\draw (0.75,-0.5/2) rectangle ++(0.75,0.5) node[midway] {$H$};
		\draw[->] (1.5,0) -- (2.25,0) node[right] {$y$};
		\draw[->] (1.75,0) -- (1.75,-0.5) -- (2.25,-0.5);
		\draw (2.25,-0.5-0.5/2) rectangle ++(0.75,0.5) node[midway] {$\frac{1}{H}$};
		\draw[->] (3,-0.5) -- ++(0.5,0) node[right] {$y_1$};
		\end{scope}
		\end{tikzpicture}
		\item
		\begin{tikzpicture}[scale=1.3,baseline]
		\begin{scope}[]
		\draw[->] (0,0.5) -- ++(0.75,0);
		\draw (0.75,0.5-0.5/2) rectangle ++(0.75,0.5) node[midway] {$H_1$};
		\draw[->] (1.5,0.5) -- (2.25,0.5) -- (2.25,0.2) node[right,yshift=1mm,xshift=1mm] {$+$};
		\draw[->] (0,-0.5) -- ++(0.75,0);
		\draw (0.75,-0.5-0.5/2) rectangle ++(0.75,0.5) node[midway] {$H_2$};
		\draw[->] (1.5,-0.5) -- (2.25,-0.5) -- (2.25,-0.2);
		\draw (2.25,0) circle (2mm);
		\draw[->] (2.45,0) -- ++(0.75,0) node[above,pos=.9] {$y$};
		\end{scope}
		
		\draw[->,very thick,gray!20!black] (4,0) to[bend left=10] ++(1.5,0);
		
		\begin{scope}[xshift=6.5cm]
		\draw[] (0,0.5) -- ++(0.6,0);
		\draw (0.6,0.5-0.5/2) rectangle ++(1,0.5) node[midway] {$\sfrac{H_1}{H_2}$};
		\draw[->] (1.6,0.5) -- (2.25,0.5) -- (2.25,0.2) node[right,yshift=1mm,xshift=1mm] {$+$};
		\draw[->] (0,-0.5) -- (2.25,-0.5) -- (2.25,-0.2);
		\draw (2.25,0) circle (2mm);
		\draw (3.05,-0.4/2) rectangle ++(0.8,0.4) node[midway] {$H_2$};
		\draw[] (2.45,0) -- ++(0.6,0);
		\draw[->] (3.85,0) -- ++(0.6,0) node[right] {$y$};
		\end{scope}
		\end{tikzpicture}
	\end{itemize}
\end{infobox}

\paragraph{Παράδειγμα} \hspace{0pt}

\begin{tikzpicture}
\def\h{0.6}
\def\l{1}
\def\ll{0.75}
\draw[->] (0,0) node[green!70!black,scale=.8,opacity=.8,left] {$r(s)$} -- (1.5-0.2,0);
\begin{scope}[xshift=1.5cm]
\draw (0,0) circle (2mm);
\draw (0.2,0) -- ++(0.75,0);
\draw (0.2+0.75, -\h/2) rectangle ++(\l, \h) node[midway] {$H_1$};
\draw[->] (\l+0.2+0.75,0) -- (2.8,0) node[green!70!black,scale=.8,opacity=.8,above,midway] {$w(s)$};
\draw (3,0) circle (2mm);
\end{scope}
\begin{scope}[xshift=4.5cm]
\draw (0.2,0) -- ++(0.75,0);
\draw (0.2+0.75, -\h/2) rectangle ++(\l, \h) node[midway] {$H_2$};
\draw[] (\l+0.2+0.75,0) -- (3.5,0) node[right] {$y(s)$};
\end{scope}

\draw (0.5,0) -- ++(0,1.5) -- (4.5,1.5) -- (4.5,1);
\draw (4.5-\ll/2,1) rectangle (4.5+\ll/2,0.6) node[midway] {$\kappa$};
\draw[->] (4.5,0.6) -- (4.5,0.2) node[right,xshift=1mm,yshift=1mm] {$+$};

\draw[->] (4.5+2.5,0) -- ++(0,-1.5) -- (1.5,-1.5) -- (1.5,-0.2) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Χρησιμοποιώντας τους παραπάνω κανόνες, ή την προηγούμενη μέθοδο, μπορούμε να βρούμε:
\[
T(s) = \frac{\kappa H_2(s)+H_2(s)H_1(s)}{1+H_1(s)H_2(s)}
\]

Ενδεικτικά, με βοηθητικές συναρτήσεις, οι πράξεις γίνονται ως εξής:
\begin{align*}
	y(s) &= H_2(s)\cdot\left( \kappa r(s) + w(s) \right)
	\\ &= H_2 \cdot \left[ \kappa r + H_1 \left( r - y \right) \right]
	\\ &= \kappa H_2 r + H_2H_1r - H_1H_2y \implies
	\\ y \cdot (1+H_1H_2) &= \kappa H_2 r + H_2H_1 r \implies
	\\ y &= \frac{\kappa H_2 r + H_2H_1 r}{1+H_1H_2} \implies
	\\ T(s) &= \frac{\kappa H_2(s) + H_2(s)H_1(s) }{1+H_1(s)H_2(s)}
\end{align*}

\newpage

\section{Προδιαγραφές}
Ορίζουμε κάποιες προδιαγραφές που επιθυμούμε να πληροί η έξοδος του συστήματος, όπως η
ακρίβεια θέσης, η ταχύτητα της απόκρισης, η ευστάθεια κλπ. Για να μετρήσουμε ποσοτικά αυτά
τα κριτήρια, ορίζουμε νέα μεγέθη και χρησιμοποιούμε διάφορες συναρτήσεις ως
"εισόδους αναφοράς", όπως την κρουστική \( \delta(t) \) (για μελέτη ευστάθειας),
τη βηματική \( \mathrm u(t) \), την ράμπα, την ημιτονοειδή (για μελέτη
απόκρισης συχνότητας και ταχύτητας) κλπ.

\subsection{Ακρίβεια}
Το ζητούμενο της ακρίβειας είναι η τελική έξοδος να είναι κοντά στην επιθυμητή είσοδο.

Για να υπολογίσουμε την τελική έξοδο, δεν χρειάζεται να υπολογίσουμε τον αντίστροφο Μ/Σ
Laplace της συνάρτησης για να πάμε στο πεδίο του χρόνου, αλλά αρκεί να χρησιμοποιηθεί το θεώρημα της τελικής τιμής:
\[
f(\infty) = \lim_{s\to 0} sF(s)
 \]

Για παράδειγμα, για βηματική είσοδο (\( \mathrm u(t) \rightarrow \frac{1}{s}\))
σε ένα σύστημα (ss = steady state):
\begin{align*}
	y_{\mathrm{ss}} &= \lim_{s\to 0} sF(s) = \lim_{s\to 0} sH(s)\frac{1}{s} =
	\lim_{s\to 0} H(s)
\end{align*}

\begin{comment}
\begin{tikzpicture}
\def\h{0.6}
\def\l{1.2}
\def\ll{0.75}
\draw[->] (0,0) node[left] {$r(s)$} -- (1-0.2,0);
\begin{scope}[xshift=1cm]
\draw (0,0) circle (2mm);
\draw (0.2,0) -- ++(0.75,0);
\draw (0.2+0.75, -\h/2) rectangle ++(\l, \h) node[midway] {$G_1(s)$};
\draw (\l+0.2+0.75,0) -- (3,0);
\draw  (3, -\h/2) rectangle ++(\l, \h) node[midway] {$G_2(s)$};
\draw (3+\l,0) -- (5-0.2,0);
\draw[->] (5,1) -- ++(0,-1+0.2) node[midway,right] {$d(s)$};
\draw (5,0) circle (2mm);
\draw[->] (5+0.2,0) -- ++(1,0) node[right] {$y$};
\end{scope}

\draw[->] (4.5+2.2,0) -- ++(0,-1.5) -- (4,-1.5);
\draw (4,-1.5-\h/2) rectangle ++(-\l,\h) node[midway] {$H(s)$};
\draw[->] (4-\l,-1.5) -- (1,-1.5) -- (1,-0.2);
\end{tikzpicture}
\end{comment}

Για να μελετήσουμε την ακρίβεια, ορίζουμε το σφάλμα:
\begin{defn}{Σφάλμα}{}
	Ορίζουμε το \textbf{σφάλμα} ως τη διαφορά της εξόδου από την είσοδο:
	\[
	e(s) = r(s) - y(s)
	\]
\end{defn}

Χρησιμοποιούμε διάφορες εισόδους για να βρούμε διάφορα είδη σφαλμάτων του συστήματος:

\begin{infobox}{Είσοδοι για μελέτη σφαλμάτων}
\begin{alignat*}{5}
\begin{tikzpicture}[scale=0.4,baseline]
\draw (-0.2,0) -- (2,0);
\draw (0,-0.2) -- (0,2);
\draw [very thick, color=blue] (0,1.8) -- (2,1.8);
\end{tikzpicture}\quad
r(t) &= \mathrm u(t) &&\quad r(s) = \frac{1}{s} &\qquad e_{\mathrm ssp} & \quad{\text{σφάλμα \textbf{θέσης}}} \\
\begin{tikzpicture}[scale=0.4,baseline]
\draw (-0.2,0) -- (2,0);
\draw (0,-0.2) -- (0,2);
\draw [very thick, color=blue] (0,0) -- (2,2);
\end{tikzpicture}\quad
r(t) &= t &&\quad r(s) = \frac{1}{s^2} &\qquad e_{\mathrm ssv} & \quad{\text{σφάλμα \textbf{ταχύτητας}}} \\
\begin{tikzpicture}[scale=0.4,baseline]
\draw (-0.2,0) -- (2,0);
\draw (0,-0.2) -- (0,2);
\draw [very thick, color=blue, domain=0:2,variable=\t, samples=\gsamples, smooth]
plot (\t,\t^2/2);
\end{tikzpicture}\quad
r(t) &= \sfrac{t^2}{2} &&\quad r(s) = \frac{1}{s^3} &\qquad e_{\mathrm ssa} & \quad{\text{σφάλμα \textbf{επιτάχυνσης}}}
\end{alignat*}
\end{infobox}

Για παράδειγμα, για το σύστημα κλειστού βρόχου, θυμόμαστε ότι:

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw (3.6,0) -- ++(0,-1.5) -- (3,-1.5) -- (1.5,-1.5);
\draw[dashed] (1.5,-2) rectangle (3,-1) node[midway,opacity=.5] {$G(s)$};
\draw[->] (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Αν θεωρήσουμε ότι η \( G(s) \) είναι \( 1 \), τότε:
\begin{align*}
	\frac{y(s)}{r(s)} &= \frac{H(s)}{1+H(s)} \\
	\text{όπου } H(s) &=
	\frac{G(τ_{n+1}s+1)\cdots(τ_{n+m}s+1)}{s^N(1+sτ_1)\cdots(1+sτ_n)} \implies
	\\
	e(s) &= r(s)-y(s) = \frac{1}{1+H(s)}r(s)
\intertext{Τώρα μπορούμε να υπολογίσουμε το σφάλμα \textbf{σταθερής κατάστασης},
	χρησιμοποιώντας το θεώρημα τελικής τιμής:}
	e_{\mathrm{ss}} &= \lim_{s\to 0}se(s)
\end{align*}
(δηλαδή \( N \) είναι η τάξη του τυχόν πόλου στο 0).

Εφαρμόζοντας τις διάφορες συναρτήσεις ως εισόδους, σύμφωνα με τα παραπάνω, έχουμε:
\begin{alignat*}{3}
	e_{\mathrm{ssp}} &= \frac{1}{\displaystyle 1+\underbrace{\lim_{s\to 0}H(s)}_{K_\mathrm{pos}}}
	= \frac{1}{1+{\color{green!50!black}K_\mathrm{pos}}}
	&&= \begin{cases}
	\frac{1}{1+{\color{green!50!black}G}} \qquad &\text{για } N = 0 \\
	\frac{1}{1+{\color{green!50!black}\infty}} = 0 \qquad &\text{για } N \geq 1
	\end{cases}
	\\
	e_{\mathrm{ssv}} &= \frac{1}{\displaystyle \underbrace{\lim_{s\to 0} sH(s)}_{K_v} }
	= \frac{1}{\color{cyan!50!black}K_v} &&=
	\begin{cases}
	\frac{1}{\color{cyan!50!black}0} = \infty \qquad &\text{για } N = 0
	\\
	\frac{1}{\color{cyan!50!black}G}\qquad &\text{για } N=1
	\\
	\frac{1}{\color{cyan!50!black}\infty} = 0\qquad &\text{για } N\geq 2
	\end{cases}
	\\
	e_{\mathrm{ssa}} &= \frac{1}{\displaystyle \underbrace{\lim_{s\to 0} s^2H(s)}_{K_a}}
	= \frac{1}{\color{orange!50!black}K_a}
	&&= \begin{cases}
	\infty \qquad &\text{για } N \leq 1 \\
	\frac{1}{\color{orange!50!black} G} \qquad &\text{για } N = 2 \\
	0 \qquad &\text{για } N > 2
	\end{cases}
\end{alignat*}

Δε συζητάμε για ακρίβειες πέραν της επιτάχυνσης, επειδή σπάνια τα συστήματα έχουν πάνω από
2 ολοκληρωτές.

\begin{defn}{Ολοκληρωτής}{}
	Ένας \textbf{πόλος στο 0} λειτουργεί σαν \textbf{ολοκληρωτής}, επειδή
	έχει την ιδιότητα να ολοκληρώνει το σήμα εισόδου.
\end{defn}
\begin{defn}{Τύπος συστήματος}{}
	Ο \textbf{τύπος του συστήματος} είναι ο αριθμός των ολοκληρωτών που έχει.
\end{defn}
\begin{attnbox}{Σφάλματα στο κλειστό σύστημα}
	Στους παραπάνω τύπους χρησιμοποιήσαμε τη
	\textbf{συνάρτηση μεταφοράς ανοιχτού βρόχου} \( H(s) \)
	για να βρούμε το σφάλμα στην απόκριση του \textbf{κλειστού βρόχου}, σε σύστημα
	\textbf{μοναδιαίας αρνητικής ανάδρασης}.
	
	Αν έχουμε στη διάθεσή μας μόνο τη συνάρτηση μεταφοράς του κλειστού βρόχου ή κάποια
	άλλη μορφή συστήματος, θα πρέπει να καταφύγουμε στον τύπο \( e(s) = r(s) - y(s) \) ή
	σε κάποιο άλλο μαθηματικό κόλπο.
\end{attnbox}

\paragraph{Παράδειγμα}
Έστω το σύστημα:

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw[->] (4.25,0) -- ++(1,0) node[above right] {$y$};
\draw ({(3+1.5)/2},0.5) node[above] {$\frac{1}{s(s+a)}$};

\draw[<-] (4,0.25)  node[right,xshift=1mm,yshift=1mm] {$+$} --++ (0,0.5)
node[above,rectangle,align=center,scale=0.8]
{$d(s)=\frac{1}{s}$};

\draw[->] (4.5,0) -- ++(0,-1.5) -- (0.75,-1.5) -- ++(0,1.25)
node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Ποιά θα είναι η έξοδος του συστήματος στη μόνιμη κατάσταση αν προσθέσουμε την είσοδο
διαταραχής;

\subparagraph{}

Αν δεν υπήρχε η διαταραχή, θα είχαμε σφάλμα θέσης μόνιμης κατάστασης
\( e_{\mathrm{ssp}} = 0 \), αφού η \( H(s) \) έχει έναν ολοκληρωτή.

Επομένως αγνοούμε την επίδραση της \( r(s) \), και υπολογίζουμε την έξοδο αν
υπάρχει μόνο η διαταραχή.

Γνωρίζουμε για το σύστημα κλειστού βρόχου ότι:
\begin{align*}
	\frac{y(s)}{d(s)} &= \frac{1}{1+H(s)} \\
	\lim_{s\to 0}sy(s) &= \lim_{s\to 0} s\frac{d(s)}{1+H(s)}
	= \lim_{s\to 0} s\frac{\frac{1}{s}}{1+H(s)} = \lim_{s\to 0}\frac{1}{1+H(s)} = 0
%	\frac{y(s)}{r(s)} &= \frac{H(s)}{1+H(s)}\\
%	y(s) &= \frac{H(s)}{1+H(s)}r(s) + \frac{1}{1+H(s)}d(s)
\end{align*}
Δηλαδή \( y_{\mathrm{ss}} = 0 \), άρα το σύστημα έχει πάλι τέλεια ακρίβεια, και σφάλμα θέσης
0.

\paragraph{Παράδειγμα} \hspace{0pt}

Το παρακάτω διάγραμμα αντιστοιχεί σε έναν κινητήρα:

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$κ$};
\draw (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw (5,-0.5) rectangle (6.5,0.5) node[midway] {$\frac{1}{s(Js+b)}$};
\draw (4.25,0) -- (5,0);
\draw[->] (6.5,0) -- ++(1,0) node[above right] {$y$};

\draw[<-] (4,0.25)  node[right,xshift=1mm,yshift=1mm] {$+$} --++ (0,0.5)
node[above] {$d$};

\draw[->] (7,0) -- ++(0,-1.5) -- (0.75,-1.5) -- ++(0,1.25)
node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Το μετασχηματίζουμε στο ισοδύναμό του, ώστε να εφαρμόσουμε τους τύπους κλειστού βρόχου:

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$κ$};
\draw (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw (6,-0.5) rectangle (7.5,0.5) node[midway] {$\frac{1}{s(Js+b)}$};
\draw (4.25,0) -- (6,0);
\draw[->] (7.5,0) -- ++(1,0) node[above right] {$y$};

\draw[<-] (4,0.25)  node[right,xshift=1mm,yshift=1mm] {$+$} --++ (0,0.5)
node[above] {$d$};


\draw[->] (5,0) -- ++(0,-1.5) -- (3.5,-1.5);
\draw[->]  (2,-1.5) -- (0.75,-1.5) -- ++(0,1.25)
node[right,xshift=1mm,yshift=-1mm] {$-$};

\draw (2,-1.5-0.5) rectangle (3.5,-1.5+0.5) node[midway] {$\frac{1}{s(Js+b)}$};
\end{tikzpicture}

Τότε προκύπτει (για είσοδο \( \frac{1}{s} \), αφού αναζητούμε σφάλμα θέσης):
\begin{align*}
    T(s) &= \frac{1}{s(Js+b)}\frac{κ}{1+\frac{κ}{s(Js+b)}} 
    = \frac{κ}{s(Js+b)+κ}\\
    T_{d}(s) &= \frac{1}{s(Js+b)}\frac{1}{1+\frac{κ}{s(Js+b)}}
    = \frac{1}{s(Js+b)+κ}
     \\
    y(s) &= T(s)r(s) + T_d(s)d(s)
    \\ &= \frac{1}{s}\frac{κ}{s(Js+b)+κ} + \frac{1}{s}\frac{1}{s(Js+b)+κ}
    \\
    e(s) &= r(s) - y(s) \\
    e_{\mathrm{ssp}} &= \lim_{s\to 0} se(s)
    \\ &= \lim_{s \to 0} s\left[
    \frac{1}{s} - \frac{1}{s}\frac{κ}{s(Js+b)+κ} - \frac{1}{s}\frac{1}{s(Js+b)+κ}
    \right]
    \\
    &= \lim_{s\to 0} \left[
    1 - \frac{κ}{s(Js+b)+κ} - \frac{1}{s(Js+b)+κ}
    \right] \\
    &= 1-\frac{κ}{κ}-\frac{1}{κ} = -\frac{1}{κ}
\end{align*}
Δηλαδή βλέπουμε ότι η διαφορετική θέση της εισόδου διαταραχής επηρεάζει το σφάλμα θέσης του
συστήματος.

Αν, προσπαθώντας να μειώσουμε στο 0 το σφάλμα της εξόδου, προσθέσουμε έναν ολοκληρωτή
πριν από την είσοδο διαταραχής:

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$\sfrac{κ}{\color{cyan!70!black} s}$};
\draw (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw (5,-0.5) rectangle (6.5,0.5) node[midway] {$\frac{1}{s(Js+b)}$};
\draw (4.25,0) -- (5,0);
\draw[->] (6.5,0) -- ++(1,0) node[above right] {$y$};

\draw[<-] (4,0.25)  node[right,xshift=1mm,yshift=1mm] {$+$} --++ (0,0.5)
node[above] {$d$};

\draw[->] (7,0) -- ++(0,-1.5) -- (0.75,-1.5) -- ++(0,1.25)
node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

τότε το χαρακτηριστικό πολυώνυμο του συστήματος γίνεται:
\[
Js^3+bs^2+κ = 0
\]
που έχει ρίζες στο δεξί ημιεπίπεδο, άρα οδηγεί σε ασταθές σύστημα (θυμόμαστε από τα Κ3 ότι μόνο τα πολυώνυμα με θετικούς συντελεστές \textit{μπορεί} να οδηγήσουν σε ευστάθεια).

Για να διορθώσουμε αυτήν την ατέλεια, χρησιμοποιούμε έναν \textbf{ελεγκτή PI}
(Proportional \& Integral), δηλαδή πολλαπλασιάζουμε την είσοδό του \( e(t) \) 
με \( K_P e(t) \) και ολοκληρώνουμε με
\( K_I \int e(t) \).

\begin{defn}{Ελεγκτής PI}{}
Ο \textbf{ελεγκτής PI} (Proportional \& Integral) είναι ένας ολοκληρωτής που
προσθέτει το αποτέλεσμα του \textbf{πολλαπλασιασμού} και της
\textbf{ολοκλήρωσης} στην είσοδό του.
	
Σύμφωνα με την παραπάνω παράγραφο, η έξοδος \( u(t) \) ενός ελεγκτή PI είναι:
\[
u(t) = K_P\cdot r(t) + K_I \int r(t) \dif t
\]
(όπου \( r \) η είσοδος)
και, μετασχηματίζοντας κατά Laplace:
\[
u(s) = \left( K_P + \frac{K_I}{s} \right) \cdot r(s) =
\frac{K_P\left( s+\frac{K_I}{K_P} \right) \cdot r(s)}{s}
= \frac{K_P(s+z)}{s} \cdot r(s)
\]
όπου \( z = \frac{K_I}{K_P} \) μία σταθερή τιμή.

Παρατηρούμε ότι ο ελεγκτής αυτός ουσιαστικά εισάγει έναν \textbf{ολοκληρωτή}
και ένα \textbf{μηδενικό}.
\end{defn}

Στο συγκεκριμένο παράδειγμα, αντικαθιστούμε τη συνάρτηση μεταφοράς \( \sfrac{κ}{s}  \) με
τη συνάρτηση:
\[
K_p\left(\frac{s+z}{s}\right)
\]
όπου \( z = \frac{K_I}{K_P} \),
και το χαρακτηριστικό πολυώνυμο γίνεται:
\[
x(s) = Js^3 + bs^2 + K_p s + K_I = 0
\]
που μπορεί να είναι ευσταθές με κατάλληλη επιλογή των σταθερών.

\paragraph{Παράδειγμα} \hspace{0pt}

Στο σύστημα χωρίς βρόχο, δεν μπορούμε να χρησιμοποιήσουμε τους τύπους, αλλά πρέπει
να εκμεταλλευτούμε τον ορισμό του σφάλματος:

\begin{tikzpicture}[scale=0.9]
\draw[->] (0,0) -- (1.5,0) node[above,midway] {$r(s)$};
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H_κ(s)$};
\draw[->] (3,0) -- ++(1.5,0) node[above,midway] {$y(s)$};
\end{tikzpicture}

\begin{align*}
	e_{\mathrm{ssp}} &= \lim_{s\to 0} se(s)
	= \lim_{s\to 0}s \left( r(s) - y(s) \right)
	= \lim_{s\to 0}s\left( \frac{1}{s} - H_κ(s)\cdot \frac{1}{s} \right)
	= \lim_{s\to 0}\left(1-H_κ(s)\right) \\
	e_{\mathrm{ssv}} &= \lim_{s\to 0} \frac{1-H_κ(s)}{s} \\
	e_{\mathrm{ssa}} &= \lim_{s\to 0} \frac{1-H_κ(s)}{s^2}
\end{align*}

\begin{exercise}

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw[->]  (3.6,0) -- ++(0,-1.5) -- (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

\[
H(s) = \frac{s+9}{s^2+7s+3}
\]

Τι σφάλμα θέσης έχει το παραπάνω σύστημα;
\tcblower

\begin{align*}
	e_{\mathrm{ssp}} &= \frac{1}{1+K_{\mathrm{pos}}} \\
	K_{\mathrm{pos}} &= \lim_{s\to 0} H(s) = \frac{9}{3} = 3 \implies \\
	e_{\mathrm{ssp}} &= \frac{1}{1+3} = \frac{1}{4}.
\end{align*}
\end{exercise}


\begin{exercise}

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw[->]  (3.6,0) -- ++(0,-1) -- (1.5,-1) -- (0.75,-1) -- ++(0,0.75) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Στο παραπάνω σχήμα, θέτουμε:
\[
H(s) = \frac{2(s+10)}{s(s+2)(s+5)}
\]

Τι σφάλματα έχει το παραπάνω σύστημα;
\tcblower
\begin{alignat*}{2}
K_{\mathrm{pos}} &= \infty \\
K_{\mathrm v}	 &= \lim_{s\to 0} sH(s) &&= \frac{20}{10} = 2 \\
K_{\mathrm a}    &= 0 \\[2ex]
e_{\mathrm{ssp}} &= \frac{1}{1+\infty} &&= 0 \\
e_{\mathrm{ssv}} &= \frac{1}{K_{\mathrm v}} &&= \frac{1}{2} \\
e_{\mathrm{ssa}} &= \frac{1}{0} &&= \infty
\end{alignat*}
\end{exercise}


\begin{exercise}

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw[->]  (3.6,0) -- ++(0,-1) -- (1.5,-1) -- (0.75,-1) -- ++(0,0.75) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Στο παραπάνω σχήμα:
\[
H(s) = \frac{1.8κ}{s(s+3.3)}
\]

Ποιά πρέπει να είναι η σταθερά \( κ \) ώστε να ισχύει \( e_{\mathrm{ssv}} = 0.327 \);
\tcblower
\begin{align*}
	K_{\mathrm{v}} &= \lim_{s\to 0}
	sH(s) = \lim_{s \to 0} \frac{1.8κ}{s+3.3} = \frac{18κ}{33} \\
	e_{\mathrm{ssv}} &= \frac{1}{K_{\mathrm v}}
	= \frac{33}{18κ} = 0.327 \implies \\
	κ &= \frac{33}{18\cdot 0.327} \simeq 5.607
\end{align*}
\end{exercise}


\begin{exercise}
Δίνεται η συνάρτηση μεταφοράς \textbf{κλειστού βρόχου} ενός συστήματος:
\[
H_{κ}(s) = \frac{κs+b}{s^2+as+b}
\]

Ποιά είναι τα σφάλματα του συστήματος, και ποιά είναι η συνάρτηση μεταφοράς
\textbf{ανοιχτού βρόχου}, αν προέρχεται
από σύστημα \textit{μοναδιαίας αρνητικής ανάδρασης};

\tcblower

\subparagraph{Σφάλματα}
\begin{alignat*}{2}
	e_{\mathrm{ssp}} &= \lim_{s\to 0}\left[1-H_κ(s)\right] = 1-\frac{b}{b} &&= 0 \\
	e_{\mathrm{ssv}} &= \lim_{s\to 0}\left[\frac{1-H_κ(s)}{s}\right] &&= \frac{a-κ}{b} \\
	e_{\mathrm{ssa}} &= \lim_{s\to 0}\left[\frac{1-Η_κ(s)}{s^2}\right] &&= \infty
\end{alignat*}
\subparagraph{Συνάρτηση μεταφοράς} \hspace{0pt}

\begin{tikzpicture}[scale=0.8,every node/.style={scale=.8}]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H(s)$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw[->]  (3.6,0) -- ++(0,-1.5) -- (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

Γνωρίζουμε ή βρίσκουμε ότι, για συστήματα κλειστού βρόχου:
\[
H_κ(s) = \frac{H(s)}{1+H(s)}
\]
άρα:
\begin{align*}
	H_κ(1+H) &= H \implies \\
	H_κ + H_κH &= H \implies \\
	H(1-H_κ) &= H_κ \implies \\
	H &= \frac{H_κ}{1-H_κ} \implies \\
	H &= \frac{\frac{κs+b}{s^2+as+b}}{1-\frac{ks+b}{s^2+as+b}}
	= \frac{\frac{κs+b}{\cancel{s^2+as+b}}}{\frac{s^2+as+b-ks-b}{\cancel{s^2+as+b}}}
	\implies \\
	\Aboxed{H(s) &= \frac{κs+b}{s(s+a-κ)}}
\end{align*}

\end{exercise}


\begin{exercise}

\begin{tikzpicture}
\draw[->] (-0.1,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,-0.1) -- (0,3);

\draw[dashed] (0,1.4) node[left] {$0.5$} -- ++(3,0);
\draw[dashed] (0,2.8) node[left] {$1$} -- ++(3,0);

\draw[very thick, blue!80!green]
plot[samples=10,variable=\x,domain=0:3,smooth]
({\x},{0.2/(0.01+2*\x)*sin(2*\x r)+1.4*(1-exp(-4*\x))})
node[right] {$y(t)$};

\foreach \i in {1,2,3}
\draw(\i*2.5/3,0.05) -- ++(0,-0.1) node[below] {$\i$};
\end{tikzpicture}

Έστω το σύστημα με την παραπάνω απόκριση στη βηματική συνάρτηση. Ποιός είναι ο τύπος του
συστήματος;

\tcblower

\begin{tikzpicture}
\draw[dashed] (0,1.4) node[left] {$0.5$} -- ++(3,0);
\draw[dashed] (0,2.8) node[left] {$1$} -- ++(3,0);

\draw[very thick, blue!80!green]
plot[samples=10,variable=\x,domain=0:3,smooth]
({\x},{0.2/(0.01+2*\x)*sin(2*\x r)+1.4*(1-exp(-4*\x))})
node[right] {$y(t)$};

\draw[very thick, blue!40!cyan]
(0,2.8) -- ++(3,0) node[right] {$r(s)$};

\draw[thin,<->,blue!40!cyan]
(1.5,2.7) -- ++(0,-1.2) node[midway,right,scale=.8] {$0.5$};

\foreach \i in {1,2,3}
\draw(\i*2.5/3,0.05) -- ++(0,-0.1) node[below] {$\i$};

\draw[->] (-0.1,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,-0.1) -- (0,3);
\end{tikzpicture}

Η επιθυμητή έξοδος του συστήματος είναι 1, αλλά η έξοδός του στη μόνιμη κατάσταση είναι 0.5,
επομένως υπάρχει σταθερό σφάλμα \( 0.5 \). Άρα το σύστημα έχει τύπο \( 0 \).

Γνωρίζουμε ότι, αφού είναι τύπου \( 0 \), θα έχει άπειρο σφάλμα ταχύτητας. Πράγματι, αν
βάλουμε ως είσοδο τη συνάρτηση ράμπας, το σφάλμα όσο \( t \to \infty \) θα αυξάνεται όλο
και περισσότερο:

\begin{tikzpicture}
\draw[dashed] (0,2.6/3) node[left] {$1$} -- ++(3,0);
\draw[dashed] (0,2.6) node[left] {$3$} -- ++(3,0);

\begin{scope}
\pgfmathsetseed{22}
\clip  (0,0) --
plot[samples=10,variable=\x,domain=0.1:3,smooth]
({\x},{0.2*\x+0.1*rand}) -- (3,3) -- (0,0);
\fill[draw=yellow!50!black,opacity=.5,fill=yellow!50!white,postaction={pattern=vertical lines}] (0,0) -- (3,3) -- (3,0) -- cycle;
\end{scope}

\pgfmathsetseed{22}
\draw[very thick, blue!80!green] (0,0) --
plot[samples=10,variable=\x,domain=0.1:3,smooth]
({\x},{0.2*\x+0.1*rand})
node[right] {$y(t)$};

\draw[very thick, blue!40!cyan]
(0,0) -- (3,3) node[right] {$r(s)$};

\foreach \i in {1,2,3}
\draw(\i*2.5/3,0.05) -- ++(0,-0.1) node[below] {$\i$};

\draw[->] (-0.1,0) -- (3,0) node[below right] {$t$};
\draw[->] (0,-0.1) -- (0,3);
\end{tikzpicture}

\end{exercise}


\begin{exercise}

Ποιά είναι τα σφάλματα του παρακάτω συστήματος;

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$\displaystyle \frac{κ}{Js^2}$};
\draw (3,0) -- (3.75,0);
\draw[->] (3.25,0) -- ++(1,0) node[above right] {$y$};

\draw (3.6,0) -- ++(0,-1.5) -- (3,-1.5);
\draw (1.5,-2) rectangle (3,-1) node[midway] {$1+bs$};
\draw[->] (1.5,-1.5) -- (0.75,-1.5) -- ++(0,1.25) node[right,xshift=1mm,yshift=-1mm] {$-$};
\end{tikzpicture}
\tcblower

Επειδή δεν έχουμε μοναδιαία αρνητική ανάδραση, δεν μπορούμε να εφαρμόσουμε τους τύπους
σφάλματος για συστήματα μοναδιαίας αρνητικής ανάδρασης.

Βρίσκουμε τη συνάρτηση μεταφοράς κλειστού βρόχου:
\begin{align*}
	y &= H(s)\left(r-G(s)y\right) = \dots = \frac{H(s)}{1+H(s)G(s)}
	= \frac{\sfrac{κ}{Js^2} }{1+bs}
	= \frac{κ}{Js^2 + κbs + κ}
\end{align*}

Επομένως μπορούμε να εφαρμόσουμε τους τύπους σφάλματος χωρίς βρόχο:
\[
e_{\mathrm{ssp}} = 0 \hspace{100pt}
e_{\mathrm{ssv}} = b \hspace{100pt}
e_{\mathrm{ssa}} = \infty
\]
\end{exercise}


\begin{exercise}

\begin{tikzpicture}[scale=1]
\draw[->] (-0.25,0) -- (0.5,0) node[above,midway] {$r(s)$};
\draw (0.75,0) circle (0.25);
\draw (1,0) -- ++(0.5,0);
\draw (1.5,-0.5) rectangle (3,0.5) node[midway] {$H_1(s)$};
\draw[->] (3,0) -- (3.75,0);
\draw (4,0) circle (0.25);
\draw (5,-0.5) rectangle (6.5,0.5) node[midway] {$H_2(s)$};
\draw[->] (4.25,0) -- (5,0);
\draw[->] (6.5,0) -- ++(1,0) node[above right] {$y$};

\draw[<-] (4,0.25)  node[right,xshift=1mm,yshift=1mm] {$+$} --++ (0,0.5)
node[above] {$d(s)$};

\draw[->] (7,0) -- ++(0,-1.5) -- (0.75,-1.5) -- ++(0,1.25)
node[left,xshift=-1mm,yshift=-1mm] {$-$};
\end{tikzpicture}

\begin{enumgreekparen}
	\item
	\( \displaystyle
	H_1(s) = \frac{s+2}{s+1} \qquad
	H_2(s) = \frac{10}{s(s+6)}
	 \)
	\item
	\( \displaystyle
	H_1(s) = \frac{s+2}{s(s+1)} \qquad
	H_2(s) = \frac{10}{s+6}
	 \)
\end{enumgreekparen}
Να βρεθούν και στις δύο περιπτώσεις τα σφάλματα θέσης και ταχύτητας με διάφορες
περιπτώσεις διαταραχών.


\tcbsubtitle{Λύση, αν δεν υπάρχει διαταραχή d(s)}
\begin{enumgreekparen}
\item Έχουμε μοναδιαία αρνητική ανάδραση και το σύστημα έχει έναν ολοκληρωτή, άρα είναι τύπου 1.
Το σφάλμα θέσης είναι \( e_{\mathrm{ssp}} = 0 \), και το σφάλμα ταχύτητας μία σταθερά
\(
\displaystyle e_{\mathrm{ssv}}=\frac{1}{K_{\mathrm v}} = \frac{1}{\lim_{s\to 0} sH(s)}
= \frac{1}{\lim_{s\to 0}s\frac{s+2}{s+1}\frac{10}{s(s+6)}}
=\frac{1}{\sfrac{20}{6} }=\frac{3}{10}
 \).

 
\item
Αντίστοιχα με το προηγούμενο ερώτημα, έχουμε:
\begin{align*}
K_{\mathrm{pos}} &=
\lim_{s\to 0} H(s) = \lim_{s\to 0}
\frac{s+2}{s(s+1)}\frac{10}{s+6} = \infty \\
K_{\mathrm{v}} &=
\lim_{s\to 0}sH(s) = \lim_{s\to 0}
\frac{s+2}{s+1}\frac{10}{s+6} = 2\cdot\frac{10}{6} = \frac{10}{3}
\intertext{Άρα:}
e_{\mathrm{ssp}} &= \frac{1}{1+K_{\mathrm{pos}}} = 0 \\
e_{\mathrm{ssv}} &= \frac{1}{K_{\mathrm v}} = \frac{3}{10}
\end{align*}
\end{enumgreekparen}


\tcbsubtitle{Λύση με διαταραχή \( d(s) = \frac{A}{s} \)}
Υπολογίζουμε:
\begin{align*}
	y &= H_2\left( d+H_1(r-y) \right) \implies \dots \\
	\implies y &= \underbrace{\frac{H_1H_2}{1+H_1H_2}}_{y_1} r +
	\underbrace{\frac{H_2}{1+H_1H_2}d}_{y_2}
\end{align*}

Φαίνεται η επαλληλία στη απόκριση του συστήματος, την οποία θα μπορούσαμε να εκμεταλλευτούμε.

Θυμόμαστε ότι:
\[
e(s) = r(s)-y(s) \qquad \text{και} \qquad
e_{\mathrm{ss}} = \lim_{s\to 0} se(s)
\]

Για την εύρεση του αποτελέσματος, θα χρησιμοποιήσουμε τον ορισμό του σφάλματος.

\subparagraph{(α) σφάλμα θέσης}
Για το σφάλμα θέσης, θεωρούμε \( r(s) = \frac{1}{s} \),  και έχουμε:
\begin{align*}
	e_{\mathrm{ssp}} &= \lim_{s\to 0}s\left[
	\frac{1}{s} - \frac{H_1H_2}{1+H_1H_2} \frac{1}{s}
	- \frac{H_2}{1+H_1H_2}\frac{A}{s}
	\right]
	\\ &=
	\lim_{s\to 0} \left[
	1 - \frac{\frac{s+2}{s+1}\frac{10}{s(s+6)}}{1+\frac{s+2}{s+1}\frac{10}{s(s+6)}}
	- \frac{\frac{10}{s(s+6)}}{1+\frac{s+2}{s+1}\frac{10}{s(s+6)}}
	\right]
	\\ &= \lim_{s\to 0} \left[
	1-\frac{\frac{10(s+2)}{\cancel{s(s+1)(s+6)}}}{\frac{s(s+1)(s+6)+10(s+2)}{\cancel{s(s+1)(s+6)}}} - A
	\frac{\frac{10}{\cancel{s(s+6)}}}{\frac{s(s+1)(s+6)+10(s+2)}{\cancel{s(s+6)}(s+1)}}
	\right]
	\\ &= \lim_{s\to 0} \left[
	1- \frac{10(s+2)}{s(s+1)(s+6)+10(s+2)}
	-A\frac{10(s+1)}{s(s+1)(s+6)+10(s+2)}
	\right]
	\\ &= 1 - \frac{20}{20} - A\cdot\frac{10}{20}
	\\ &= -\frac{A}{2}.
\end{align*}
\subparagraph{(β) σφάλμα θέσης}
Αντίστοιχα με παραπάνω, βρίσκουμε:
\begin{align*}
    e_{\mathrm{ssp}} &= \lim_{s\to 0}s\left[
    \frac{1}{s} - \frac{H_1H_2}{1+H_1H_2} \frac{1}{s}
    - \frac{H_2}{1+H_1H_2}\frac{A}{s}
    \right]
    \\ &=
    \lim_{s\to 0} \left[
    1 - \frac{\frac{s+2}{s(s+1)}\frac{10}{s+6}}{1+\frac{s+2}{s(s+1)}\frac{10}{s+6}}
    - A\frac{\frac{10}{s+6}}{1+\frac{s+2}{s(s+1)}\frac{10}{s+6}}
    \right]
    \\ &=
    \lim_{s\to 0} \left[
    1-
    \frac{\frac{10(s+2)}{\cancel{s(s+1)(s+6)}}}{\frac{s(s+1)(s+6)+10(s+2)}{\cancel{s(s+1)(s+6)}}}
    - A\frac{\frac{10}{\cancel{s+6}}}{
    	\frac{s(s+1)(s+6)+10(s+2)}{s(s+1)\cancel{(s+6)}}
    	}
    \right]
    \\ &=
    \lim_{s\to 0} \left[
    1 - \frac{10(s+2)}{s(s+1)(s+6)+10(s+2)}
    - A \frac{10s(s+1)}{s(s+1)(s+6)+10(s+2)}
    \right]
    \\ &= 1 - \frac{20}{20} - A\cdot \frac{0}{20}
    \\ &= 0.
\end{align*}

Παρατηρούμε ότι η αλλαγή της θέσης του ολοκληρωτή \( \displaystyle \frac{1}{s} \) επηρεάζει
και το σφάλμα του συστήματος.

\todo{Σφάλματα ταχύτητας}

\end{exercise}

\subsubsection{Ασκήσεις (Παπαγεωργίου)}
\paragraph{Αντιστοιχίες ηλεκτρικού συστήματος σε μηχανικό σύστημα}

\[
\begin{array}{rcl}
	\text{τάση } V & \rightarrow & \text{δύναμη } F \\
	\text{ρεύμα } I & \rightarrow & \text{ταχύτητα } u \\
	\text{αντίσταση } R=\frac{V}{I} & \rightarrow & \text{αποσβεστήρας } B = \frac{F}{u}
	\quad
	\begin{circuitikz}[scale=0.7]
	\ctikzset{bipoles/length=.9cm}
	\draw (0,0) to[damper] (1,0);
	\end{circuitikz} \\
	\text{πυκνωτής } i_c=C\od{u_c}{t} & \rightarrow & \text{ελατήριο } \frac{1}{κ} \od{F}{t}
	\rightsquigarrow F=kx \\
	\text{πηνίο } u_L = L\od{i_L}{t} & \rightarrow & \text{αδράνεια } F = ma = m\od{u}{t}
\end{array}
\]

Ένα παράδειγμα μηχανικού συστήματος είναι τα \textbf{αμορτισέρ}, τα οποία ουσιαστικά
"κόβουν" τις υψηλές συχνότητες που μπορεί να οφείλονται σε ανομοιομορφίες του δρόμου, ώστε
να νιώθουμε άνετα μέσα σε ένα αυτοκίνητο.


\begin{infobox}{}
	Οι αριθμοί των ασκήσεων συνήθως δίνονται από το βιβλίο του \textbf{Πετρίδη}.
\end{infobox}

\begin{exercise}[3.8]

\begin{circuitikz}
	\draw (2.5+0.2,-0.7) circle (0.2);
	\draw (3.5-0.2,-0.7) circle (0.2);
	
	\draw (5+0.2,-0.7) circle (0.2);
	\draw (6-0.2,-0.7) circle (0.2);
	
	\draw (1,-0.9) -- (8,-0.9);
	\fill[pattern=north east lines] (1,-0.9) rectangle (8,-1.5);
	
	\draw (8,-0.9) -- (8,1);
	\fill[pattern=north east lines] (8,-1.5) rectangle (9,1);
	
	\draw (0,0)
	to[spring={$K_1$}] (2,0)
	to[short] (2.5,0);
	;
	\draw (0,0.5) -- ++(0,-1);
	\draw (2.5,-0.5) rectangle ++(1,1) node[midway] {$m_1$};
	\draw (3.5,0.35) to[spring={$K_2$}] (5,0.35);
	\draw (3.5,-0.35) to[damper] (5,-0.35);
	\draw (5,-0.5) rectangle ++(1,1) node[midway] {$m_2$};
	\draw (6,0) to[damper={$B_2$}] (8,0);
	
	%\draw (3.5/2+5/2) node [label={[inner sep=1pt, fill=white,text=black, fill opacity=0.75, text opacity=1]above left:$(65, 35)$}] {};
	\draw ({(3.5+5)/2},-0.75) node[inner sep=1pt, fill=white,text=black, fill opacity=0.75, text opacity=1,below] {$B_1$};
	
	\draw[thick,orange!50!green,->] (-0.7,0) -- (0,0) node[midway,above] {$F$};
	\draw[thick,green!80!blue,->] (0,0.8) -- ++(0,-0.2) ++(0,0.1) -- ++(0.7,0)
	node[above,midway] {$I_0$};
	\draw[thick,green!80!blue,->] (2.5,0.8) -- ++(0,-0.2) ++(0,0.1) -- ++(0.7,0)
	node[above,midway] {$l_1$};
	\draw[thick,green!80!blue,->] (5,0.8) -- ++(0,-0.2) ++(0,0.1) -- ++(0.7,0)
	node[above,midway] {$l_2$};
\end{circuitikz}

Να υπολογιστεί η συνάρτηση μεταφοράς του παραπάνω συστήματος.
Σαν έξοδος θεωρείται η μετατόπιση της \( m_1 \).

\tcblower
Βρίσκουμε το άθροισμα των δυνάμεων που ασκούνται σε κάθε μάζα, και εφαρμόζουμε το
νόμο του Νεύτωνα:
\begin{align*}
	\text{Για τη μάζα 2: } F = m_2\od[2]{l_2}{t}
	&=
	\underbrace{-K_2(l_2-l_1)}_{\text{ελατήριο}}
	-\underbrace{B_2\od{l_2}{t}}_{\text{αποσβ.}}
	-\underbrace{B_1\left(
	\od{l_2}{t}-\od{l_1}{t}
	\right)}_{\text{αποσβεστήρας}}
	\\
	\text{Για τη μάζα 1: } F = m_1\od[2]{l_1}{t}
	&=
	-K_1(l_1-l_0)-B_1\left(\od{l_1}{t}-\od{l_2}{t}\right)
	-K_2(l_1-l_2)
\end{align*}

Μετασχηματίζουμε τις δύο εξισώσεις κατά Laplace:
\begin{align}
	m_2s^2L_2 &= -K_2(L_2-L_1) - B_2sL_2 - B_1(sL_2-sL_1) \label{3.8.lap2} \\
	m_1s^2L_1 &= -K_1(L_1-L_0) - B_1(sL_1-sL_2) - K_2(L_1-L_2) \label{3.8.lap1}
\end{align}
Θυμόμαστε ότι δεν λαμβάνουμε υπ' όψιν τις αρχικές συνθήκες, αφού αναζητούμε τη συνάρτηση
μεταφοράς.

Αναζητούμε μια σχέση της μορφής \( H(s) = \frac{L_0(s)}{L_1(s)} \), άρα πρέπει να απαλείψουμε
το \( L_2 \) από τις δύο παραπάνω σχέσεις:
\begin{align*}
	\eqref{3.8.lap2} \implies L_2 &=
	L_1 \frac{K_2+B_1s}{m_2s^2+K_2+(B_1+B_2)s} \xRightarrow{\eqref{3.8.lap1}} \\
	\frac{L_1}{L_0}
	&= \frac{K_1m_2s^2+K_1K_2+K_1(B_1+B_2)s}{
		(m_1s+K_1+K_2+B_1s)\left(m_2s^2+K_2+(B_1+B_2)s\right)-(K_2+B_1s)^2}
\end{align*}

\end{exercise}


\begin{exercise}[Brushed DC κινητήρας]

Έστω ένας brushed DC κινητήρας:

\begin{tikzpicture}[scale=1.1]
\draw (0,0.7) -- (2,0.7);
\draw (0,0) -- (2,0);
\draw (2,0.35) ellipse (0.2 and 0.35);

\draw (2,0.35) ellipse (0.2/2 and 0.35/2);
\draw (2,0.35+0.35/2) -- ++ (-0.17,0);
\draw (2,0.35-0.35/2) -- ++ (-0.17,0);

\draw (0,0.7) arc (120:242:0.4);

\draw[fill=gray!50!white]
(2,0.35+0.07) to[bend right] (2,0.35-0.07)
-- ++(1.4,0)
-- ++(0,2*0.07)
-- cycle;
%(2,0.35+0.07) arc (120:242:0.082)

\begin{scope}[xshift=3.5cm]
%,fill=gray!10!white,path fading=north
\draw[top color=gray!5!white,bottom color=gray!10!white!90!blue] (0,0.7) arc (120:242:0.4) -- (2,0) -- (2,0.7)
-- (0,0.7);
\draw (0,0) -- (2,0);
\draw[fill=white] (2,0.35) ellipse (0.2 and 0.35);
\draw (0,0.7) arc (120:242:0.4);

\draw[->,black!80!gray] (2.3,0.9) to [bend left] node[midway,right] {$θ$} (2.3,-0.2);
\end{scope}

\draw[->,gray!30!black] (1,1.5) node[right] {στάτης}  to[bend left=5] (0.7,0.7);
\draw[->,gray!30!black] (3.5,1.5) node[right] {δρομέας}  to[bend right=10] (3,0.45);
\draw[->,gray!70!black!80!green] (2.4,1) node[above right] {$J_m$}  to[bend right=10] (2,0.45);
\end{tikzpicture}

με ισοδύναμο κύκλωμα δρομέα:

\begin{circuitikz}[american]
\draw
(0,0) to[V=$V_t$] (0,-2)
;
\draw
(0,0) to [R=$R_A$,i^={$i_A$}]
(2,0) to[L=$L_A$]
(4,0) to[V_=$V$,label={\small ηλεκτρεγερτική δύναμη λόγω περιστροφής}]
(4,-2) to[short] (0,-2)
;
\end{circuitikz}

Το ισοδύναμο κύκλωμα περιγράφεται από την εξίσωση:
\begin{equation}
V_t = R_Ai_A +L_a\od{i_A}{t}
+ K_v \od{\theta}{t} \label{ex.brusheddc.elec}
\end{equation}
και το μηχανικό ισοδύναμο:
\begin{equation}
\underbrace{(J_L+J_m)}_{\mathrm{\frac{Nms^2}{rad}}}
\underbrace{\od[2]{θ}{t}}_{\mathrm{\frac{rad}{s^2}}}
= \underbrace{K_T}_{\mathrm{\frac{Nm}{A}}} i_A \label{ex.brusheddc.mech}
\end{equation}
όπου \( J_L \) και \( J_m \) είναι οι ροπές αδράνειας του κάθε μέρους.

Στη συγκεκριμένη άσκηση θεωρούμε σαν έξοδο τη \textit{γωνία του κινητήρα}, και σαν είσοδο
την \textit{τάση του δρομέα} \( V_t \).

Λύνουμε το σύστημα:
\begin{align*}
	\eqref{ex.brusheddc.mech} \implies
	i_A &= \frac{(J_L+J_m)}{K_T} \od[2]{θ}{t}
	\implies \\
	I_A &= \frac{J_L+J_m}{K_T}s^2θ
	\xRightarrow{\eqref{ex.brusheddc.elec}}
	\\
	V_T &= \left[(R_A+\cancelto{0\mathclap{\raisebox{3ex}{\text{\tiny(συνήθως αγνοούμε το $L_A$)}}}}{L_A}s)
	\frac{J}{K_T}s^2+K_vs
	\right]θ \implies \\
	\frac{θ}{V} &= \frac{\sfrac{1}{K_v} }{\frac{R_AJ}{K_TK_v}s^2+s}
\end{align*}

Βέβαια σε πολλές περιπτώσεις μπορεί να τοποθετηθεί ένας \textbf{\textit{μειωτήρας}}
μεταξύ του \( J_m \) και του \( J_L \):

\begin{tikzpicture}
\draw (0,0.7) -- (2,0.7);
\draw (0,0) -- (2,0);
\draw (2,0.35) ellipse (0.2 and 0.35);

\draw (2,0.35) ellipse (0.2/2 and 0.35/2);
\draw (2,0.35+0.35/2) -- ++ (-0.17,0);
\draw (2,0.35-0.35/2) -- ++ (-0.17,0);

\draw (0,0.7) arc (120:242:0.4);

\draw[fill=gray!50!white]
(2,0.35+0.07) to[bend right] (2,0.35-0.07)
-- ++(1.4,0)
-- ++(0,2*0.07)
-- cycle;
%(2,0.35+0.07) arc (120:242:0.082)

\begin{scope}[xshift=3.5cm]
%,fill=gray!10!white,path fading=north
\draw[top color=gray!5!white,bottom color=gray!10!white!90!blue] (0,0.7) arc (120:242:0.4) -- (2,0) -- (2,0.7)
-- (0,0.7);
\draw (0,0) -- (2,0);
\draw[fill=white] (2,0.35) ellipse (0.2 and 0.35);
\draw (0,0.7) arc (120:242:0.4);

\draw[->,black!80!gray] (2.3,0.9) to [bend left] node[midway,right] {$θ$} (2.3,-0.2);
\end{scope}

\draw[fill=white] (2.45,0.35-0.25) rectangle ++(0.5,0.5);


\draw[->,gray!70!black!80!green] (2.4,1) node[above] {$J_m$}  to[bend right=10] (2,0.45);
\draw[->,gray!70!black!80!green] (3.2,0.9) node[above] {$J_L$}  to[bend right=10] (3.3,0.45);
\end{tikzpicture}

Ο μειωτήρας είναι το μηχανικό ισοδύναμο ενός μετασχηματιστή,
και κατασκευάζεται ουσιαστικά με δύο
γρανάζια, ώστε να αυξηθεί η δύναμη μειώνοντας την ταχύτητα ή αντίστροφα:

\begin{tikzpicture}[scale=0.7]
% Source: https://tex.stackexchange.com/a/58735

% #1 number of teeths
% #2 radius intern
% #3 radius extern
% #4 angle from start to end of the first arc
% #5 angle to decale thesecond arc from the first
\newcommand{\gear}[5]{%
	\foreach \i in {1,...,#1} {%
		[rotate=(\i-1)*360/#1] (0:#2) arc (0:#4:#2) {[rounded corners=1.5pt]
			-- (#4+#5:#3) arc (#4+#5:360/#1-#5:#3)} -- (360/#1:#2)
	}}
	
	\draw[thick]
	\foreach \i in {1,2,...,10} {%
		[rotate=(\i-1)*36]
		(0:0.7) arc (0:18:0.7) {[rounded corners=2pt] -- ++(18: 0.3) arc (18:36:0.7+0.3) } -- ++(36: -0.3)
	};
	\draw[thick,xshift=3cm] \gear{22}{2}{2.3}{7}{2.6};
	
	\draw (-1,-1.3) node {$u_1F_1$};
	\draw (5.7,-1.3) node {$u_2F_2$};
\end{tikzpicture}


Τότε θα έχουμε:
\[
J = J_m + \left(
\frac{N_1}{N_2}
\right)^2 J_L
\]

Βέβαια ένα πραγματικό σύστημα θα περιλαμβάνει και δυναμική τριβή με τη μορφή αποσβεστήρα.

\end{exercise}


\begin{exercise}[Παράδειγμα 3.5.2]

\begin{circuitikz}
	\draw
	(0,0) to [R={$R_{\gamma f}$},o-] (2,0)
	to [L={$L_{\gamma f}$}] (2,-2)
	to [short,-o,i^={$i_{\gamma f}$}] (0,-2)
	to [open,v={$e_{\gamma f}$}] (0,0)
	;
\end{circuitikz}

\begin{circuitikz}[scale=1.4]
	\ctikzset{bipoles/length=1.2cm}
	
	\draw (0,1) node[elmech](motor1){};
	\draw (4,1) node[elmech](motor2){};
	
	\draw
	(motor1.north)
	-- (0,2)
	to[R] (1,2)
	to[L] (2,2)
	to[R] (3,2)
	to[L] (4,2)
	-- (motor2.north)
	;
	
	\draw
	(motor2.south)
	-- (4,0)
	to[short,i=$i_a$] (0,0)
	-- (motor1.south)
	;
	
	\draw
	([xshift=4mm]motor1.south)
	to[open,v=$e_\gamma$] ([xshift=4mm]motor1.north);
	
	\draw
	(6,0) to[L,l_=$L_F$]
	(6,2) to[R=$R_F$]
	(8,2) to[battery1=$V_F$]
	(8,0) -- (6,0);
	
	\draw[<-] (motor1) -- ++(-1,-1) node[below left]
	{
		$\underset{\mathclap{\substack{\downarrow\\ \text{σταθερό}}}}{n}
		=\od{\theta}{t}$
	};
	
	\def\l{0.4}
	\draw[xshift=5cm,rotate=45] (0,0) ellipse (0.22 and 0.14);
	\draw (5-0.17,0-0.14) -- ++(\l,-\l) node(C) {};
	\draw (5+0.17,0+0.14) -- ++(\l,-\l) node(D) {};
	\draw (C.center) to[bend right=65] node[midway,below] {$J,B,T_L$} (D.center);
	
	\def\d{0.04}
	\path (4,1) ++(\d,\d) -- ++(1,-1) node[] (A) {};
	\path (4,1) ++(-\d,-\d) -- ++(1,-1) node[] (B) {};
	
	\fill[white] (A.center) to[bend left] (B.center) -- ++(90+45:0.2) -- ++(2*\d,2*\d) -- cycle;
	
	\draw[<-] (A) ++ (45+70:0.6) node[above ] {$\omega$} to[bend left=60] ($(B) + (45+110:0.6)$);
	
	\draw (4,1) ++(\d,\d) -- ++(1,-1);
	\draw (4,1) ++(-\d,-\d) -- ++(1,-1);
	\draw (A.center) to[bend left] (B.center);
	
	\draw[->] (-0.5,0.5) ++ (45+90:0.2) to[bend left=60] ($(-0.5,0.5) + (45-90:0.2)$);
\end{circuitikz}

\begin{align*}
	e_{\gamma f} &=
	R_{\gamma f} \cdot i_{\gamma f}
	+ L_{γf} \od{i_{γf}}{t} \\
	e_γ &= K\cdot n \cdot i_{γf}\quad
	\left(
	i_{γf} = \frac{e_γ}{γ}
	\right) \\
	E_{γf} &= \left(
	\frac{R_{γf}}{γ}
	+ \frac{L_{γf}}{γ}s
	\right)E_γ \\
	J\od[2]{θ}{t} + B\od{θ}{t} + T_L &= K_m i_a
	\rightarrow (Js^2+Bs)Θ + T_L = K_mI_a \\
	L\od{i_a}{t} + Ri_a + K\od{θ}{t} &= e_γ
	\rightarrow L_sI_a + R\cdot I_A + R\cdot I_A + K_S Θ = E_γ \\
	(Js^2+Bs)Θ + T_L &= K_m \left(
	\frac{E_γ - K_sΘ}{Ls + R}
	\right) \\[2ex]
	\left( Js^2+Bs+\frac{K_mK_s}{Ls+R} \right)Θ
	+T_L &= \frac{K_m}{Ls+R}\left(
	\frac{1}{\frac{R_γf}{γ}}
	+\frac{L_γ f}{γ}s
	\right)E_{γf} \\
	\left(
	Js+B+\frac{K_mK}{Ls+R}
	\right)
	ω + T_L &= \frac{K_m}{Ls+R} \left(
	\frac{1}{\frac{R_γ f}{γ} + \frac{L_γ f}{γ}s}
	\right)E_{γf}
\end{align*}

Για \( T_L = 0 \):
\[
\frac{Ω}{E_{γf}} =
\frac{γK_m}{\left(
	(Js+B)(Ls+R)+KK_m
	\right)(Lγ_f s + R_{γf})}
\]

\end{exercise}

\paragraph{Τελεστικός ενισχυτής} \hspace{0pt}

\begin{center}
	\begin{circuitikz}[scale=2.5] \draw
		(0,0) node[op amp] (opamp) {}
		(opamp.+) to[short,-o] ++(-0.5,0)
		(opamp.-) to[short,-o] ++(-0.5,0)
		(opamp.out) to[short,-o] ++(0.5,0)
	;\end{circuitikz}
\end{center}

Ο τελεστικός ενισχυτής είναι ιδανικά ένας διαφορικός ενισχυτής άπειρου κέρδους.
Αν οι δύο είσοδοι είναι 0, τότε η έξοδος είναι 0, ενώ αν διαφέρουν, η έξοδος είναι άπειρη
(ή \( V_{cc} \) σε πραγματικό ενισχυτή).

Για τον ιδανικό τελεστικό ενισχυτή κάνουμε τις παραδοχές:
\begin{itemize}
	\item \( R_m = \infty \)
	\item \( V_{+} = V_{-} \) (για να έχουμε πεπερασμένη έξοδο)
\end{itemize}


\begin{exercise}[Α35]

\begin{circuitikz}[scale=1,american]
	\draw (0,0) node[op amp] (opamp) {};
	
	\draw (opamp.+) to[short,-*] ++(-0.5,0) node[below right] {$B$}
	to[short] ++(0,-1.2) node[ground] {};
	
	\draw (opamp.-) to[short,-*] ++(-0.5,0) node[above right] {$A$}
	to[short] ++(0,1.5)
	to[C] ++(3,0)
	to[short,-*] (1.3,0) node[above right] {$\Gamma$};
	
	\draw (opamp.-) ++ (-0.5,0) to[short] ++(0,2.5)
	to[R,i=$i_R$] ++(3,0) -- ++(0,-1);
	
	\draw (opamp.out) to[short,-o] ++ (3,0)
	to[open,v=$e_0$] ++(0,-1.5) to[short,o-] ++(0,-0.2) node[ground] {};
	
	\draw (opamp.-) to[R=$R$,i<=$I_i$,-o] ++(-4,0)
	to[open,v=$e_i$] ++(0,-2) to[short,o-] ++(0,-0.2) node[ground] {};
\end{circuitikz}

Μας ζητείται να βρούμε τον λόγο \( \displaystyle \frac{E_o}{E_i} \).

\tcblower

Χρησιμοποιούμε τη δεύτερη παραδοχή του ιδανικού τελεστικού, και παρατηρούμε ότι:
\[
V_B = V_A = 0
\]
άρα:
\begin{align*}
	V_{AΓ} + V_{ΓB} &= 0 \\
	\implies V_C + e_o &= 0 \\
	\implies V_C &= - e_0
\end{align*}

Υπολογίζουμε τα ρεύματα μέσω κυκλωματικών νόμων, και λαμβάνοντας υπ' όψιν ότι (λόγω της
άπειρης αντίστασης) δεν πηγαίνει ρεύμα στις εισόδους A και B του ενισχυτή:
\begin{align}
	I_i &= i_R + i_2 \label{ex.A35.cur} \\
	I_i &=\frac{e_i}{R} \label{ex.A35.ohm}
\end{align}
άρα:
\begin{align*}
	\eqref{ex.A35.cur} + \eqref{ex.A35.ohm}
	\implies \Aboxed{\frac{e_i}{R}&= -c\od{e_o}{t}-\frac{e_o}{R}}
	\intertext{και}
	i_R &= \frac{V_C}{R} = -\frac{e_o}{R}
\end{align*}

Μετασχηματίζοντας την παραπάνω εξίσωση κατά Laplace και λύνοντας, έχουμε:
\[
\boxed{\frac{E_o}{E_i} = \frac{1}{RCs+1}}
\]

\end{exercise}

\begin{exercise}[2.19]

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	\draw (7,0) node[mixer] (m2) {};
	\draw (12,0) node[mixer] (m3) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1.5,0) node[above,pos=.7] {$u$};
	\draw (m1.east) to[twoport,t=$\frac{1}{s+6}$,i>_=$e$] (4,0)
	to[twoport,t=$\frac{s+3}{s+7}$,>] (5.5,0) 
	to[short,i^>=$w_1$] (m2.west) node[above,xshift=-1mm] {$+$};
	\draw (3.5,0) node[above left] {$A$} to[short,*-] ++(0,1.5) node(V) {};
	\draw (m2.north) node[inputarrow,rotate=-90] {} node[above right] {$+$} -- (m2.north |- 0,1.5) node[circ] {} -- (V.center);
	\draw (m2.east) to[twoport,i>^=$w$,t=$\frac{2}{s+5}$,-*] (10.5,0) node (B) {} node[above] {$B$};
	\draw (B.center) -- ++(0,-1.5) to[twoport,t=$\frac{1}{s}$] (m2 |- 0,-1.5)
	to[short] (m2.south) node[inputarrow,rotate=90] {} node[below right] {$-$};
	\draw (B.center) -- (m3.west) node[inputarrow] {};
	\draw (V) -- (m3 |- 0,1.5) -- (m3.north) node[inputarrow,rotate=-90] {} node[above right] {$+$};
	\draw (m3.east) -- ++(1,0) node[inputarrow] {} node[midway,above] {$y$};
	
	\draw (m3.east) ++(0.5,0) to[short,*-] ++(0,-3)
	to[twoport,t=$8$] (m1 |- 0,-3)
	-- (m1.south) node[inputarrow,rotate=90] {} node[below right] {$-$};
\end{circuitikz}

\tcblower

Θα μετασχηματίσουμε το παραπάνω σύστημα σε ένα ισοδύναμό του.

Αρχικά, θυμόμαστε την ισοδυναμία:

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1,0);
	\draw (m1.east) to[twoport,t=$H_1$] (3,0) to[short,*-] (4,0) node[inputarrow] {};
	\draw (3,0) -- (3,-2) to[twoport,t=$H_2$] (m1.east |- 0,-2) -- (m1 |- 0,-2) -- (m1.south)
	node[inputarrow,rotate=90] {} node[below right] {$\pm$};
	
	\draw (current bounding box.east) node[right,scale=2] {$\equiv$};
	\begin{scope}[xshift=5.2cm,yshift=-1cm]
		\ctikzset{bipoles/length=2.4cm}
		\draw (0,0) to[twoport,t=$\frac{H_1}{1\mp H_1H_2}$,>] (5,0) node[inputarrow] {};
	\end{scope}
\end{circuitikz}

Μετασχηματίζουμε το κομμάτι από \( w_1 \) ως \( B \):

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1,0) node[pos=.8,above] {$w_1$};
	\draw (m1.east) to[twoport,t=$\frac{2}{s+5}$] (3,0) node[above] {$B$}  to[short,*-] (4,0) node[inputarrow] {};
	\draw (3,0) -- (3,-2) to[twoport,t=$\frac{1}{s}$] (m1.east |- 0,-2) -- (m1 |- 0,-2) -- (m1.south)
	node[inputarrow,rotate=90] {} node[below right] {$-$};
	\draw (m1.north) node[inputarrow,rotate=-90] {} -- ++(0,1);
	
	\draw (current bounding box.east |- 0,-1) node[right,scale=2] {$\equiv$};
	\begin{scope}[xshift=7cm,yshift=-1cm]
		\draw (0,0) node[mixer] (m2) {};
		\draw (m2.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1,0) node[pos=.8,above] {$w_1$};
		\draw (m2.north) node[inputarrow,rotate=-90] {} -- ++(0,1);
		\ctikzset{bipoles/length=2.4cm}
		\draw (m2.east) to[twoport,t=$\frac{2s}{s(s+5)+2}$,>] (4,0) node[inputarrow] {};
	\end{scope}
\end{circuitikz}

και το κομμάτι από \( A \) ως \( w_1 \) (αφού κάνουμε τις πράξεις και βρούμε \( \frac{w_1}{A} = 1+\frac{s+3}{s+7} \)):

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$};
	\draw (-4,0) to[twoport,t=$\frac{s+3}{s+7}$,>] (m1.west);
	\draw (-3.5,0) node[above left] {$A$} to[short,*-] ++(0,1.2) -- (m1 |- 0,1.2) -- (m1.north)
	node[inputarrow,rotate=-90] {} node[above right] {$+$};
	\draw (m1.east) -- ++(1,0) node[inputarrow] {} node[above] {$w_1$};
	
	\draw (2,0) node[right,scale=2] {$\equiv$};
	\begin{scope}[xshift=3.5cm]
		\ctikzset{bipoles/length=1.8cm}
		\draw (0,0) to[twoport,t=$\frac{2s+10}{s+7}$,>] (4,0) node[inputarrow] {};
	\end{scope}
\end{circuitikz}

Τα δύο παραπάνω μετασχηματισμένα διαγράμματα είναι συνδεδεμένα εν σειρά, άρα:

\begin{circuitikz}[scale=1]
	\draw (0,0) node[above] {$A$}
	to[twoport,t=$\frac{2s+10}{s+7}$,>] (2,0);
	\ctikzset{bipoles/length=2.2cm}
	\draw (2,0)
	to[twoport,t=$\frac{2s}{s(s+5)+2}$,>] (4,0);
	\ctikzset{bipoles/length=1.4cm}
	\draw (4,0) -- ++(0.7,0)
	node[above] {$B$} node[inputarrow] {};
	
	\draw (5,0) node[right,scale=2] {$\equiv$};
	\begin{scope}[xshift=6cm]
		\ctikzset{bipoles/length=3.4cm}
		\draw (0,0) to[twoport,t=$\frac{(2s+10)2s}{(s+7)\left(s(s+5)+2\right)}$,>] (5,0) node[inputarrow] {};
	\end{scope}
\end{circuitikz}

(όπου θέτουμε για ευκολία \( G(s) = \frac{(2s+10)2s}{(s+7)\left(s(s+5)+2\right)} \))
και το τμήμα του συστήματος εντός του βρόχου ανάδρασης με το
\begin{circuitikz}[baseline,scale=.7]
	\ctikzset{bipoles/length=0.8cm}
	\draw (0,0) to[twoport,t=$8$,scale=.7] (2,0);
\end{circuitikz}
γίνεται:

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$};
	\draw (-3.5,0) to[twoport,t=$G(s)$,>] (m1.west);
	\draw (-3.5,0) -- (-4,0);
	\draw (-3.5,0) node[above left] {$A$} to[short,*-] ++(0,-1.2) -- (m1 |- 0,-1.2) -- (m1.south)
	node[inputarrow,rotate=90] {} node[below right] {$+$};
	\draw (m1.east) -- ++(1,0) node[inputarrow] {} node[above] {$w_1$};
	
	\draw (2,-0.5) node[right,scale=2] {$\equiv$};
	\begin{scope}[xshift=3.5cm,yshift=-0.5cm]
		\ctikzset{bipoles/length=2.2cm}
		\draw (0,0) to[twoport,t=$1+G(s)$,>] (4,0) node[inputarrow] {};
	\end{scope}
\end{circuitikz}

με \( 1+G(s) = \frac{\text{αριθμητής }N_3}{\text{παρονομαστής }D_3}
= \frac{
	(2s+10)2s+(s+7)\left[s(s+5)+2\right]}{
	(s+7)\left[s(s+5)+2\right]} \).

Άρα το τελικό σύστημα είναι:

\begin{circuitikz}[scale=1]
	\draw (0,0) node[mixer] (m1) {};
	
	\draw (m1.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1,0) node[above] {$u$};
	\draw (m1.east) to[twoport,t=$H_1$] (2.5,0)
	to[twoport,t=$\frac{N_3}{D_3}$] (4,0) -- (4.5,0) node[above] {$y$} to[short,*-] (5.5,0) node[inputarrow] {};
	\draw (4.5,0) -- (4.5,-2) to[twoport,t=$8$] (m1.east |- 0,-2) -- (m1 |- 0,-1.5) -- (m1.south)
	node[inputarrow,rotate=90] {} node[below right] {$-$};
\end{circuitikz}

και επομένως προκύπτει από πράξεις:
\begin{align*}
	\frac{y}{u} &=
	\frac{\frac{N_3}{D_3(s+6)}}{1+8\frac{N_3}{D_3}\frac{1}{s+6}}
	\\ &= \frac{N_3}{D_3(s+6)+8N_3}
	\\ &= \frac{N_3}{D_3(s+6)+8N_3}
	\\ &= \frac{
		(2s+10)2s+(s+7)(s^2+5s+2)
		}{
		(s+14)(s+7)(s^2+5s+2)+16(2s+10)s
		}
\end{align*}

Η άσκηση αυτή μπορεί βεβαίως να λυθεί και αλγεβρικά. Συνοπτικά:
\begin{align}
	y &= A + B \label{ex.2.19.1} \\
	B &= \frac{2}{s+5}w \label{ex.2.19.2} \\
	A &= \frac{1}{s+6}e \label{ex.2.19.3} \\
	e &= u-8y \label{3x.2.19.4} \\
	w &= \left(1+\frac{s+3}{s+7}\right)A - \frac{1}{s}B \label{ex.2.19.5}
\end{align}
και λύνοντας το σύστημα μπορεί να βρεθεί η συνάρτηση μεταφοράς.

\end{exercise}

\begin{exercise}[Ασκήσεις στα σφάλματα]
\begin{enumgreekparen}
	\item Τι σφάλμα θέσης έχει το σύστημα
	\( \displaystyle H(s) = \frac{s+9}{s^2+7s+3} \) αν συνδεθεί σε μοναδιαία αρνητική
	ανάδραση;
	
	\begin{circuitikz}[scale=1]
		\draw (0,0) node[mixer] (m1) {};
		
		\draw (m1.west) node[inputarrow] {} node[above left] {$+$} -- ++(-1,0);
		\draw (m1.east) to[twoport,t=$H(s)$] (3,0)  to[short,*-] (4.5,0) node[inputarrow] {};
		\draw (3,0) -- (3,-1.5) -- (m1 |- 0,-1.5) -- (m1.south)
		node[inputarrow,rotate=90] {} node[below right] {$-$};
	\end{circuitikz}
	
	\subparagraph{}
	Η συνάρτηση μεταφοράς είναι \( H_c = \frac{H}{1+H}
	= \frac{s+9}{s^2+7s+3+s+9} \). Το σφάλμα θέσης
	στη μόνιμη κατάσταση είναι το \( \lim_{s\to 0} s
	(1-H_C)\frac{1}{s} \), ή θυμόμαστε ότι \( e_{\mathrm{ss}} 
	= \frac{1}{1+K_P}
	\) όπου \( K_P = \lim_{s\to 0} H(s) \).
	
	Ισχύει:
	\begin{align*}
		K_p &= \lim_{s\to 0} \cancel{8}
		\frac{s+9}{s^2+7s+3} = 3\\
		e_{\mathrm{ss}} &= \frac{1}{4} = 0.25
	\end{align*}
	\item
	Έστω συνάρτηση μεταφοράς που συνδέεται σε μοναδιαία αρνητική ανάδραση:
	\[
	H(s) = \frac{2(s+10)}{s(s^2+2)(s+5)}
	\]
	
	\subparagraph{}
	Τότε τα σφάλματα είναι:
	\begin{align*}
	    K_p &= \lim_{s\to 0}H(s) = \infty \\
		e_{\mathrm{ssp}} &= \frac{1}{1+K_p} = \frac{1}{1+\infty} = 0 \\
		K_v &= \lim_{s\to 0} sH(s) = \lim_{s\to 0} \frac{2(s+10)}{(s^2+2)(s+5)}
		= \frac{2\cdot(0+10)}{(0^2+2)\cdot (0+5)} = 2 \\
		e_{\mathrm{ssv}} &= \frac{1}{K_v} = \frac{1}{2}\\
		K_a &= \lim_{s\to 0} s^2 H(s) = 0\\
		e_{\mathrm{ssa}} &= \frac{1}{K_a} = \infty
	\end{align*}
\end{enumgreekparen}

\end{exercise}

\subsection{Ταχύτητα}
Η δεύτερη προδιαγραφή που θα μελετήσουμε για τα συστήματα είναι η ταχύτητα, δηλαδή το πόσο
γρήγορα φτάνει ένα σύστημα στην επιθυμητή κατάσταση. Για να μελετήσουμε αυτήν την
προδιαγραφή θα χρησιμοποιήσουμε ως είσοδο τη \textbf{μοναδιαία βηματική συνάρτηση}
\( u(t) = \begin{cases}
0, &\quad t < 0\\
1, &\quad t > 0
\end{cases} \).

\subsubsection{Σε πρωτοβάθμια συστήματα}

Ως παράδειγμα, ας δούμε το παρακάτω σύστημα:

\begin{tikzpicture}
\draw (0,0) node[rectangle,draw,inner sep=10pt] (DM) {$\frac{k}{s+a}$};
\draw (DM.west) -- ++(-1,0) node[above right] {$r(s)$};
\draw (DM.east) -- ++(1,0) node[above left] {$y(s)$};
\end{tikzpicture}

με \(
H(s) = \frac{k}{s+a}
\).

Θυμόμαστε ότι το σφάλμα \( r(s)-y(s) \) στη μόνιμη κατάσταση (\( t\to \infty \))
είναι ορισμένο, και κάνοντας υπολογισμούς, η έξοδος στη μόνιμη κατάσταση προκύπτει:
\[
\lim_{s\to 0} sy(s)
=
\lim_{s\to 0} \cancel{s}\cancel{\frac{1}{s}}\frac{k}{s+a}
=
\frac{k}{a}
\]

και για να μηδενιστεί το σφάλμα, επιθυμούμε η έξοδος να είναι μοναδιαία, άρα πρέπει \( \frac{k}{a} = 1 \implies k=a \).

Σε μορφή σταθεράς χρόνου, η \( H \) γράφεται:
\[
H(s) = \frac{1}{τs+1}
\]
όπου
\[
τ = \frac{1}{a}
\]

Έχουμε θεωρήσει ότι \( k=a \), επομένως το σφάλμα είναι μηδενικό.

Για να βρούμε την έξοδο στο πεδίο του χρόνου, έχουμε ότι:
\[
y(s) = \frac{1}{τs+1}\frac{1}{s} = \frac{1}{s}-\frac{τ}{τs+1}
\]
και, χρησιμοποιώντας αντίστροφο μετασχηματισμό Laplace:
\[
y(t) = y_{\mathrm{ss}} \left( 1-e^{-\sfrac{t}{τ} } \right)
\]

Έχουμε μια αποσβεννύμενη απόκριση που μοιάζει ως εξής:

\begin{tikzpicture}[scale=2]
\draw[->] (-0.5,0) -- (3.5,0) node[below right] {$t$};
\draw (0,-0.5) -- (0,3);

\draw[very thick,orange!50!red]
(0,0) -- (0.8,0.8*2.5*1.5) node[midway,above,sloped] {$\sfrac{1}{\tau}$};

\draw[very thick,blue,opacity=.7]
plot [variable=\t,domain=0:6.5,samples=\gsamples]
(\t,{2.5*(1-exp(-1.5*\t))});

% not the real value to make the graph look better
\draw[dashed] (0.15,0) node[below,xshift=1mm] (t1) {$t_1$}-- ++(0,0.503709453101557)
-- (0,0.503709453101557) node[left] {$0.1y_{\mathrm{ss}}$};

\draw[dashed] (1.53505672866270,0) node[below] (t2) {$t_2$}-- ++(0,2.25)
-- (0,2.25) node[left] {$0.9y_{\mathrm{ss}}$};

\draw[dashed] (2.60801533695210,0) node[below] {$t_s$}-- ++(0,2.45)
-- (0,2.45);

\draw[dashed] (0,2.5) node[left] {$y_{\mathrm{ss}}$} -- (3.5,2.5);

\draw [decorate,decoration={brace,amplitude=10pt},green!20!black] (t2.south) -- (t1.south) node[below,midway,yshift=-4mm] {$t_r$};
\end{tikzpicture}

Θα ψάξουμε μετά από πόσο χρόνο έχει φτάσει η έξοδος στο 10\% και στο 90\% της επιθυμητής
τιμής:
\begin{gather*}
	1-e^{\sfrac{-t_1}{τ} }
	= 0.1 \implies t_1 = τ(\ln 10 - \ln 9)
	\\
	1-e^{\sfrac{-t_2}{τ} }
	= 0.9 \implies t_2 = τ(\ln 10)
\end{gather*}

\begin{defn}{Χρόνος ανόδου σε πρωτοβάθμιο σύστημα}{}
Υπολογίζουμε τον \textbf{χρόνο ανόδου} \( t_r \) (rise), δηλαδή τον χρόνο μεταξύ
της στιγμής που η έξοδος είναι στο 10\% και στο 90\% της επιθυμητής:
\[
t_r = t_2-t_1 \implies \boxed{t_r = τ\ln 9 \approx 2.2τ}
\]
\end{defn}

\begin{defn}{Χρόνος αποκατάστασης σε πρωτοβάθμιο σύστημα}{}
Ορίζουμε το \textbf{χρόνο αποκατάστασης} \( t_s \) (steady) ως τον χρόνο που
απαιτείται μέχρι το σύστημα να φτάσει στο \( 98\% \) της εξόδου του:
\[
1-e^{\sfrac{-t_s}{τ} } = 0.98
\implies \boxed{t_s \approx 4τ}
\]
\end{defn}

Επιβεβαιώνουμε δηλαδή ότι η σταθερά χρόνου \( τ \) σχετίζεται με την ταχύτητα απόκρισης
του συστήματος. Όσο μεγαλύτερη είναι η σταθερά χρόνου, τόσο μικρότερη είναι η ταχύτητά του.

Μάλιστα, αν βρούμε το σφάλμα ταχύτητας του συστήματος αυτού, θα δούμε ότι γίνεται μικρότερο,
όσο μεγαλώνει η ταχύτητά του.

\paragraph{Συνδυασμός συστημάτων}
Έστω δύο εν σειρά συστήματα:
\[
Y(s) = H(s)U(s)
\]
και πιο συγκεκριμένα:
\[
H(s) = \frac{N(s)}{D(s)} \qquad
U(s) = \frac{N_u(s)}{D_u(s)}
\]
επομένως, αν σπάσουμε σε κλάσματα όπως γνωρίζουμε από τα μαθηματικά:
\[
Y(s) = \frac{N}{D}\frac{N_u}{D_u}
= \frac{N_1}{D} + \frac{N_2}{D}
\]
που μπορεί να δώσει ένα αποτέλεσμα της μορφής:
\begin{gather*}
\frac{A}{s+p} + \cdots + \frac{B}{(s+p)^k} + \frac{C}{(s+a)^2+β}
\intertext{ή, αντίστοιχα}
(A_1+A_2t+\cdots)e^{-pt} + \dots
\end{gather*}

\paragraph{Παράδειγμα}
Έστω το σύστημα:
\[
H_z(s) = \frac{k(s+b)}{s+a}
\]
με τελική τιμή (είσοδος = \( \frac{1}{s} \)):
\[
y_{ss} = \lim_{s\to 0} sy(s) = \lim_{s\to 0}s\frac{k(s+b)}{s+a}\frac{1}{s} = \frac{kb}{a}
\]
και αρχική τιμή (για \( t=0 \)):
\[
y(0) = \lim_{t\to0} y(t) = \lim_{s\to \infty} sy(s) = k
\]
δηλαδή αυτό το σύστημα δεν ξεκινάει από μηδενική αρχική τιμή.

\begin{tikzpicture}[scale=1]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);

\draw[thick] (-1.5,0) node[circle,inner sep=2.7pt,draw,orange!80!black] {} node[below,yshift=-1mm] {$b$};
\draw[thick] (-0.75,0) node[cross=4pt,red!80!black] {} node[below,yshift=-1mm] {$\vphantom{b}a$};

\begin{scope}[xshift=3.5cm,yshift=-1cm]
\draw[->] (-0.5,0) -- (3.5,0) node[below right] {$t$};
\draw[->] (0,-0.5) -- (0,3) node[right] {$y(t)$};

\draw[very thick,blue,opacity=.7]
plot [variable=\t,domain=0:3.5,samples=\gsamples]
(\t,{0.5+1.5*exp(-1.5*\t)});
\end{scope}
\end{tikzpicture}

\paragraph{Μελέτη μηδενικών}
Θα εξετάσουμε την επίδραση των μηδενικών στην έξοδο του συστήματος.

Έστω ένα σύστημα με έξοδο στο χρόνο:
\begin{align*}
	y_z(t) &= \frac{kb}{a} + \frac{k(a-b)}{a}e^{-at}
	\intertext{Το οποίο αναλύουμε περαιτέρω:}
	&= \overbrace{\frac{kb}{a}}^{y_{\mathrm{ss}}}\left(1-e^{-at}\right)
	+ ke^{-at}
	\\ &=
	y_{\mathrm{ss}}\left( 1-e^{-at} \right) + \frac{\dot{y}(t)}{b}
\end{align*}

(Τοποθετήσαμε την παράγωγο στην τελευταία σχέση, επειδή μαθηματικά φαίνεται ότι
\( y(t) = \frac{kb}{a} (1-e^{-at}) \implies \dot y = kbe^{-at} \)).

Αναλύοντας κατά Laplace, προκύπτει:
\[
Y_z(s) =
\frac{kb}{a}\frac{1}{s} + \frac{k(a-b)}{a}\frac{1}{s+a}
= \frac{k(b+s)}{s(a+s)}
\]
και παρατηρούμε το μηδενικό στο \( -b \) και τους πόλους στο \( 0 \) και στο \( -a \).

Γραφικά:

\begin{tikzpicture}[scale=1]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);

\draw[thick] (-1,0) node[circle,inner sep=2.7pt,draw,orange!80!black,fill=white,fill opacity=.7] {} node[below,yshift=-2mm] {$-b$};

\begin{scope}[xshift=3.5cm,yshift=-1cm]
\draw[->] (-0.5,0) -- (4,0) node[below right] {$t$};
\draw[->] (0,-0.5) -- (0,3) node[right] {$y(t)$};

\draw[very thick,blue!20!green,opacity=.7]
plot [variable=\t,domain=0:3.5,samples=\gsamples]
(\t,{2*exp(-1*\t)})
(3.5,0) node[above] {$\dot y(t)$};
\draw[very thick,blue,opacity=.7]
plot [variable=\t,domain=0:3.5,samples=\gsamples]
(\t,{2*(1-exp(-1*\t))})
(3.5,2) node[below] {$y(t)$};
\draw[very thick,dashed,blue,opacity=.7]
plot [variable=\t,domain=0:3.5,samples=\gsamples]
(\t,{2*(1-exp(-3*\t))});

\draw[blue!70!black,<-] (1.8,2) to[bend left=30] ++ (0.5,0.6)
node[above,align=center,scale=.8]
{μηδενικό πιο κοντά\\σε φανταστικό άξονα};
\end{scope}
\end{tikzpicture}

Το μηδενικό \(-b\) της συνάρτησης εκφράζεται από την τιμή \( \frac{\dot y(t)}{b} \) στη συνάρτηση \( y_z(t) \).

Παρατηρούμε ότι αν υπάρχει μηδενικό, και όσο πιο κοντά πλησιάζει στον φανταστικό άξονα, τόσο
μεγαλύτερη επίδραση έχει στην έξοδο του συστήματος, αυξάνοντας την ταχύτητά του.

\begin{exercise}[Ένα απλό πρόβλημα πρωτοβάθμιου συστήματος]
Έστω ένα σύστημα:
\[
G(s) = \frac{1}{s+1}
\]

Αυτό έχει πόλο στο \( -1 \), και σταθερά χρόνου \( τ = 1 \), άρα χρόνο αποκατάστασης \( t_s = 4\ \mathrm{sec} \),
κάτι που είναι πολύ μεγάλο και δεν μας αρέσει καθόλου. Επομένως, προσθέτουμε έναν βρόχο ανάδρασης μαζί με τον
απλούστερο δυνατό ελεγκτή, που είναι το αναλογικό κέρδος \( \boxed{k} \):

\begin{tikzpicture}[scale=1]
\draw (0,0) node[circle,draw] (a1) {};
\draw (0.9,0) node[rectangle,draw,minimum height=20pt,minimum width=20pt] (b1) {$k$};
\draw (2.2,0) node[rectangle,draw] (b2) {$\frac{1}{s+1}$};

\draw[->] (-1,0) -- (a1.west);
\draw (a1.east) -- (b1.west);
\draw (b1.east) -- (b2.west);
\draw (b2.east) -- ++(1,0);
\draw[->] (3,0) -- ++(0,-1) -- (a1 |- 0,-1) -- (a1.south) node[below right] {$-$};
\end{tikzpicture}

Απαιτούμε χρόνο αποκατάστασης \( t_s \leq 1\ \mathrm{sec} \), και το ζητούμενο της άσκησης είναι η περιοχή τιμών
του \( k \) για τις οποίες ικανοποιείται αυτή η προδιαγραφή.

\tcblower
Αρχικά βρίσκουμε τη συνάρτηση μεταφοράς του συστήματος:
\[
H(s) = \frac{\frac{k}{s+1}}{1+\frac{k}{s+1}}
= \frac{k}{s+(k+1)}
\]
Αυτό έχει σταθερά χρόνου \( τ = \frac{1}{k+1} \), επομένως:
\[
t_s \approx 4τ = \frac{4}{k+1}
\]

Πρέπει:
\[
t_s \leq 1 \implies \frac{4}{k+1} \leq 1 \implies k \geq 3.
\]

\end{exercise}

\subsubsection{Σε δευτεροβάθμια συστήματα}

\paragraph{Ένα παράδειγμα δευτεροβάθμιου συστήματος}
Έστω το σύστημα ενός περιστρεφόμενου κυλίνδρου με απόσβεση:

\begin{circuitikz}[scale=1]
	\tikzstyle{reverseclip}=[insert path={(3,0.5) --
		(3,-0.5) --
		(0.8,-0.5) --
		(0.8,0.5) --
		(3,0.5)}
	]
	
	\begin{scope}
		%[top color=gray!5!white,bottom color=gray!10!white!90!blue]
		\path[clip] (1,0) ellipse (0.3 and 0.4) [reverseclip];
		
		\fill[top color=gray!5!white,bottom color=gray!7!white!95!blue]
		plot [smooth,tension=1.5]
		coordinates {(1,0.4) (2,0) (1,-0.4)};
	\end{scope}
	
	\draw (1,0) ellipse (0.3 and 0.4);
	
	\draw
	plot [smooth,tension=1.5]
	coordinates {(1,0.4) (2,0) (1,-0.4)};
	
	\draw (2,0) to[damper,l=$B$] (3,0);
\end{circuitikz}
\[
u = J \ddot y + B\dot y
\]

Παραπάνω δίνεται η διαφορική εξίσωση του συστήματος, που θα μετασχηματίσουμε κατά Laplace:
\begin{gather*}
Js^2y(s) +Bsy(s) = u(s) \\
\frac{y(s)}{u(s)} = \frac{1}{s(Js+b)}
\end{gather*}

Αντίστοιχα με το προηγούμενο παράδειγμα, προσθέτουμε έναν ελεγκτή και έναν βρόχο ανάδρασης:

\begin{tikzpicture}[scale=1]
\draw (0,0) node[circle,draw] (a1) {};
\draw (0.9,0) node[rectangle,draw,minimum height=20pt,minimum width=20pt] (b1) {$k$};
\draw (2.5,0) node[rectangle,draw] (b2) {$\frac{1}{s(Js+b)}$};

\draw[->] (-1,0) -- (a1.west) node[above,pos=.7] {$r$};
\draw (a1.east) -- (b1.west);
\draw (b1.east) -- (b2.west);
\draw[->] (b2.east) -- ++(1,0) node[above] {$y$};
\draw[->] (3.7,0) -- ++(0,-1) -- (a1 |- 0,-1) -- (a1.south) node[below right] {$-$};
\end{tikzpicture}

με έξοδο:
\[
\frac{y(s)}{r(s)}
= \frac{\frac{k}{s(Js+b)}}{1+\frac{k}{s(Js+b)}}
= \frac{k}{Js^2+Bs+k}
= \frac{\sfrac{k}{J} }{s^2 +\sfrac{B}{J}s + \sfrac{k}{J}   }
= \frac{\omega_n^2}{s^2+2ζ\omega_ns+\omega_n^2}
=
\boxed{
\frac{\omega_n^2}{(s+σ)^2 + \omega_d^2}
}
\]
όπου θέσαμε:
\begin{tcolorbox}[width=.6\textwidth]
	\vspace{-17pt}
\begin{alignat*}{3}
	\omega_n^2 &= \sfrac{k}{J} && \implies \omega_n &&= \sqrt{\frac{k}{J}}  \\
	2ζ\omega_n &= \sfrac{B}{J}, \quad ζ \leq 1 && \implies\ ζ &&= \frac{B}{2\sqrt{Jk}} \\
	s_{1,2}  &= -σ \pm j\omega_d && &&\text{(ρίζες παρ/τή)} \\[3ex]
	σ &= ζ\omega_n \\
	\omega_d &= \omega_n\sqrt{1-ζ^2}
\end{alignat*}
\end{tcolorbox}
\begin{defn}[width=.6\textwidth]{Σταθερές Συστημάτων 2\textsuperscript{ου} βαθμού}{}
	\begin{itemize}
		\item \( \omega_n \): \textbf{φυσική συχνότητα}
		\item \( ζ \): \textbf{συντελεστής απόσβεσης}
		\item \( \omega_d \): \textbf{συχνότητα ταλαντώσεων}
	\end{itemize}
\end{defn}

\begin{theorem}[width=.7\textwidth]{Συντελεστής απόσβεσης συστημάτων 2\textsuperscript{ου} βαθμού}{}
	\begin{itemize}
		\item Αν \( \underline{ζ < 1} \), οι πόλοι του συστήματος είναι \textbf{μιγαδικοί συζυγείς}.
		\item Αν \( \underline{ζ = 1} \), το σύστημα έχει έναν \textbf{διπλό πραγματικό πόλο}.
		\item Αν \( \underline{ζ > 1} \), το σύστημα έχει δύο \textbf{πραγματικούς πόλους}.
	\end{itemize}
\end{theorem}

\pagebreak[2]

Μετά από πράξεις που δεν παρουσιάζονται, η έξοδος του συστήματος ξεχωρίζεται στις δύο παρακάτω περιπτώσεις:
\begin{itemize}
	\item Αν έχουμε \textbf{δύο πραγματικούς πόλους} \( p1,\ p2 \):\[
	y(t) = y_{\mathrm{ss}}
	\left[
	1+\frac{p_1p_2}{p_1-p_2}
	\left(
	\frac{e^{p_1t}}{p_1}
	-
	\frac{e^{p_2t}}{p_2}
	\right)
	\right]
	\]
	
	\begin{tikzpicture}[scale=1]
	\draw (-2,0) -- (2,0);
	\draw (0,-1) -- (0,1);
	
	\draw[thick] (-1.5,0) node[cross=4pt,red!80!black] {} node[below,yshift=-1mm] {$-b$};
	\draw[thick] (-0.5,0) node[cross=4pt,red!80!black] {} node[below,yshift=-1mm] {$\vphantom{b}-a$};
	\end{tikzpicture}

	Δηλαδή η απόκριση του συστήματος αποτελείται από το άθροισμα δύο εκθετικά αποσβεννύμενων
	αποσβέσεων. Πρακτικά, παίζει ρόλο ο πόλος που προκαλεί την πιο αργή απόσβεση (ειδικά αν
	οι πόλοι απέχουν αρκετά μεγάλη απόσταση μεταξύ τους), καθώς η άλλη απόσβεση εξαλείφεται
	γρήγορα. Ο αργός πόλος επιβάλλει το ρυθμό του.
	
	\begin{tikzpicture}[scale=1.5]
	\draw[->] (-0.5,0) -- (6,0) node[below right] {$t$};
	\draw[->] (0,-0.5) -- (0,3) node[below left] {$y(t)$};
	
	\draw[thick,dashed] (0,2) node[left] {$y_\mathrm{ss}$} -- ++(6,0);
	
	\draw[ultra thick,blue,opacity=.7]
	plot [variable=\t,domain=0:6,samples=\gsamples]
	(\t,{1*(1-1*exp(-0.8*\t)) + 1*(1-1*exp(-4*\t)) });
	
	\draw[ultra thick,blue!50!cyan,path fading=east,opacity=.3]
	plot [variable=\t,domain=0:6,samples=\gsamples]
	(\t,{2*(1-1*exp(-4*\t)) });
	
	% not real but used for a nicer graph
	\draw[dashed] (2.6,0) node[below] {$t_s$} -- ++(0,1.88);
	\end{tikzpicture}
	
	\item Αν έχουμε \textbf{δύο μιγαδικές συζυγείς ρίζες} \( -σ \pm j\omega_d \):
	\begin{align*}
	y(t) &= y_{\mathrm{ss}}\left[
	1-e^{-ζ\omega_nt} \cdot
	\left(
	\cos \omega_dt + \frac{ζ}{\sqrt{1-ζ^2}} \sin \omega_d t
	\right)
	\right]
	\\ &= y_{\mathrm{ss}}\left[
	1 - \frac{e^{-ζ\omega_nt}}{\sqrt{1-ζ^2}}
	\cdot \sin\left(\omega_d t + \tan^{-1}\frac{\sqrt{1-ζ^2}}{ζ}\right)
	\right]
	\end{align*}
	
	Σε αυτήν την περίπτωση, η έξοδος του συστήματος μοιάζει κάπως έτσι:
	
	\begin{tikzpicture}[scale=1.7]
	\begin{scope}[xshift=-2cm,yshift=2cm,scale=0.7]
	\draw (-2,0) -- (1.5,0);
	\draw (0,-2) -- (0,2);
	
	\draw[dashed] (-1,1) -- ++ (1,0) node (xa) {};
	\draw[dashed] (-1,-1) -- ++ (1,0) node (xb) {};
	\draw[dashed] (0,0) -- (-1,1);
	
	\draw[thick] (-1,1) node[cross=4pt,red!80!black] {};
	\draw[thick] (-1,-1) node[cross=4pt,red!80!black] {};
	
	\draw[<->,orange!30!green!50!black] (xa.east) -- (xa.east |- 0,0) node[right,midway] {$\omega_d$};
	\draw[<->,orange!30!green!50!black] (-1,-0.1) -- ++(1,0) node[midway,below] {$ζ\omega_n$};
	
	\draw (-45+180:0.3) to[bend right] node[midway,left,yshift=1mm] {$θ$} (-0.3,0);
	\end{scope}
	
	\draw[->] (-0.5,0) -- (5,0) node[below right] {$t$};
	\draw[->] (0,-0.5) -- (0,4) node[below left] {$y(t)$};
	
	\draw[thick,dashed] (0,2) node[left] {$y_\mathrm{ss}$} -- ++(6,0);

	\draw[ultra thick,blue,opacity=.7]
	plot [variable=\t,domain=0:6,samples=\gsamples]
	(\t,{2*(1-1*exp(-0.8*\t)*cos(3.5*\t r))});
	
	\draw[very thick,cyan,opacity=.2]
	plot [variable=\t,domain=0:6,samples=\gsamples]
	(\t,{2*(1+1*exp(-0.8*\t))});
	
	\draw[dashed] (0.84,0) node[below,xshift=2mm] {$t_p$}-- ++(0,3)
	-- (0,3) node[left,scale=.9] {$y_{\mathrm{ss}}\left(1+M_p\right)$};
	\draw[dashed] (0.44,0) node[below] {$t_r$} -- ++(0,2);
	
	\filldraw[thick,draw=orange,draw opacity=.5,fill=white!90!orange,fill opacity=.6]
	(0.84,3) circle (1.7pt);
	\filldraw[thick,draw=orange!50!green,draw opacity=.5,fill=orange!50!green!10!white,fill opacity=.6]
	(0.44,2) circle (1.7pt);
	
	% not real but used for a nicer graph
	\draw[dashed] (3.3,0) node[below] {$t_s$} -- ++(0,2);
	\draw[thick,yellow!50!blue] (3.3,{2*(1-1*exp(-0.8*3.3))}) -- (3.3,{2*(1+1*exp(-0.8*3.3))})
	node[midway,above,rotate=180,sloped,scale=.3] {2\%};
	\end{tikzpicture}
	
	Αποδεικνύεται επίσης ότι ισχύουν αρκετές σχέσεις, που παρουσιάζονται παρακάτω.

	\begin{theorem}{Χρόνος αποκατάστασης σε δευτεροβάθμιο σύστημα με συζυγείς πόλους}{}
		\[
		t_s \approx \frac{4}{ζ\omega_n}
		\]
		
		({\color{red!50!black}Προσοχή!} Αυτή η σχέση ισχύει μόνο όταν έχουμε δύο συζυγείς μιγαδικές ρίζες, και όχι πραγματικές!)
	\end{theorem}
		
	Ο χρόνος ανόδου ορίζεται διαφορετικά από τα πρωτοβάθμια συστήματα:
	\begin{defn}{Χρόνος ανόδου σε δευτεροβάθμιο σύστημα με συζυγείς πόλους}{}
		Ως \textbf{χρόνος ανόδου} ορίζεται ο χρόνος μέχρι η έξοδος να φτάσει την πρώτη
		φορά στην επιθυμητή τιμή.
		
		Αποδεικνύεται ότι είναι ίσος με:
		\[
		\boxed{t_r = \frac{π-θ}{\omega_d}}
		\]
		
		όπου \( θ \) η γωνία του ενός πόλου.
	\end{defn}
	
	\begin{defn}{Χρόνος Υπερύψωσης}{}
	Ο χρόνος \( t_p \) (peak) μέχρι η έξοδος να φτάσει στην πρώτη κορυφή της ημιτονοειδούς κυματομορφής είναι:
	\[
	\boxed{t_p = \frac{π}{\omega_d}}
	\]
	\end{defn}
	
	Βλέπουμε ότι αρκετές στιγμές η έξοδος έχει τιμή μεγαλύτερη της εισόδου. Η υπερύψωση αυτή
	μπορεί σε κάποιες περιπτώσεις να μην είναι επιθυμητή, επειδή για παράδειγμα δεν θέλουμε
	το ρεύμα σε ένα κύκλωμα να ξεπεράσει μια μέγιστη τιμή, ή ο βραχίονας ενός ρομπότ να
	φτάσει έξω από κάποια όρια.
	
	\begin{defn}{Υπερύψωση}{}
		Αποδεικνύεται ότι το \textbf{ποσοστό υπερύψωσης} της πρώτης κορυφής είναι:
		\[
		M_p =
		e^{-\left(
			\frac{ζπ}{\sqrt{1-ζ^2}}
			\right)}
		= e^{-σ t_p}
		\]
		
		\tcblower
		
		Η πρώτη κορυφή στην οποία έχουμε υπερύψωση φτάνει στην τιμή:
		\[
		y\left(t_p\right) = y_{ss}(1+M_p)
		\]
	\end{defn}
	
	Αυξάνοντας τη σταθερά \( k \), μειώνουμε τους χρόνους \( t_p \) και \( t_r \), καθώς και την \( M_p \),
	αλλά αυξάνεται το \( ζ \) και η συχνότητα των αποσβεννύμενων ταλαντώσεων, δηλαδή το σύστημα γίνεται πιο "ζωηρό".
	
	Τέλος, για τη γωνία του πόλου, αποδεικνύεται ότι:
	\[
	\boxed{\cos θ = ζ}
	\]
\end{itemize}

\pagebreak[1]

\paragraph{Παραδείγματα συστήματος δεύτερης τάξης} \hspace{0pt}

\begin{enumgreekparen}
	\item
	\begin{tikzpicture}[scale=1,baseline]
	\tikzset{mbox/.style={rectangle,draw,minimum height=20pt,minimum width=17pt}}
	\draw (-1,0) node[circle,draw] (a1) {};
	\draw (0,0) node[circle,draw] (a2) {};
	\draw (0.9,0) node[mbox] (b1) {$k$};
	\draw (2.5,0) node[mbox] (b2) {$\frac{1}{Js+b}$};
	\draw (4.3,0) node[mbox] (b3) {$\frac{1}{s}$};
	\draw (1.6,-1) node[mbox] (b4) {$K_v$};
	
	\draw[->] (-2,0) -- (a1.west) node[above,pos=.7] {};
	\draw (a1.east) -- (a2.west);
	\draw (a2.east) -- (b1.west);
	\draw (b1.east) -- (b2.west);
	\draw (b2.east) -- (b3.west);
	\draw[->] (b3.east) -- ++(1,0) node[above] {$φ$};
	\draw (3.5,0) node[above] {$\omega$} -- ++(0,-1) -- (b4.east);
	\draw[->] (b4.west) -- (a2 |- 0,-1) -- (a2.south) node[below right] {$-$};
	\draw[->] (5,0) -- ++(0,-2) -- (a1 |- 0,-2) -- (a1.south) node[below right] {$-$};
	\end{tikzpicture}
	\item
	\begin{tikzpicture}[scale=1.2,baseline]
	\draw (0,0) node[circle,draw] (a1) {};
	\draw (1.5,0) node[rectangle,draw,minimum height=20pt,minimum width=20pt] (b1) {$k(1+K_vs)$};
	\draw (3.5,0) node[rectangle,draw] (b2) {$\frac{1}{s(Js+b)}$};
	
	\draw[->] (-1,0) -- (a1.west);
	\draw (a1.east) -- (b1.west);
	\draw (b1.east) -- (b2.west);
	\draw[->] (b2.east) -- ++(1,0);
	\draw[->] (4.5,0) -- ++(0,-1) -- (a1 |- 0,-1) -- (a1.south) node[below right] {$-$};
	\end{tikzpicture}
\end{enumgreekparen}

\subparagraph{(α)}
Εκτελούμε πράξεις για να βρούμε την απόκριση του συστήματος:
\begin{alignat*}{2}
	φ &= \frac{1}{s}\omega &&\implies\\
	sφ &= \omega &&\implies \numberthis \label{example.2.secorder.omega} \\
	sφ &= \frac{k}{Js+b}\cdot \left[r(s) - K_v \omega - \phi \right] &&\xRightarrow{\eqref{example.2.secorder.omega}} \\
	sφ &= \frac{k}{Js+b}\left[ r(s) - sK_vφ - φ \right] &&\implies \\
	sφ(Js+b) &= k\left[r(s) - sK_vφ - φ\right] &&\implies \\
	φ\left[ Js^2 + bs + k K_v s + k \right] &= kr(s) && \implies \\
	\frac{φ}{r} &= \frac{k}{Js^2 + (b+kK_v)s + k} && \implies \\
	H(s) &= \frac{\sfrac{k}{J} }{s^2
		+\left(\frac{B+kK_v}{J}\right)s + \sfrac{k}{J} 
	}
\end{alignat*}

\subparagraph{(β)}
Η συνάρτηση μεταφοράς είναι:
\[
H(s) =
\frac{\sfrac{K}{J}(1+K_vs) }{s^2 + \left(\frac{B+kK_v}{J}s\right)
	+ \sfrac{K}{J} }
\]

\subparagraph{}
Παρατηρούμε ότι τα δύο συστήματα έχουν παρόμοιες συναρτήσεις μεταφοράς, αλλά το
δεύτερο έχει ένα μηδενικό.

\paragraph{Παράδειγμα με μηδενικό}
Έστω μια συνάρτηση μεταφοράς που έχει μηδενικό στο \( -z \):
\begin{align*}
	H_z(s) &= \frac{b(s+z)}{s^2+a_1s+a_0}
	\\ &= y_{\mathrm{ss}}\frac{\sfrac{\omega_n^2}{z} (s+z) }{s^2+2ζ\omega_ns+\omega_n^2}
	\\ &= y_{\mathrm{ss}} \boxed{
		\frac{\omega_n^2}{s^2+2ζ\omega_ns+\omega_n^2}
		+\frac{s}{z}
		\left(
		    \frac{\omega_n^2}{s^2+2ζ\omega_n+\omega_n^2}
		\right)
		}
\end{align*}

Η τελευταία σχέση, αν παρατηρήσουμε ότι ο τελεστής \( s \) εκφράζει την \textbf{παραγώγιση}
μιας συνάρτησης στο πεδίο του χρόνου, βλέπουμε ότι ισχύει η σχέση
\( y_z(t) = y(t) + \frac{\dot y(t)}{z} \):
\[
\boxed{
	y_z(t) = \underbrace{y(t)}_{\text{έξοδος χωρίς μηδενικό}} +
	\underbrace{\frac{\dot y(t)}{z}}_{\text{επίδραση μηδενικού}}
	}
\]


\begin{exercise}[Συνάρτηση χωρίς και με μηδενικό]
Έστω οι συναρτήσεις μεταφοράς:
\[
H_a = \frac{14}{(s+1)^2+6},\quad
H_b = \frac{7(s+2)}{(s+1)^2+6}
\]

με τελική έξοδο (είσοδος βηματική):
\begin{align*}
	y_{\mathrm{ss}_1} &= \lim_{s\to 0} s\frac{14}{(s+1)^2+6}\frac{1}{s} = 2 \\
	y_{\mathrm{ss}_2} &= \lim_{s\to 0} s\frac{7(s+2)}{(s+1)^2+6}\frac{1}{s} = 2
\end{align*}

Αν προσομοιώσουμε/εφαρμόσουμε τύπους, η έξοδος των συστημάτων θα είναι:

\begin{tikzpicture}[scale=1.2]
\draw[->] (-1,0) -- (5,0) node[below] {$t$};
\draw (0,-0.5) -- (0,3.4);

\def\sqrtsix{2.45}

\draw[dashed] (4,0) node[below] {$4$} -- (4,2);
\draw[dashed] (1.27,0) node[below] {$1.27$} -- (1.27,2.55) -- (0,2.55) node[left] {$2.55$};
\draw[dashed] (0.75,3.19) -- (0,3.19) node[left] {$3.19$};
\draw[dashed,path fading=east] (0,2) -- (5,2);
\draw (0,2) node[left] {$2$};

\draw[very thick,blue!50!black]
plot[variable=\t,domain=0:5,samples=\gsamples]
(\t,{-1/3*(\sqrtsix*sin(\sqrtsix*\t r) + 6*cos(\sqrtsix*\t r))*exp(-\t) + 2});

\draw[very thick,blue!50!cyan]
plot[variable=\t,domain=0:5,samples=\gsamples]
(\t,{1/6*(5*\sqrtsix*sin(\sqrtsix*\t r) - 12*cos(\sqrtsix*\t r))*exp(-\t) + 2});

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan] (b) {};

\draw (a.east) node[right] {$ \frac{14}{(s+1)^2+6}\frac{1}{s}$};
\draw (b.east) node[right] {$ \frac{7(s+2)}{(s+1)^2+6}\frac{1}{s}$};
\end{tikzpicture}

Βλέπουμε ότι το σύστημα με το μηδενικό έχει πιο γρήγορη απόκριση, αλλά ταυτόχρονα αυξάνεται
και η υπερύψωση.

Συνήθως το \( ζ \) ως προδιαγραφή είναι ανάμεσα στο 0.4 και 0.8, ενώ αν δεν θέλουμε καθόλου
υπερύψωση, παίρνουμε \( ζ \geq 1 \), που οδηγεί σε πραγματικές ρίζες.
\end{exercise}


\begin{exercise}
Ποιό από τα παρακάτω συστήματα θα εμφανίσει τη μεγαλύτερη υπερύψωση, ως απόκριση στη μοναδιαία
βηματική συνάρτηση;
\begin{enumgreekparen}
	\item \( \displaystyle \frac{8}{s^2+2s+1} \)
	\item \( \displaystyle \frac{48}{s^2+2s+16} \)
	\item \( \displaystyle \frac{48}{s^2+8s+16} \)
	\item \( \displaystyle \frac{8}{s^2+2s+4} \)
\end{enumgreekparen}
\tcblower

Για την κάθε μία από τις παραπάνω συναρτήσεις έχουμε, από τους τύπους:
\begin{enumgreekparen}
	\item \( ζ = 1 \implies  \) δεν υπάρχει υπερύψυση!
	\item \( ζ = \frac{1}{4} \implies M_p = e^{-\frac{ζπ}{\sqrt{1-ζ^2}}} \simeq 0.44 \)
	\item \( ζ = 1 \implies \) δεν υπάρχει υπερύψωση!
	\item \( ζ = \frac{1}{2} \implies M_p \simeq 0.16 \)
\end{enumgreekparen}

Άρα η σωστή απάντηση είναι η \textbf{(β)}.
\end{exercise}


\begin{exercise}
Ποιό από τα παρακάτω συστήματα έχει ταχύτερη απόκριση;
\begin{enumgreekparen}
	\item \( \displaystyle \frac{s+10}{(s+2)(s+5)} \)
	\item \( \displaystyle \frac{s+1}{(s+2)(s+5)} \)
	\item \( \displaystyle \frac{10}{(s+2)(s+5)} \)
	\item \( \displaystyle \frac{s+3}{(s+2)(s+5)} \)
\end{enumgreekparen}

\tcblower

Το ταχύτερο σύστημα είναι αυτό με το πιο "σημαντικό" μηδενικό, δηλαδή αυτό που βρίσκεται πιο
κοντά στον φανταστικό άξονα, άρα το \textbf{(β)}, με μηδενικό \( z = -1 \).

\end{exercise}


\begin{exercise}
Να συγκριθούν τα συστήματα ως προς ταχύτητα απόκρισης:
\begin{enumgreekparen}
	\item \( \displaystyle \frac{10}{(s+5)^2+3} \)
	\item \( \displaystyle \frac{10(s+2)}{(s+5)^2+3} \)
	\item \( \displaystyle \frac{10(s+3)}{(s+5)^2+3} \)
\end{enumgreekparen}
\tcblower

Το (β) είναι το (α) με πρόσθεση της παραγώγου του (α) διά 2, ενώ το (γ) είναι το (α) με
πρόσθεση της παραγώγου του (α) διά 3. Επομένως το \textbf{(β)}, που έχει πιο σημαντικό
μηδενικό, είναι ταχύτερο.
\end{exercise}


\begin{exercise}
Έστω ένα σύστημα κλειστού βρόχου:
\begin{tikzpicture}[scale=1.2,baseline]
\draw (0,0) node[circle,draw] (a1) {};
\draw (0.9,0) node[rectangle,draw,minimum height=20pt,minimum width=20pt] (b1) {$k$};
\draw (2.5,0) node[rectangle,draw] (b2) {$H(s)$};

\draw[->] (-1,0) -- (a1.west) node[above,pos=.7] {$r$};
\draw (a1.east) -- (b1.west);
\draw (b1.east) -- (b2.west);
\draw[->] (b2.east) -- ++(1,0) node[above] {$y$};
\draw[->] (3.7,0) -- ++(0,-1) -- (a1 |- 0,-1) -- (a1.south) node[below right] {$-$};
\end{tikzpicture} \\
όπου \( \displaystyle H(s) = \frac{10}{(s+6)(s+7)} \).

Θέλουμε να βρεθεί η \textbf{περιοχή τιμών} της σταθεράς \( k \), ώστε να ικανοποιούνται οι
παρακάτω προδιαγραφές:
\begin{align*}
	e_{\mathrm{ss}} &< 0.5 \\
	M_p &< 0.1 \\
	t_s &< 660\ \mathrm{ms}
\end{align*}

\tcblower

Έχουμε, για κάθε προδιαγραφή:
\begin{enumerate}
	\item Για το \( e_{\mathrm{ss}} \):
	\begin{align*}
		e_{\mathrm{ss}} &= \frac{1}{1+K_{\mathrm{pos}}}
		= \frac{1}{1+\lim_{s\to 0}kH(s)}
		= \frac{1}{1+\lim_{s\to 0}k\frac{10}{(s+6)(s+7)}}
		= \frac{1}{1+k\frac{10}{6\cdot 7}} \\
		e_{\mathrm{ss}} &< 0.5 \implies \boxed{k > 4.2}
	\end{align*}
	\item Για το \( M_p < 0.1 \):
	\begin{align*}
		\ln M_p &= -\frac{ζπ}{\sqrt{1-ζ^2}}\\
		\implies ζ &= \frac{\left\lvert \ln M_p \right\rvert}{
			\sqrt{\ln^2 M_p - π^2}
			}\\
		\implies ζ &> \frac{|\ln 0.1 |}{\sqrt{\ln^2 0.1 + π^2}}
		\implies \boxed{ζ > 0.59}
	\end{align*}
	
	Για να χρησιμοποιήσουμε το αποτέλεσμα που βρήκαμε για το \( ζ \), πρέπει να το
	εφαρμόσουμε επάνω στο χαρακτηριστικό πολυώνυμο του συστήματος, που μετά από πράξεις
	προκύπτει:
	\[
	s^2+
	\underbrace{13}_{2ζ\omega_n}s
	+\underbrace{10k+42}_{\omega_n^2}
	\]
	
	Επομένως θέλουμε:
	\[
	ζ = \frac{13}{2\sqrt{42+10k}} > 0.59
	\implies \boxed{k < 7.9}
	\]
	
	\item
	Αν για τις παραπάνω προδιαγραφές υπολογίσουμε το χρόνο αποκατάστασης
	\[
	t_s \approx \frac{4}{ζ\omega_n}
	= \frac{4}{\sfrac{13}{2} } \simeq 0.6154 \simeq 615\ \mathrm{ms}
	\]
	φαίνεται ότι ήδη πληροί την προδιαγραφή \( t_s < 660\ \mathrm{ms} \).
	
	Σε διαφορετική περίπτωση, αν δηλαδή για αυτό το σύστημα μάς δινόταν μια προδιαγραφή
	που δεν ικανοποιούνταν (π.χ. \( t_s < 220\ \mathrm{ms} \)), δεν θα ήταν δυνατό να
	λυθεί η άσκηση με αυτό το σύστημα, αλλά θα έπρεπε να προστεθεί ένας ακόμα ελεγκτής.
\end{enumerate}

\end{exercise}

\subsubsection{Για συστήματα μεγαλύτερου βαθμού}
Ένα σύστημα μεγαλύτερου από 2 βαθμού μπορεί να έχει τη μορφή:
\[
\frac{y(s)}{r(s)}
= \frac{k(s+z_1)\cdots(s+z_n)}{(s+p_1)\cdots(s+p_n)\left[
	(s+ζ_κ\omega_k)^2+(\omega_{d_k})^2
	\right]}
\]

Αν αναλύσουμε σε απλά κλάσματα το παραπάνω, χωρίζοντας πραγματικούς και μιγαδικούς συζυγείς
πόλους, λαμβάνουμε:
\begin{align*}
	y(s) &= \frac{a}{s}
	+ \sum_{i}^{n} \frac{a_i}{s+p_i}
	+ \sum_{k}^q \frac{b_k(s+ζ_k\omega_k)+c_k\omega_{kd}}{s^2+2ζ_k\omega_k s + \omega_k^2}
\intertext{Και, μετασχηματίζοντας αντίστροφα κατά Laplace}
    y(t) &= a
    + \sum a_i e^{-p_it}
    + \sum b_k e^{-ζ_k\omega_k t}\cos \omega_d t
    + \sum c_k e^{-ζ_k\omega_k t}\sin \omega_d t
\end{align*}

\paragraph{Απλοποίηση συστημάτων}

Σε αυτό το σημείο κάνουμε μια σημαντική παρατήρηση: Αν έχουμε δύο μακρινούς πόλους,
για παράδειγμα \(-2\) και \( -20 \), που δίνουν αντίστοιχα αποκρίσεις:
\[
\mathlarger{e^{-2t}}, \quad \mathlarger{e^{-20t}}
\]

\begin{tikzpicture}[scale=1]
\draw[->] (-0.5,0) -- (6,0) node[below right] {$t$};
\draw[->] (0,-0.5) -- (0,3) node[below left] {$y(t)$};

\draw[thick,dashed] (0,2) node[left] {$y_\mathrm{ss}$} -- ++(6,0);

\draw[ultra thick,blue,opacity=.7,mark position=0.5(d)]
plot [variable=\t,domain=0:6,samples=\gsamples]
(\t,{1*(1-1*exp(-0.8*\t)) + 1*(1-1*exp(-20*\t)) });

\draw[ultra thick,blue!30!cyan,path fading=east,opacity=.6,mark position=0.5(c)]
plot [variable=\t,domain=0:6,samples=\gsamples,smooth]
(\t,{2*(1-1*exp(-20*\t)) });
\draw[blue!30!cyan] (c) node[above] {γρήγορη απόκριση};

\draw[ultra thick,red!80!cyan,opacity=.6,mark position=0.7(c)]
plot [variable=\t,domain=0:6,samples=\gsamples]
(\t,{2*(1-1*exp(-0.8*\t)) });
\draw[red!80!cyan] (c) node[below] {αργή απόκριση};

\draw[blue!70!white,->] (d) to[bend right] ++(0.2,-1) node[below] {συνολική απόκριση};
\end{tikzpicture}

Η πιο \textit{αργή} απόκριση \( e^{-2t} \) κυριαρχεί τη \textit{γρηγορότερη} απόκριση
\( e^{-20t} \), η οποία αποσβένεται γρήγορα και δεν επηρεάζει το τελικό αποτέλεσμα.

Επομένως, \textbf{μόνο όταν ασχολούμαστε με την ταχύτητα απόκρισης ενός συστήματος}, μπορούμε
προσεγγιστικά να απαλλαγούμε από τους γρήγορους πόλους, αυτούς δηλαδή που βρίσκονται
\textit{πιο μακριά από τον φανταστικό ημιάξονα}.

\paragraph{Παράδειγμα}
Στη συνάρτηση μεταφοράς \( \frac{10}{\left[(s+2)^2+5\right](s+10)} \) μπορούμε να
απαλλαχθούμε από τον πόλο \( p=-10 \), αλλά προσέχουμε ώστε \textbf{να παραμείνει ίδιο το
	DC κέρδος} του απλοποιημένου συστήματος. Δηλαδή η απλοποιημένη συνάρτηση μεταφοράς θα
προκύψει:
\[
\frac{K}{(s+2)^2+5}
\]

Για \( s=0 \), η αρχική συνάρτηση έχει κέρδος:
\[
\mathrm{gain}_1 = \frac{10}{(2^2+5)(0+10)} = \frac{1}{9}
\]
και η δική μας απλοποίηση έχει κέρδος:
\[
\mathrm{gain}_2 = \frac{K}{(0+2)^2+5} = \frac{K}{9}
\]

Επομένως, αφού \( \mathrm{gain}_1 = \mathrm{gain}_2 \), προκύπτει \( K = 1\).

%\paragraph{Παράδειγμα}
%Έστω η συνάρτηση μεταφοράς:
%\[
%H(s) = \frac{100(s+20)}{(s+2)(s+5)(s+50)(s+100)}
%\]
\todo{fill}

\paragraph{Παράδειγμα}
Έστω η συνάρτηση μεταφοράς:
\[
\frac{100(s+20)}{(s+2)(s+50)}
\]

Επειδή εδώ έχουμε μηδενικό, δεν μπορούμε να απαλλαγούμε από τον πόλο, διότι θα αλλάξει
εντελώς η απόκριση της συνάρτησης.

Επομένως γενικά προσέχουμε:
\begin{infobox}{Προϋποθέσεις απλοποίησης πόλου}
\begin{enumpar}
	\item Διατηρούμε ίδιο το DC κέρδος
	\item Προσοχή στην κανονικότητα του συστήματος \todo{συμπλ} (διαφορά αριθμού ριζών αριθμητή και παρονομαστή)
	\item Προσοχή σε μηδενικά κοντά σε πόλο
\end{enumpar}
\end{infobox}


\begin{exercise}[Παράδειγμα με τρία συστήματα]
Να βρεθούν οι βηματικές αποκρίσεις των παρακάτω συστημάτων στο χρόνο:
\begin{align*}
	H_1 &= \frac{3}{s+3} \\
	H_2 &=\frac{60}{(s+3)(s+20)} \\
	H_3 &= \frac{18.75(s+3.2)}{(s+3)(s+20)}
\end{align*}

\tcblower

\begin{enumpar}
	\item
	Πολλαπλασιάζουμε τη συνάρτηση μεταφοράς με την είσοδο \( \frac{1}{s} \):
	\begin{align*}
		y(s) &= \frac{3}{(s+3)s} = \frac{A_1}{s} - \frac{B_1}{s+3}
		\\ &\overset{\cdots}{=} \frac{1}{s} - \frac{1}{s+3}
		\intertext{Άρα:}
		y(t) &= 1-e^{-3t}
	\end{align*}
	
	\begin{tikzpicture}[scale=1.2]
	\draw[->] (-1,0) -- (5,0) node[below] {$t$};
	\draw (0,-0.5) -- (0,3.4);
	
	\def\sqrtsix{2.45}
	
	\draw (0,2.5) node[left] {$1$};
	\draw[dashed,path fading=east] (0,2.5) -- (4,2.5);
	\draw[dashed] (3,0) -- (3,2.5);
	\draw (2.2,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$1$};
	\draw (4.4,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$2$};
	
	\draw[blue!70!cyan,very thick]
	plot[smooth,samples=28,variable=\t,domain=0:5]
	(\t,{2.5*(1-exp(-1.5*\t)))});
	\end{tikzpicture}
	
	\item
	Εικάζουμε ότι η απόκριση του συστήματος \( H_2 \) είναι παρόμοια με αυτήν του
	\( H_1 \), αφού έχουν ίδιο DC κέρδος (\(H_1\to \frac{3}{3}=1, H_2\to\frac{60}{3\cdot20} = 1  \),
	και απλώς προστέθηκε ένας
	μακρινός πόλος στη συνάρτηση μεταφοράς.
	
	Με τον ίδιο τρόπο βρίσκουμε:
	\[
	y(t) = \mathscr{L}^{-1} \left\lbrace
	\frac{A_2}{s} + \frac{B_2}{s+3} + \frac{C_2}{s+20}
	\right\rbrace = \mathscr{L}^{-1} \left\lbrace
	\frac{1}{s} + \frac{-1.18}{s+3} + \frac{0.18}{s+20}
	\right\rbrace = 1-1.18e^{-3t}+0.18e^{-20t}
	\]
	
	\begin{tikzpicture}[scale=1]
	\draw[->] (-1,0) -- (5,0) node[below] {$t$};
	\draw (0,-0.5) -- (0,3.4);
	
	\def\sqrtsix{2.45}
	
	\draw (0,2.5) node[left] {$1$};
	\draw[dashed,path fading=east] (0,2.5) -- (4,2.5);
	\draw[dashed] (3,0) -- (3,2.5);
	\draw (2.2,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$1$};
	\draw (4.4,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$2$};
	
	\draw[blue!70!cyan,very thick]
	plot[smooth,samples=28,variable=\t,domain=0:5]
	(\t,{2.5*(1-1.18*exp(-1.5*\t)+0.18*exp(-10*\t)))});
	
	\draw[blue!50!cyan,very thick,opacity=.3]
	plot[smooth,samples=28,variable=\t,domain=0:5]
	(\t,{2.5*(1-exp(-1.5*\t)))});
	\end{tikzpicture}
	
	\item
	Εδώ έχουμε ένα μηδενικό \( z=-3.2 \) \textbf{κοντά} στον πόλο \( p_1=-3 \), επομένως λύνουμε
	αναλυτικά:
	\begin{align*}
		y(s) &= H_3\frac{1}{s} = \frac{A}{s} + \frac{B}{s+3} + \frac{Γ}{s+20}
		\\ & \overset{\cdots}{=} \frac{1}{s} - \frac{0.0735}{s+3} - \frac{0.92}{s+20}
		\intertext{Άρα}
		y(t) &= 1 - 0.0735e^{-3t} - 0.92e^{-20t}
	\end{align*}
	

	\begin{tikzpicture}[scale=1]
	\draw[->] (-1,0) -- (5,0) node[below] {$t$};
	\draw (0,-0.5) -- (0,3.4);
	
	\def\sqrtsix{2.45}
	
	\draw (0,2.5) node[left] {$1$};
	\draw[dashed] (3,0) -- (3,2.5);
	\draw (2.2,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$1$};
	\draw (4.4,0) node[circle,fill,inner sep=0.5pt] {} node[below] {$2$};
	
	\draw[blue!70!cyan,very thick]
	plot[smooth,samples=28,variable=\t,domain=0:5]
	(\t,{2.5*(1-exp(-1.5*\t)))});
	
	\draw[green!70!cyan,very thick]
	plot[smooth,samples=28,variable=\t,domain=0:5]
	(\t,{2.5*(1-exp(-7*\t)))});
	
	\draw[dashed,path fading=east] (0,2.5) -- (4,2.5);
	\end{tikzpicture}
	
	Εδώ το μηδενικό επηρεάζει το αποτέλεσμα, και η γρήγορη απόκριση του \( (s+20) \)
	κυριαρχεί, οπότε δε θα ήταν σωστό να την αγνοήσουμε.
\end{enumpar}

\end{exercise}

\subsubsection{Ασκήσεις}

\begin{exercise}
Έχουμε τέσσερις συναρτήσεις μεταφοράς:
\begin{align*}
G_1 &= \frac{16}{(s+2)(s+8)} \\
G_2 &= \frac{16}{5}\frac{s+5}{(s+2)(s+8)} \\
G_3 &= \frac{16}{2+\Delta_z}\frac{s+2+\Delta_z}{(s+2)(s+8)}\\
G_4 &= 16\frac{s+1}{(s+2)(s+8)}
\end{align*}
Να υπολογιστεί η κρουστική απόκριση των παραπάνω συστημάτων.
\tcblower
Ουσιαστικά θα πάρουμε έναν αντίστροφο μετασχηματισμό Laplace.


\paragraph{\( G_1 \)}

Δουλεύουμε πάνω στο \( G_1 \) κλασικά, σπάζοντας σε επιμέρους κλάσματα:
\begin{align*}
G_1 &= \frac{A}{s+2} + \frac{B}{s+8} \\
\intertext{και με κάποιον τρόπο βρίσκουμε τους συντελεστές:}
A &= \left. \frac{16}{s+8} \right|_{s=-2} = \frac{16}{6} \\
B &= \left. \frac{16}{s+2} \right|_{s=-8} = -\frac{16}{6}
\end{align*}

και ο αντίστροφος Laplace είναι:
\[
\mathscr{L}^{-1}\left\lbrace G_1 \right\rbrace
= \frac{16}{6}\left( e^{-2t} - e^{-8t} \right)
\]

\subparagraph{\( G_2 \)}
Αντίστοιχα:
\begin{align*}
G_2 &= \frac{A}{s+2} + \frac{B}{s+8} \\
A &= \left. \frac{16}{5} \frac{s+5}{s+8} \right|_{s=-2} = \frac{8}{5} \\
B &= \left. \frac{16}{5} \frac{s+5}{s+2} \right|_{s=-8} = \frac{8}{5}
\end{align*}
άρα:
\[
\mathscr{L}^{-1}\left\lbrace G_2 \right\rbrace = \frac{8}{5}\left( e^{-2t} + e^{-8t} \right)
\]

Παρατηρούμε και στις δύο παραπάνω απαντήσεις την επίδραση του κυρίαρχου, δηλαδή του πιο
αργού πόλου \( s=-2 \) (αντιστοιχεί στο \( e^{-2t} \)), ο οποίος είναι πιο κοντά στο 0.

\subparagraph{\( G_3 \)}
Έχουμε:
\begin{gather*}
	G_3 = \frac{A}{s+2} + \frac{B}{s+8} \\
	A = \left. \frac{16}{2+\Delta_z} \frac{s+2+\Delta_z}{s+8} \right|_{s=-2}
	= \frac{16}{6}\frac{\Delta_z}{2+Δ_z} \\
	B = \left. \frac{16}{2+Δ_z}\frac{s+2+Δ_z}{s+2} \right|_{s=-8} = -\frac{16}{6}
	+\frac{16}{6}\frac{Δ_z}{6} \\
	\mathscr{L}^{-1} \left\lbrace G_3 \right\rbrace =
	\frac{16}{2+Δ_z}\left(
	\frac{Δ_z}{6}e^{-2t} + \left(1-\frac{Δ_z}{6}\right)e^{-8t}
	\right)
\end{gather*}

Παρατηρούμε ότι όσο πιο μικρό (κοντά στο 0) είναι το \( Δ_z \), τόσο λιγότερη σημασία
έχει ο όρος \( e^{-2t} \), και επικρατεί ο γρηγορότερος \( e^{-8t} \). Αυτό μπορούμε να
το διαπιστώσουμε και από τη συνάρτηση μεταφοράς: Aν θεωρήσουμε ότι \( Δ_z \to 0 \),
τότε εξαφανίζονται τα \( (s+2) \) στον αριθμητή και παρονομαστή, και η συνάρτηση γίνεται
\( \frac{16}{2+0} \frac{1}{(s+8)} \).

Για παράδειγμα, αν θέσουμε:
\[
Δ_z = 0.1
\]
τότε η έξοδος θα γίνει:
\[
\frac{16}{6}(
\underbrace{0.047e^{-2t}}_{\mathclap{\text{μικρός όρος}}}
- 0.98e^{-8t}
)
\]

Στην ουσία δηλαδή, το μηδενικό στη θέση \( -(2+Δ_z) \to -2 \) ακυρώνει τον πόλο \( s=-2 \):

\begin{tikzpicture}[scale=1]
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[below] {t};

\draw[dashed] (2.7,2.5) -- ++(0,-2.5) node[below] {0.5};

\draw[thick,cyan!70!blue!70!black,mark position=0.5(a)]
plot[domain=0:4,variable=\x,samples=18,smooth]
(\x,{2.5/2*(2-exp(-4*\x)-exp(-2*\x))});
\draw[cyan!70!blue!50!black,<-]
([yshift=2pt]a) to[bend left] ++(0.5,0.5) node[above right] {$\frac{1}{s+2}$};
\draw[ultra thick,cyan!50!blue!70!black,mark position=0.55(b)]
plot[domain=0:4,variable=\x,samples=15,smooth]
(\x,{2.5*(1-exp(-1.5*\x))});
\draw[cyan!70!blue!50!black,<-]
([yshift=-2pt]b) to[bend left=20] ++(0.5,-0.5) node[below,xshift=-4mm] {$\frac{s+2+\Delta x^{(0.1)}}{(s+2)(s+8)}$};
\end{tikzpicture}

Μπορούμε επίσης να υπολογίσουμε το χρόνο αποκατάστασης του συστήματος:
\[
t_s = 4τ = 4\frac{1}{-p\mathrlap{\leftarrow \text{ πόλος}}}
\hphantom{\leftarrow \text{ πόλος}} = \frac{1}{2} = 0.5
\]

\paragraph{\(G_4\)} Έχουμε:
\[
G_4 = 16 \cdot \frac{s+1}{(s+2)(s+8)} = \frac{A}{s+2} + \frac{B}{s+8}
= \frac{-2.67}{s+2} + \frac{18.67}{s+8}
\]
οπότε η απόκριση στο χρόνο γίνεται:
\[
\mathscr{L}^{-1}\left\lbrace G_4 \right\rbrace =
-2.67 e^{-2t} + 18.67 e^{-8t}
\]

\begin{tikzpicture}[scale=1]
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[below] {t};

\draw[dashed] (2.7,2.5) -- ++(0,-2.5) node[below] {0.5};

\draw[thick,cyan!70!blue!70!black,mark position=0.5(a)]
plot[domain=0:4,variable=\x,samples=18,smooth]
(\x,{8/3*(exp(-2*\x)-exp(-8*\x))});
\draw[cyan!70!blue!50!black,<-]
([yshift=2pt]a) to[bend left] ++(0.5,0.5) node[above right] {$16\frac{1}{(s+2)(s+8)}$};
\draw[ultra thick,cyan!50!blue!70!black,mark position=0.55(b)]
plot[domain=0.17:4,variable=\x,samples=18,smooth]
(\x,{8/3*(-exp(-2*\x)+7*exp(-8*\x))});
\draw[cyan!70!blue!50!black,<-]
([yshift=-2pt]b) to[bend left=20] ++(0.5,-0.5) node[below,xshift=-4mm] {$16\frac{s+1}{(s+2)(s+8)}$};
\end{tikzpicture}

\end{exercise}
\begin{exercise}
Ποιό από τα παρακάτω συστήματα έχει τη βηματική απόκριση που φαίνεται στο σχήμα;

\begin{tikzpicture}[scale=1]
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (0,0) -- (6,0) node[below] {t};

\draw[dashed] (0,2) -- ++(3,0);

\draw[ultra thick,cyan!50!blue!70!black]
plot[domain=0:6,variable=\x,samples=20,smooth]
(\x,{1+1*(1-exp(-2*\x))});

\filldraw (0,1) circle(1pt) node[left] {$2$};
\filldraw (0,2) circle(1pt) node[left] {$4$};
\end{tikzpicture}

\begin{enumlatin}
	\item \( \displaystyle \frac{12}{s+2} \)
	\item \( \displaystyle \frac{2(s+6)}{s+3} \)
	\item \( \displaystyle \frac{2(s+3)}{s+2} \)
	\item \( \displaystyle \frac{6}{s+3} \)
\end{enumlatin}

\tcblower

Για το κάθε σύστημα ψάχνουμε αρχική και τελική τιμή, ώστε να επιβεβαιώσουμε την απόκριση:
\begin{enumlatin}
	\item \( \displaystyle \lim_{s\to \infty}
	\frac{1}{s} \frac{12}{s+2} s = 0
	 \) άρα δεν βολεύει.
	\item \( \displaystyle \lim_{s\to \infty} \frac{1}{s}\frac{2(s+6)}{s+3}s=2 \)
	και \( \displaystyle \lim_{s\to 0} \frac{1}{s}\frac{2(s+6)}{s+3}s=4  \), που είναι οι
	επιθυμητές τιμές.
\end{enumlatin}

Άρα η σωστή απάντηση είναι η \textbf{(β)}.

\end{exercise}
\begin{exercise}
Ποιό από τα παρακάτω συστήματα έχει τη βηματική απόκριση που φαίνεται στο σχήμα;

\begin{tikzpicture}[scale=1]
\draw[->] (0,-0.5) -- (0,3);
\draw[->] (0,0) -- (6,0) node[below] {t};

\draw[dashed] (0,2) -- ++(3,0);

\draw[ultra thick,cyan!50!blue!70!black]
plot[domain=0:6,variable=\x,samples=20,smooth]
(\x,{0.75+1.25*(1-exp(-\x))});

\filldraw (0,0.75) circle(1pt) node[left] {$1$};
\filldraw (0,2) circle(1pt) node[left] {$2$};
\end{tikzpicture}

\begin{enumlatin}
	\item \( \displaystyle \frac{4}{s+2} \)
	\item \( \displaystyle \frac{6}{s+2} \)
	\item \( \displaystyle \frac{3(s+2)}{s+3} \)
	\item \( \displaystyle \frac{s+4}{s+2} \)
\end{enumlatin}

\tcblower

Αντίστοιχα με παραπάνω, υπολογίζουμε αρχική και τελική τιμή για κάθε σύστημα. Η σωστή απάντηση είναι η
\textbf{(δ)}, αφού ισχύει \( \lim_{s\to \infty} \frac{s+4}{s+2} = 1 \) και \( \lim_{s\to 0} \frac{s+4}{s+2} = 2 \).

\end{exercise}
\begin{exercise}
Ποιά συνάρτηση μοιάζει με την παρακάτω απόκριση;

\begin{tikzpicture}[scale=1]
\draw[->] (0,-0.5) -- (0,4);
\draw[->] (0,0) -- (5,0) node[below] {t};

\draw[ultra thick,cyan!50!blue!70!black,mark position=0.9(b),mark position=0.57(a),mark position=0.99(c)]
plot[domain=0:5,variable=\x,samples=14,smooth]
(\x,{3.5*(1-exp(-1.2*\x))});

\draw[dashed] (a |- 0,0) node[circle,fill,inner sep=1pt] {} node[below] {$0.6$} |- (a -| 0,0) node[circle,fill,inner sep=1pt] {} node[left] {$9$};
\draw[dashed] (b |- 0,0) node[circle,fill,inner sep=1pt] {} node[below] {$1.2$} -- (b);
\draw [dashed] ([yshift=1pt]c) -- ([yshift=1pt]c -| 0,0) node[circle,fill,inner sep=1pt] {} node[left] {$10$};
\end{tikzpicture}

\begin{enumlatin}
    \item \( \displaystyle \frac{10}{s+5} \)
	\item \( \displaystyle \frac{20}{s+2} \)
	\item \( \displaystyle \frac{50}{s+2} \)
	\item \( \displaystyle \frac{50}{s+5} \)
\end{enumlatin}

\tcblower

Η τελική τιμή της συνάρτησης είναι το 10, επομένως οι απαντήσεις (α) και (γ) απορρίπτονται, αφού το όριό τους στο \( \infty \)
δεν είναι 10.

Για να βρούμε τη σωστή απάντηση, μπορούμε να βρούμε τον αντίστροφο μετασχηματισμό Laplace των εναπομείναντων συναρτήσεων, ή
πιο εύκολα, να παρατηρήσουμε ότι στα \( \SI{1.2}{s} \) η συνάρτηση φτάνει πολύ κοντά στην τελική της τιμή, δηλαδή
για τη σταθερά χρόνου ισχύει
\( 4τ \approx 1.2 \implies τ \approx 0.3 \). Αυτή η σταθερά χρόνου αντιστοιχεί σε μια συνάρτηση μεταφοράς \( \frac{α}{0.3s+1}
\approx \frac{α'}{s+3.33} \). Άρα η σωστή απάντηση είναι η \textbf{(δ)}.

\end{exercise}
\begin{exercise}
Ποιό από τα παρακάτω συστήματα έχει τη μεγαλύτερη ταχύτητα ανόδου;

\begin{enumlatin}
	\item \( \displaystyle \frac{s+10}{(s+2)^2+5} \)
	\item \( \displaystyle \frac{s+3}{(s+2)^2+5} \)
	\item \( \displaystyle \frac{s+10}{(s+2)^2+10} \)
	\item \( \displaystyle \frac{s+3}{(s+2)^2+10} \)
\end{enumlatin}

\tcblower
Θυμίζουμε ότι οι παρονομαστές των παραπάνω συναρτήσεων έχουν γραφεί με τη μορφή
\( (s+σ)^2 + \omega_d^2 \), και έχουν λύση \underline{\( -σ\pm j\omega_d \)}.

Η ταχύτητα ανόδου εξαρτάται από τον χρόνο ανόδου.

Θυμόμαστε επίσης ότι για μεγαλύτερο \( \omega_d \) ή μηδενικό \( z \) κοντά στον
φανταστικό άξονα, έχουμε μικρότερο χρόνο ανόδου \( t_{r_1} \),
ενώ ο χρόνος ανόδου \( t_{r_1} \) ορίζεται ως ο χρόνος που απαιτείται μέχρι η απόκριση να φτάσει από
το 10\% ως το 90\% (προσοχή στη διαφορά από το χρόνο \( t_r\) μέχρι την πρώτη φορά που φτάνουμε στην επιθυμητή τιμή):

\begin{tikzpicture}[scale=1.4]
\draw[->] (-0.5,0) -- (5,0) node[below right] {$t$};
\draw[->] (0,-0.5) -- (0,4) node[below left] {$y(t)$};

\draw[thick,dashed] (0,2) node[left] {$y_\mathrm{ss}$} -- ++(6,0);

\draw[dashed] (0.1,-0.1) |- (0,0.2) node[left,scale=.7] {$0.1y_{\mathrm{ss}}$};
\draw[dashed] (0.4,-0.1) |- (0,1.8) node[left,scale=.7] {$0.9y_{\mathrm{ss}}$};

\draw[ultra thick,blue,opacity=.7]
plot [variable=\t,domain=0:6,samples=\gsamples]
(\t,{2*(1-1*exp(-0.8*\t)*cos(3.5*\t r))});

\draw[very thick,cyan,opacity=.2]
plot [variable=\t,domain=0:6,samples=\gsamples]
(\t,{2*(1+1*exp(-0.8*\t))});
\draw[very thick,cyan,opacity=.2]
plot [variable=\t,domain=0:6,samples=\gsamples]
(\t,{2*(1-1*exp(-0.8*\t))});

\draw[dashed] (0.84,0) node[below,xshift=2mm] {$t_p$}-- ++(0,3)
-- (0,3) node[left] {$y_{\mathrm{ss}_{M_p}}$};
\draw[dashed] (0.44,0) node[below] {$t_r$} -- ++(0,2);

\filldraw[thick,draw=orange,draw opacity=.5,fill=white!90!orange,fill opacity=.6]
(0.84,3) circle (1.7pt);
\filldraw[thick,draw=orange!50!green,draw opacity=.5,fill=orange!50!green!10!white,fill opacity=.6]
(0.44,2) circle (1.7pt);

\draw[dashed] (3.3,0) node[below] {$t_s\approx\frac{4}{τ}=\frac{4}{ζ\omega_n}$} -- ++(0,2);

\draw[gray] ([yshift=-1mm]0.1,0) -- ++(0,-0.6) node (a) {};
\draw[gray] ([yshift=-1mm]0.4,0) -- ++(0,-0.6) node (b) {};

\draw[<->] ([xshift=1pt]a.north) -- ([xshift=-1pt]b.north) node[below,midway,scale=.7] {$t_{r_1}$};
\end{tikzpicture}

Η σωστή απάντηση είναι η \textbf{(δ)}, η οποία έχει το μεγαλύτερο \( \omega_d \) και το
μηδενικό \( z=-3 \) που είναι κοντινότερο στον άξονα.

(Βέβαια γρήγορη ταχύτητα ανόδου δεν σημαίνει και γρήγορη απόκριση).

\end{exercise}
\begin{exercise}
Πόσο πρέπει να είναι τα \( k_p \) ώστε να έχουμε μοναδιαίο DC κέρδος, και ποιός είναι ο
χρόνος αποκατάστασης του κάθε συστήματος;

\begin{enumlatin}
	\item \( \displaystyle \frac{k_{p_1}}{s+3} \)
	\item \( \displaystyle \frac{k_{p_2}}{(s+3)(s+20)} \)
\end{enumlatin}

\tcblower
\begin{enumlatin}
	\item \( k_{p_1} = 3 \), η χρονική σταθερά είναι \( τ=\frac{1}{3} \), άρα
	ο χρόνος αποκατάστασης προκύπτει
	\( t_s = \frac{4}{3} \).
	\item \( k_{p_2} = 60 \), ο κυρίαρχος πόλος είναι ο πιο κοντινός (\( s=-3 \)), και
	επομένως \( τ=\frac{1}{3} \) και \( t_s = \frac{4}{3} \).
\end{enumlatin}

Σε περίπτωση που μας δινόταν \( \displaystyle \frac{K_{p_2}(s+3.1)}{(s+3)(s+20)} \), το
μηδενικό στο -3.1 θα αλληλοαναιρούνταν με τον πόλο στο -3, και επομένως ο κυρίαρχος πόλος θα
ήταν στο -20.

\end{exercise}
\begin{exercise}
Έστω η συνάρτηση μεταφοράς:
\[
\frac{18}{s^2+11s+18}
\]
Ποιός είναι ο χρόνος αποκατάστασής της;

\tcblower

\begin{attnbox}{}
	Έχουμε \textbf{δύο πραγματικές ρίζες}, οπότε δεν είναι σωστό να ακολουθήσουμε τη
	μεθοδολογία με τα \( σ \) και \( \omega_d \).
\end{attnbox}

Οι πόλοι του συστήματος βγαίνουν -2 και -9, ο κυρίαρχος είναι ο -2, επομένως \( t_s=\frac{4}{2} = 2 \).

\end{exercise}

\subsection{Εύρος ζώνης}
Το \textbf{εύρος ζώνης} είναι μία προδιαγραφή του συστήματος που σχετίζεται με το πεδίο
της συχνότητας. Πιο συγκεκριμένα, μπορεί να απαιτηθεί να έχουμε ένα συγκεκριμένο
\textbf{εύρος ζώνης} \( \omega_b \), για παράδειγμα \( \omega_b > \SI{100}{\radian/\second} \).

Η μελέτη αυτής της προδιαγραφής μπορεί να μελετηθεί με τη βοήθεια των
\textbf{διαγραμμάτων Bode} (προφ. "Μπόντε"), τα οποία εκφράζουν το πλάτος και τη φάση
για κάθε συχνότητα.

Ο έλεγχος γίνεται δίνοντας ως είσοδο στο σύστημα ένα μεγάλο εύρος συχνοτήτων:

\begin{circuitikz}
	\draw (0,0) node[rectangle,draw,minimum height=7mm,minimum width=5mm]
	(h) {$H(s)$};
	
	\draw (-1,0) node[oscillator] (osc) {};
	
	\draw (h.east) to[short,-o] ++(1,0);
	\draw (h.west) to[short,-*] (osc.east);
\end{circuitikz}

και στη συνέχεια κατασκευάζοντας δύο διαγράμματα, ένα για το πλάτος ως συνάρτηση της
συχνότητας, και ένα για τη φάση, ως εξής:

\begin{tikzpicture}
\draw[->] (0,-5.5) -- (0,3) node[above left] {$|A|$};
\draw[->] (-1,0) -- (6,0) node[below right] {$\omega$};

\draw[very thick,blue!50!cyan!70!black,name path=FR] plot[smooth,tension=1]
coordinates {(0,1.5) (1.5,1.6) (3,2.5) (4.5,1.4) (6,0.7) };

\path[name path=l] (0,1.5*0.707)-- ++(6,0);

\path [name intersections={of=FR and l,by=G}];
\draw[dashed] (G) -- (G -| 0,0) node[left] {$0.707$};
\draw (0,1.5) node[left] {$1$};
\draw[dashed] (3,2.5) -- (3,0);
\draw[dashed] (G) -- (G |- 0,0) node[below] {$\omega_b$};

\draw[->] (0,-2.2) node[above left] {$φ$} -- ++(6,0) node[right] {$\omega$};

\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-4cm] plot[smooth,variable=\x,domain=0:6,samples=18]
(\x,{3*atan((-\x +3)*3)/180});

\draw (0,-2.6) node[left] {$0\degree$};
\draw[dashed] (0,{(-2.6-5.3)/2}) node[left] {$45\degree$} -- ++(3,0);
\draw (0,-5.3) node[left] {$90\degree$};
\end{tikzpicture}

Τα περισσότερα συστήματα είναι χαμηλοπερατά.

Όσο μεγαλύτερο είναι το εύρος ζώνης ενός συστήματος, τόσο ταχύτερη είναι η απόκρισή του.
Αυτό μπορούμε να το διαπιστώσουμε αν σκεφτούμε την τετραγωνική κυματομορφή,
που έχει συχνότητες που εκτείνονται μέχρι το άπειρο (αν θυμηθούμε τις σειρές Fourier),
άρα ένα σύστημα που θέλει να την αναπαραστήσει, όσο μεγαλύτερο εύρος ζώνης έχει,
τόσο πιο γρήγορα θα αποκριθεί στην είσοδο.

\begin{tikzpicture}
\draw[very thick,blue!50!cyan!]
plot[smooth,tension=.6]
%plot[smooth,variable=\x,domain=0:6,samples=12]
%(\x,{4/pi*1/1*sin(1*pi*\x r) + 4/pi*1/3*sin(3*pi*\x r)});
coordinates {(0,0) (0.5,1) (0.8,0.7) (1,0) (1.5,0) (2,0) (2.3,0.8) (2.9,1) (3,0) (4,0) (4.2,1) (4.8,1) (4.9,0) (5.2,0)};

\draw[very thick] plot[const plot]
coordinates {(0,0) (0,1) (1,0) (2,1) (3,0) (4,1) (5,0) };
\end{tikzpicture}

Επομένως, είναι επιθυμητό να έχουμε μεγάλο εύρος ζώνης για να αυξήσουμε την ταχύτητα, αλλά
πρέπει να λάβουμε σε αυτήν την περίπτωση υπ' όψιν και τον θόρυβο, ο οποίος βρίσκεται κυρίως
στις υψηλότερες συχνότητες.

Τα διαγράμματα Bode γίνονται συνήθως σε λογαριθμική κλίμακα, που ορίζεται ως εξής:
\[
20\log\left\lvert \frac{\omega}{\omega_0} \right\rvert
\]

\begin{tikzpicture}
\draw[->] (0,-4) -- (0,1.5);
\draw[->] (0,0) -- (6,0);

\draw[very thick,blue!50!cyan!70!black,name path=FR,mark position=0.9(c)] plot[smooth,tension=0.7,yscale=1.2]
coordinates {(0,0) (1.7,0.7)  (4.5,-0.3) (6,-0.5)};

\draw (0,0) node[left] {0 dB};
\draw[dashed] (c) -- (c -| 0,0) node[left] {-3 dB};

\path[name path=l] (0,1.5*0.707)-- ++(6,0);

\draw[->] (0,-2.2) -- ++(6,0);

\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-3cm] plot[smooth,variable=\x,domain=0:6,samples=18]
(\x,{1.5*atan((-\x +3)*3)/180});
\end{tikzpicture}

και ορίζουμε το εύρος ζώνης να είναι η απόσταση μεταξύ των συχνοτήτων στις οποίες η έξοδος
έχει τιμή \(-3\) dB, που αντιστοιχεί στην τιμή 0.707, αν το πλάτος 1 αντιστοιχεί σε 0 dB.

Προσοχή ότι η λογαριθμική κλίμακα στον οριζόντιο άξονα των συχνοτήτων δηλώνει ότι στην
αρχή των αξόνων δεν έχουμε τη συχνότητα 0, αλλά απλώς μία μικρή συχνότητα.

\begin{attnbox}{Δεκαδικός λογάριθμος}
	\textbf{Προσοχή!} Με την πράξη \( \mathlarger{\log} \) εννοούμε τον \textbf{δεκαδικό} λογάριθμο,
	και όχι τον φυσικό \( \ln \). Δηλαδή:
	\[
	\mathlarger{\mathlarger{ \log = \log_{10} }}
	\]
	
	Επίσης ισχύει \( \displaystyle \log x = \frac{\ln x}{\ln 10} \).
\end{attnbox}

\subsubsection{Σε πρωτοβάθμια συστήματα}
Ας ασχοληθούμε με το σύστημα \( \displaystyle H(s)=\frac{1}{1+sτ} \).

Στην απόκριση συχνότητας μάς ενδιαφέρει η έξοδος του συστήματος σε ημιτονοειδείς όρους,
δηλαδή για \( s = j\omega  \), οπότε:
\[
H(j\omega ) = \frac{1}{1+j\omega τ}
\]

Η απόκριση φάσης είναι:
\[
φ(\omega) = \arg\left( H(j\omega) \right) = \arg\left(\frac{1-j\omega τ}{(1+j\omega τ)(1-j\omega τ)}\right)
= -\tan^{-1}
\frac{
	\overbrace{
	\frac{\omega τ}{(1+j\omega τ)(1-j\omega τ)}
}^{\mathclap{\text{φανταστικό μέρος}}}
}{
	\underbrace{\frac{1}{(1+j\omega τ)(1-j\omega τ)}}_{\mathclap{\text{πραγματικό μέρος}}}
} =
-\tan^{-1}(\omega τ)
\]

Η απόκριση συχνότητας τότε θα είναι:
\begin{align*}
	20\log\left\lvert H(j\omega ) \right\rvert &=
	-20\log\left\lvert 1+j\omega τ \right\rvert \\
	&= -20\log \left( 1+\omega^2 τ^2 \right)^{\frac{1}{2}}
	\\ &= -10\log(1+\omega^2τ^2)
\end{align*}

Ο σκοπός όμως είναι για την παραπάνω έκφραση να γνωρίζουμε προσεγγιστικά πώς μπορεί να
παρουσιαστεί σε διάγραμμα.

Ψάχνουμε τις ασύμπτωτες για την παραπάνω σχέση, και έχουμε:
\[
\begin{cases}
\text{για } \omega \ll \frac{1}{τ} &\quad =0\ \mathrm{dB} \\
\text{για } \omega \gg \frac{1}{τ} &\quad =-20\log \omega τ = \underbrace{-20\log\omega}_{\omega_c=\frac{1}{\tau}} -20\log\tau
\end{cases}
\]
(όπου ονομάζουμε την \( \omega_c = \frac{1}{\tau} \) χαρακτηριστική συχνότητα του συστήματος)

Έτσι, έχουμε δύο ασύμπτωτες ευθείες, και μπορούμε να προσεγγίσουμε τη συνάρτηση:

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-3) -- (0,2);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[variable=\x,domain=0:4,samples=18,smooth,yshift=-1pt]
(\x,{-10*0.06*ln(1+    ( (exp(ln(10)*(\x-3)))/1  )^2     )});

\draw[ultra thick,orange!90!blue!90!black,opacity=.7]
(0,0) -- (3,0) -- ++(-68:3);

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!90!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!70!black] (b) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\draw (b.east) node[right] {πραγματική απόκριση};
\end{tikzpicture}

(Η χειρότερη προσέγγιση ίσως γίνεται στο σημείο όπου τέμνονται οι ευθείες, στο οποίο η
πραγματική τιμή είναι \( -10\log2 = -3\ \mathrm{dB} \)).

Για το σχεδιασμό του διαγράμματος φάσης, έχουμε:
\[
\begin{cases}
\text{για } \omega = 0 &\quad = 0\\
\text{για } \omega =\infty &\quad = -90\degree\\
\text{για } \omega = \omega_c &\quad = -45\degree
\end{cases}
\]

\begin{tikzpicture}
\draw[->] (0,-3.5) -- (0,2);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[variable=\x,domain=0:3.5,samples=18,smooth,yshift=-1pt]
(\x,{-10*0.02*ln(1+    ( (exp(ln(10)*(\x-2)))/1  )^2     )});

\draw[ultra thick,orange!90!blue!90!black,opacity=.7]
(0,0) -- (2,0) -- ++(-40:2);

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!90!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!70!black] (b) {};
%\draw (a.east) ++(0.25,0) node[minimum width=2mm,minimum height=2mm,rectangle] (a) {};
\draw (b.east) ++(0.25,0) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!50!green!70!black] (b) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\draw (b.east) node[right] {πραγματική απόκριση};

\def\plh{-2.2}
\def\ptl{0.15}

\draw[->] (0,\plh) -- ++(4.5,0);

\begin{scope}[every node/.style={scale=.8,yshift=2pt}]
\draw (0,\plh) node[above right] {$\sfrac{0.01}{τ}$};
\draw (1,\plh) node[above] {$\sfrac{0.1}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (2,\plh) node[above] {$\sfrac{1}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (3,\plh) node[above] {$\sfrac{10}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (4,\plh) node[above] {$\sfrac{100}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);

\draw[dashed] (0,-2.7) node[left] {$-45\degree$} -| (2,0);
\draw (0,-2.7-0.5) node[left] {$-90\degree$};
\draw[->] (0,-2.7-0.5) -- ++(4.5,0);
\end{scope}

\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-2.7cm] plot[smooth,variable=\x,domain=0:4.4,samples=18]
(\x,{1*atan((-\x +2)*5)/180});
\end{tikzpicture}

Επίσης, μπορούμε να κάνουμε μια γραμμική προσέγγιση αυτής της εξόδου στη φάση, θεωρώντας
οριζόντια έξοδο μία δεκάδα πριν και μετά από τη χαρακτηριστική συχνότητα, και γραμμική
ανάμεσα:

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-3.5) -- (0,2);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[variable=\x,domain=0:3.5,samples=18,smooth,yshift=-1pt]
(\x,{-10*0.02*ln(1+    ( (exp(ln(10)*(\x-2)))/1  )^2     )});

\draw[ultra thick,orange!90!blue!90!black,opacity=.7]
(0,0) -- (2,0) -- ++(-40:2);

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!90!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!70!black] (b) {};
\draw (a.east) ++(0.25,0) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=magenta] (a) {};
\draw (b.east) ++(0.25,0) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!50!green!70!black] (b) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\draw (b.east) node[right] {πραγματική απόκριση};

\def\plh{-2.2}
\def\ptl{0.15}

\draw[->] (0,\plh) -- ++(4.5,0);

\begin{scope}[every node/.style={scale=.8,yshift=2pt}]
\draw (0,\plh) node[above right] {$\sfrac{0.01}{τ}$};
\draw (1,\plh) node[above] {$\sfrac{0.1}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (2,\plh) node[above] {$\sfrac{1}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (3,\plh) node[above] {$\sfrac{10}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);
\draw (4,\plh) node[above] {$\sfrac{100}{τ}$} ++(0,\ptl/2) -- ++(0,-\ptl);

\draw[dashed] (0,-2.7) node[left] {$-45\degree$} -| (2,0);
\draw (0,-2.7-0.5) node[left] {$-90\degree$};
\draw[->] (0,-2.7-0.5) -- ++(4.5,0);
\end{scope}

\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-2.7cm] plot[smooth,variable=\x,domain=0:4.4,samples=18]
(\x,{1*atan((-\x +2)*5)/180});

\draw[gray,dashed] (3,\plh) -- ++(0,-1);

\draw[ultra thick,magenta,yshift=-2.7cm]
(0,0.5) -- (1,0.5) -- (3,-0.5) -- (4.4,-0.5);
\end{tikzpicture}

δηλαδή:
\[
φ = -45-45\log|\omega_t|
\]

Αν είχαμε μια συνάρτηση με ένα κέρδος \( κ \neq 1 \), τότε στο διάγραμμα μέτρου απλώς
προστίθεται μια σταθερά \( 20\log κ \), και το διάγραμμα θα ανεβεί προς τα πάνω ή προς τα
κάτω, ανάλογα με το αν \( κ > 1 \) ή \( κ < 1 \) αντίστοιχα.

Με τα διαγράμματα Bode μπορούμε επομένως να βρούμε την έξοδο του συστήματος σε ημιτονοειδή
είσοδο. Για την απόκριση ταχύτητας, ενδιαφέρουν περισσότερο τα διαγράμματα πλάτους και όχι
φάσης.

\subsubsection{Σε δευτεροβάθμια συστήματα}
Θυμίζουμε τη συνάρτηση μεταφοράς δευτεροβάθμιων συστημάτων:
\[
H(s) = \frac{\omega_n^2}{s^2+2ζ\omega_n s + \omega_n^2}
\]

Όπως παραπάνω, για να πάρουμε την απόκριση συχνότητας θεωρούμε \( s = j\omega  \):
\begin{align*}
	H(j\omega )&= \frac{1}{1-\left(\frac{\omega }{\omega_n}\right)^2
		+j2ζ\frac{\omega}{\omega_n}} \\
	\left\lvert H(j\omega ) \right\rvert_{\mathrm dB}
	&= -10\log\left[
	\left(1-\frac{\omega^2}{\omega_n^2}\right)^2+4ζ^2\frac{\omega^2}{\omega_n^2}
	\right]
\end{align*}

Κάνουμε προσέγγιση με ασυμπτώτους:
\[
\begin{cases}
	\frac{\omega}{\omega_n} \ll 1 &\quad 0\ \mathrm{dB} \\
	\frac{\omega}{\omega_n} \gg 1 &\quad -40\log\frac{\omega}{\omega_n} \\
%	\omega = \omega_n &\quad 0 \ \mathrm{dB}
\end{cases}
\]

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-2) -- (0,1);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};

\draw[ultra thick,orange!90!blue!80!black,opacity=1]
(0,0) -- (2,0) -- ++(-40:3)
node[midway,right] {-40 dB/dec};

\filldraw (2,0) circle (1pt) node[above] {$\omega_n$};

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!80!black] (a) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\end{tikzpicture}

Στην πραγματικότητα, η απόκριση συχνότητας μοιάζει ως εξής, και εξαρτάται από το \( ζ \):

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-2) -- (0,1.5);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};

%\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)] plot[variable=\x,domain=0:4,samples=18,smooth,yshift=-1pt] (\x,{-10*0.06*ln(1+    ( (exp(ln(5)*(\x-3)))/1  )^2     ) +10*0.02*ln(1+    ( (exp(ln(10/4)*(\x-1)))/1  )^2     ) });

\draw[blue!50!cyan!70!black]
(2.25,0) -- ++(0,1);

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth] coordinates {(0,0) (1.5,0.05) (2.5,0.1) (4.4,-1.8)};
\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth] coordinates {(0,0) (1.5,0.2) (2.5,0.5) (4.4,-1.75)};
\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth,tension=.6] coordinates {(0,0) (1.5,0.4) (2.5,0.9) (4.4,-1.7)};

\filldraw[blue!50!cyan!70!black]
(2.25,0) circle (1pt) node[below right,scale=.9] {$\omega_r$};

\draw[ultra thick,orange!90!blue!80!black,opacity=1]
(0,0) -- (2,0) -- ++(-40:3)
node[midway,below left] {-40 dB/dec};

\filldraw (2,0) circle (1pt) node[above] {$\omega_n$};

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!80!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!70!black] (b) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\draw (b.east) node[right] {πραγματική απόκριση};
\end{tikzpicture}

Παρατηρούμε μία υπερύψωση κοντά στο \( \omega_n \) (αλλά όχι ακριβώς επάνω του), που αυξάνεται
όσο μειώνεται το \( ζ \), και συχνά δεν είναι επιθυμητή.

Αν παραγωγίσουμε την έξοδο για να βρούμε το ακρότατο (θέτουμε \( u=\frac{\omega}{\omega_n} \) για ευκολία):
\[
\od{H}{u} = \frac{1}{\sqrt{1-u^2+(2ζu)^2}}
\]
η οποία μηδενίζεται για \( \frac{\omega}{\omega_n} = u = \sqrt{1-2ζ^2} \). Αυτό ορίζεται
αν \( ζ<0.707 \), δηλαδή υπάρχει υπερύψωση μόνο όταν \( \boxed{ζ<0.707} \).

\begin{theorem}{Εύρος ζώνης δευτεροβάθμιου συστήματος}{}
	Το \emph{εύρος ζώνης} (μέχρι τα -3 dB) αποδεικνύεται ότι είναι:
	\[
	\omega_b = \omega_n \left[
	1-2ζ^2+\sqrt{2-4ζ^2+4ζ^4}
	\right]^{\sfrac{1}{2} }
	\]
\end{theorem}

\begin{theorem}{Συχνότητα συντονισμού δευτεροβάθμιου συστήματος}{}
	Η \textbf{συχνότητα συντονισμού} \( \omega_r \), δηλαδή η συχνότητα κατά την οποία
	έχουμε υπερύψωση, είναι:
	\[
	\omega_r = \omega_n\sqrt{1-2ζ^2} \qquad ζ < 0.707
	\]
	ενώ το πλάτος της υπερύψωσης:
	\[
	M_r = \frac{1}{2ζ\sqrt{1-ζ^2}}
	\]
\end{theorem}

Όσον αφορά τη φάση,
\[
\phi(\omega) = -\tan^{-1}\frac{2ζ\frac{\omega}{\omega_n}}{1-\frac{\omega^2}{\omega_n^2}}
\]
Ασυμπτωτικά:
\[
\begin{cases}
\frac{\omega}{\omega_n} = 0 &\quad φ = 0\\
\frac{\omega}{\omega_n} = 1 &\quad φ = -\sfrac{π}{2} \\
\frac{\omega}{\omega_n} \to \infty &\quad φ=-π
\end{cases}
\]

και συμπληρώνουμε το διάγραμμα Bode:

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-4) -- (0,1.5);
\draw[->] (0,0) -- (4,0) node[below] {$\omega$};
\draw[->] (0,-2) -- ++(4.5,0);

%\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)] plot[variable=\x,domain=0:4,samples=18,smooth,yshift=-1pt] (\x,{-10*0.06*ln(1+    ( (exp(ln(5)*(\x-3)))/1  )^2     ) +10*0.02*ln(1+    ( (exp(ln(10/4)*(\x-1)))/1  )^2     ) });

\draw[dashed] (2,0) -- ++(0,-3) -- ++(-2,0);

\draw[blue!50!cyan!70!black]
(2.25,0) -- ++(0,1);

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth] coordinates {(0,0) (1.5,0.05) (2.5,0.1) (4.4,-1.8)};
\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth] coordinates {(0,0) (1.5,0.2) (2.5,0.5) (4.4,-1.75)};
\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[smooth,tension=.6] coordinates {(0,0) (1.5,0.4) (2.5,0.9) (4.4,-1.7)};

\filldraw[blue!50!cyan!70!black]
(2.25,0) circle (1pt) node[below right,scale=.9] {$\omega_r$};

\draw[ultra thick,orange!90!blue!80!black,opacity=1]
(0,0) -- (2,0) -- ++(-40:3)
node[midway,below left] {-40 dB/dec};

\filldraw (2,0) circle (1pt) node[above] {$\omega_n$};

\draw (current bounding box.north east) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=orange!90!blue!80!black] (a) {};
\draw (a.south) ++(0,-0.5) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=blue!50!cyan!70!black] (b) {};
\draw (a.east) ++(0.25,0) node[minimum width=2mm,minimum height=2mm,rectangle,draw,fill=magenta] (a) {};

\draw (a.east) node[right] {προσεγγιστική απόκριση};
\draw (b.east) node[right] {πραγματική απόκριση};

\draw[ultra thick,magenta,name path=FR,yshift=-3cm] plot[smooth,variable=\x,domain=0:4.4,samples=18]
(\x,{1.5*atan((-\x +2)*5)/180});
\end{tikzpicture}

Βέβαια η πραγματική συμπεριφορά εξαρτάται πάλι από το \( ζ \).


\begin{exercise}
Έστω ένα σύστημα:

\begin{circuitikz}
	\draw (0,0) node[circle,inner sep=2mm,draw] (sum) {};
	\draw (1.5,0) node[rectangle,minimum height=5mm,draw] (H) {$\frac{k}{s(s+a)}$};
	
	\draw[<-] (sum) -- ++(-1.5,0);
	\draw (sum) -- (H);
	\draw[->] (H) -- ++(2,0) node[midway] (P) {};
	\draw[->] (P.center) -- ++(0,-1)  -| (sum);
\end{circuitikz}

Ζητείται να βρεθούν οι σταθερές \( k \) και \( a \), ώστε η υπερύψωση συχνότητας να είναι
\( Μ_{\mathrm{pr}} = 1.04 \) για συχνότητα συντονισμού
\( \omega_r = 11.47 \ \sfrac{\mathrm{rad}}{s} \). Και από
εκεί, ζητείται να προσδιοριστεί ο χρόνος αποκατάστασης \( t_s \) και το εύρος ζώνης
\( \omega_b \).
\tcblower
Από τους παραπάνω τύπους, έχουμε:
\begin{align*}
	\frac{1}{2ζ\sqrt{1-ζ^2}} = 1.04 \implies
	4ζ^4-4ζ^2+0.92 = 0 \implies ζ^2 = \begin{cases}
	0.64 \\ 0.352
	\end{cases} \implies \cancel{ζ=0.8 } \text{ ή } \boxed{ζ=0.6}
\end{align*}

Απορρίπτουμε την περίπτωση \( ζ=0.8 \), αφού για να υπάρχει υπερύψωση \textbf{στη συχνότητα} πρέπει
\( ζ < 0.707 \). Άρα \( ζ = 0.6 \).

Τότε υπολογίζουμε ακόμα ότι
\( \omega_n = \frac{\omega_r}{\sqrt{1-2ζ^2}} \approx \SI{21.67}{\radian/\second}  \).

Η συνάρτηση μεταφοράς του συστήματος βγαίνει μετά από πράξεις \( \displaystyle 
\frac{k}{s^2+as+k}  = \frac{\omega_n^2}{s^2+2ζ\omega_n s + \omega_n^2} \).

Άρα \( k=21.67^2=469.59 \), και \( a=2ζ\omega_n = 2\cdot 0.6\cdot 21.67 =26.00 \).

\subparagraph{}

Ο χρόνος αποκατάστασης είναι (αφού έχουμε συζυγείς ρίζες, διότι \( ζ < 1 \)):
\[
t_s \approx \frac{4}{ζ\omega_n} = \frac{4}{13} \approx \SI{0.3077}{\second}
\]

Και το εύρος ζώνης:

\[
\omega_b = \omega_n \left[
1-2ζ^2+\sqrt{2-4ζ^2+4ζ^4}
\right]^{\sfrac{1}{2} }
\approx \SI{24.88}{\radian/\second}
\]
\end{exercise}
\subsubsection{Σε συστήματα μεγαλύτερου βαθμού}

Γενικά ισχύει:
\[
H(s) = \frac{G}{s^n}\frac{(τ_js+1)\cdots}{(t_is+1)\cdots}
\]

Αυτό αντιστοιχεί, όπως έχουμε δει παραπάνω, σε ένα άθροισμα πιο απλών κλασμάτων. Επομένως,
για να βρούμε το διάγραμμα Bode, απλώς προσθέτουμε τις επιμέρους αποκρίσεις.

Επίσης, αν έχουμε ένα σύστημα \( \frac{1}{τs+1} \), και το αντιστρέψουμε, \(\frac{τs+1}{1} \),
	η έξοδος θα είναι αντίθετη, από την ιδιότητα του λογαρίθμου.
	
\begin{tikzpicture}[scale=0.89]
\draw[->] (0,-3) -- (0,1.5);
\draw[->] (0,0) -- (4.5,0) node[below] {$\omega$};
\draw[->] (0,-2) -- ++(4.5,0);

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[variable=\x,domain=0:4,samples=18,smooth]
(\x,{-10*0.02*ln(1+    ( (exp(ln(10)*(\x-2.2)))/1  )^2     )});
\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-2.7cm] plot[smooth,variable=\x,domain=0:4.4,samples=18]
(\x,{1*atan((-\x +2)*5)/180});

\draw[very thick,>->] (5,-1) -- ++(0.7,0);

\begin{scope}[xshift=6cm]
\draw[->] (0,-3) -- (0,1.5);
\draw[->] (0,0) -- (4.5,0) node[below] {$\omega$};
\draw[->] (0,-2) -- ++(4.5,0);

\draw[ultra thick,blue!50!cyan!70!black,mark position=0.67(c)]
plot[variable=\x,domain=0:4,samples=18,smooth]
(\x,{10*0.02*ln(1+    ( (exp(ln(10)*(\x-2.2)))/1  )^2     )});
\draw[very thick,blue!50!cyan!50!green!70!black,name path=FR,yshift=-1.4cm] plot[smooth,variable=\x,domain=0:4.4,samples=18]
(\x,{-1*atan((-\x +2)*5)/180});
\end{scope}

\end{tikzpicture}
	
\paragraph{}
Για το απλό σύστημα \( \displaystyle H(s)=\frac{G}{s} \), έχουμε:
\begin{align*}
	|H|_{\mathrm{dB}} &= 20\log G - 20\log\omega \\
	φ &= -\sfrac{π}{2} 
\end{align*}

και το διάγραμμα Bode γίνεται (σε συνδυασμό με το \( H(s) = Gs \)):

\begin{tikzpicture}[scale=1]
\draw[->] (0,-3) -- (0,1.5);
\draw[->] (0,0) node[left] {0 dB} -- (4.5,0) node[below] {$\omega$};
\draw[->] (0,-1.5) -- ++(4.5,0);

\draw[ultra thick,orange!90!blue!80!black]
(0,1.4) -- (4,-0.7) node[pos=.3,above,sloped] {-20 dB/dec};
\draw[ultra thick,orange!50!blue!80!black]
(0,-0.7) -- (4,1.4) node[pos=.08,below right] {+20 dB/dec};
\draw[ultra thick,magenta,yshift=-2.4cm] (0,0) node[left] {$\ang{90}$} -- ++(4.5,0);

\filldraw (2.68,0) circle(1pt) node[above right] {$G$};
\filldraw (1.34,0) circle(1pt) node[below right] {$\frac{1}{G}$};
\end{tikzpicture}

Γενικά, μπορούμε να συνθέσουμε οποιαδήποτε συνάρτηση μεταφοράς με τα παρακάτω στοιχεία:
\begin{itemize}
	\item \( H_0 = Gs^ν \)
	\item \( \displaystyle H_1 = \left( \frac{s}{ρ}+1 \right) \) για \( p>0 \)
	\item \( \displaystyle H_2 = \left( \frac{s^2}{\omega_n^2} + \frac{2ζs}{\omega_n} + 1 \right) \) για \( \omega_n > 0 \) και \( 0<ζ<1 \).
\end{itemize}

Για παράδειγμα, για την \(\frac{s(s+3)}{(s+4)\left( (s+5)^2+4 \right)} \):
\[
\frac{s(s+3)}{(s+4)\left( (s+5)^2+4 \right)}
= \frac{  \overbrace{s}^{H_0}  \cdot  (s+3)
}{
	(s+4) \cdot \left(
	\frac{s^2}{\omega_n^2} + \frac{2\zeta s}{\omega_n} + 1
	\right)
}
= \frac{  \overbrace{s}^{H_0}  \cdot  3 \cdot \overbrace{\left(\frac{s}{3}+1\right)}^{H_1}
}{
	4 \cdot \underbrace{\left(\frac{s}{4}+1\right)}_{H_1} \cdot \underbrace{ \left(
		\frac{s^2}{29} + \frac{2\cdot 0.928\cdot  s}{5.39} + 1
		\right)
	}_{H_2}
}
\]

\pagebreak[1]
Για καθεμία από αυτές, έχουμε:
\begin{itemize}
	\item
	\( \displaystyle \left\lvert H_0(j\omega)\right\rvert_{\mathrm{dB}} 
	= 20\log G\omega^ν = 20\log G + 20ν\log ω
	\)
	και:\\
	\( \phi_0 = ν\cdot 90\degree \)
	
	Και το αντίστοιχο διάγραμμα Bode είναι:
	
	\begin{tikzpicture}[scale=1]
	\draw[->] (0,-3) -- (0,3.5) node[left,scale=1.2] {$H_0$};
	\draw[->] (0,0) -- (4.5,0) node[above] {$\omega$};
	\draw[->] (0,-2.5) -- ++(4.5,0) node[above] {$\omega$};
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,0) -- (4.5,3/4*4.5);
	
	\draw (0,2*3/4) node[left] (a) {};
	\draw (0,3*3/4) node[left] (b) {};
	\draw[<->] (a) -- (b) node[midway,left] {20 dB};
	
	
	\foreach \x in {1,2,...,4} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
		\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\draw (0,-0.1) node[below right] {$0.1$};
	
	\draw[ultra thick,magenta]
	(0,-1.7) -- ++(4.5,0);
	\end{tikzpicture}
	
	όπου παρατηρούμε ότι έχουμε αύξηση της απόκρισης κατά 20 dB ανά δεκάδα.
	
	Η ευθεία αυτή θα έχει αντίθετη κλίση αν το \( H_0(s) \) βρίσκεται στον παρονομαστή.
	
	\item
	\( \displaystyle \left\lvert H_1(jω)\right\rvert_{\mathrm{dB}} \approx
	\begin{cases}
	0 \qquad & \text{αν } \omega < p \\
	20\log ω -20\log p \qquad & \text{αν } \omega > p
	\end{cases} \)\\
	και:\\
	\( φ_1 \approx \begin{cases}
	0\degree \qquad & \text{αν } \omega < 0.1p \\
	45\degree + 45\degree \log\frac{\omega}{p} \qquad & \text{αν } 0.1p < \omega < 10p \\
	90\degree \qquad & \text{αν } \omega > 10p
	\end{cases} \)
	
	Άρα η απόκριση γίνεται:
	
	\begin{tikzpicture}[scale=1]
	\draw[->] (0,-3) -- (0,3.5) node[left,scale=1.2] {$H_1$};
	\draw[->] (0,0) -- (4.5,0) node[above] {$\omega$};
	\draw[->] (0,-2.7) -- ++(4.5,0) node[above] {$\omega$};
	
	\draw[gray,dashed] (2,-2.7) -- (2,0);
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,0) -- (2,0) -- (4,2) node[orange!90!blue!40!black,above] {για $ρ=10$};
	
	\draw[dashed] (3,0) |- (0,1) node[left] {20 dB};
	
	\foreach \x in {1,2,...,4} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\draw (0,-0.1) node[below right] {$0.1$};
	
	\draw[ultra thick,magenta,yshift=-2.7cm]
	(0,0) -- (1,0) -- (3,1.5) -- ++(1.2,0);
	
	\foreach \x in {1,2,...,3} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,-2.7-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	\draw[dashed,yshift=-2.7cm] (2,0) |- (0,1.5/2) node[left] {$\ang{45}$};
	\draw[dashed,yshift=-2.7cm] (3,0) |- (0,1.5) node[left] {$\ang{90}$};
	\draw[yshift=-2.7cm] node[left] {$\ang{0}$};
	
	\draw[magenta!50!black,fill=white,opacity=.8,fill opacity=.3] (2,-2.7+1.5/2) circle(3pt);
	\end{tikzpicture}
	
	\item \( 
	\displaystyle H_2 = \frac{s^2}{\omega_n^2} + \frac{2ζ}{\omega_n}s+1
	 \) και αποδεικνύεται ότι:
	 \begin{align*}
	 	\left\lvert H_2(j\omega )\right\rvert_{\mathrm{dB}}
	 	&\approx \begin{cases}
	 	0&\qquad \text{αν } \omega < \omega_n \\
	 	40\log \omega - 40\log \omega_n &\qquad \text{αν } \omega > \omega_n
	 	\end{cases} \\
	 	φ_2 &\approx \begin{cases}
	 	0\degree &\qquad \text{αν } \omega< 0.1\omega_n\\
	 	90\degree +90\degree\log\frac{\omega}{\omega_n} &\qquad 
	 	\text{αν }0.1\omega_n < \omega < 10\omega_n \\
	 	180\degree &\qquad \text{αν } \omega>10\omega_n
	 	\end{cases}
	 \end{align*}
	 
	 \begin{tikzpicture}[scale=1]
	 \draw[->] (0,-3.9) -- (0,3.5) node[left,scale=1.2] {$H_2$};
	 \draw[->] (0,0) -- (4.5,0) node[above] {$\omega$};
	 \draw[->] (0,-3.6) -- ++(4.5,0) node[above] {$\omega$};
	 
	 \draw[gray,dashed] (2,-3.6) -- (2,0);
	 
	 \draw[ultra thick,orange!90!blue!80!black]
	 (0,0) -- (2,0) -- (4,4);
	 
	 \draw[dashed] (3,0) |- (0,2) node[left] {40 dB};
	 
	 \foreach \x in {1,2,...,4} {
	 	\pgfmathsetmacro\result{10^\x/10}
	 	\draw (\x,-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
	 	%\draw[dashed] (\x,0) |- (0,\x*3/4);
	 }
	 \draw (0,-0.1) node[below right] {$0.1$};
	 
	 \draw[ultra thick,magenta,yshift=-3.6cm]
	 (0,0) -- (1,0) -- (3,2.2) -- ++(1.2,0);
	 
	 \foreach \x in {1,2,...,3} {
	 	\pgfmathsetmacro\result{10^\x/10}
	 	\draw (\x,-3.6-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
	 	%\draw[dashed] (\x,0) |- (0,\x*3/4);
	 }
	 
	 \draw[dashed,yshift=-3.6cm] (2,0) |- (0,2.2/2) node[left] {$\ang{90}$};
	 \draw[dashed,yshift=-3.6cm] (3,0) |- (0,2.2) node[left] {$\ang{180}$};
	 \draw[yshift=-3.6cm] node[left] {$\ang{0}$};
	 
	 \draw[magenta!50!black,fill=white,opacity=.8,fill opacity=.3] (2,-3.6+2.2/2) circle(3pt);
	 \end{tikzpicture}
\end{itemize}

\subsubsection{Ασκήσεις}

%\begin{comment}
%	\paragraph{Παράδειγμα}
%	Έστω η συνάρτηση μεταφοράς \( \displaystyle\frac{(s+3)}{(s+1)(s+7)} \). Πώς μπορούμε να
%	κατασκευάσουμε το διάγραμμα Bode της;
%	
%	\subparagraph{Λύση}
%	Αρχικά προσπαθώ να τη μετασχηματίσω σε συνδυασμό των απλών μορφών που παρουσιάστηκαν παραπάνω:
%	\begin{align*}
%	\frac{(s+3)}{(s+1)(s+7)} &=
%	\frac{3\left(\frac{s}{3}+1\right)}{\left(\frac{s}{1} + 1\right)\cdot 7\left(\frac{s}{7} + 1\right)}
%	\\ &= \frac{3}{7} \frac{H_{1a}}{H_{1b}\cdot H_{1c}}
%	\intertext{όπου οι συναρτήσεις \( H_1 \) είναι της μορφής \( \left(\frac{s}{ρ}+1\right)
%	\), με \( p_a=3 \), \( p_b=1 \) και \( p_c=7 \)}
%	&= \frac{3}{7}\cdot \left( \frac{s}{3}+1 \right)
%	\cdot \left(\frac{1}{\frac{s}{7}+1}\right)\cdot \frac{1}{s+1}
%	\end{align*}
%\end{comment}

\todo{continue or remove}


\begin{exercise}
Να βρεθεί η απόκριση συχνότητας του \( \displaystyle
H(s) = \frac{40(s+1)}{s^2(s^2+s+4)} \)
\tcblower

Έχουμε:
\[
H(s) = \underset{\substack{\downarrow\\H_0}}{(10)}
\cdot
\underset{\substack{\downarrow\\H_1\\p=1}}{(s+1)}
\cdot
\underset{\substack{\downarrow\\H_0^{-1}\\ν=2}}{\frac{1}{s^2}}
\cdot
\underset{\substack{\downarrow\\H_2^{-1}\\ \omega_n=2}}{\frac{1}{\frac{s^2}{4}+\frac{s}{4}+1}}
= G_1\cdot G_3 \cdot G_2 \cdot G_4
\]

και εργαζόμαστε για κάθε συνάρτηση ξεχωριστά, σχεδιάζοντας το διάγραμμα Bode της, ώστε
να τα συνδυάσουμε στο τέλος:
\begin{itemize}
	\item \( |G_1|_{\mathrm{dB}} = 20\log10 +\cancelto{0}{20\cdot 0 \cdot\log \omega }  \)
	\\ \( φ =\frac{νπ}{2} = 0 \)
	
	
	\begin{tikzpicture}[scale=1,xscale=0.8]
	\def\phasedown{-1.5}
	
	\draw[->] (0,\phasedown-0.3) -- (0,3);
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,1.5) -- ++(4,0);
	
	\draw[dashed] (0,1.5) node[left] {20 dB};
	
	%\foreach \x in {1,2,...,3} {
	%	\pgfmathsetmacro\result{10^\x/10}
	%	\draw (\x,-3.6-0.1) node[below] {$\pgfmathprintnumber\result$} -- ++(0,0.2);
	%	%\draw[dashed] (\x,0) |- (0,\x*3/4);
	%}
	
	\begin{scope}[yshift=\phasedown cm]
	\draw[->] (0,0) -- ++(4.5,0);
	
	%\draw[dashed] (2,0) |- (0,2.2/2) node[left] {$\ang{90}$};
	%\draw[dashed] (3,0) |- (0,2.2) node[left] {$\ang{180}$};
	\draw node[left] {$\ang{0}$};
	
	\draw[ultra thick,magenta,path fading=east] (0,0) -- ++(4,0);
	\end{scope}
	\end{tikzpicture}
	
	\item \( |G_3|_{\mathrm{dB}} \approx \begin{cases}
    0 \qquad & \text{για } \omega < 1 \\
    20\log\omega - \cancelto{0}{20\log 1} &\text{για } \omega > 1
	\end{cases} \)\\
	\( 
	φ_3 \approx  \begin{cases}
	0\degree \qquad & \text{αν } \omega < 0.1p \\
	45\degree + 45\degree \log\frac{\omega}{p} \qquad & \text{αν } 0.1p < \omega < 10p \\
	90\degree \qquad & \text{αν } \omega > 10p
	\end{cases}
	 \)
	
	\begin{tikzpicture}[scale=1,xscale=0.8]
	\pgfplotsset{
		/pgf/number format/freq/.style={
			fixed,
			%  fixed zerofill,
			%  precision=0,
		},
	}
	\def\phasedown{-2}
	
	\draw[->] (0,\phasedown-0.3) -- (0,3);
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	\draw[gray,dashed] (2,\phasedown) -- (2,0);
	\draw[gray,dashed] (3,\phasedown) -- (3,0);
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,0) -- ++(2,0) -- ++(1,1.5) -- ++(1,1.5);
	
	\draw[dashed] (0,1.5) node[left] {20 dB} -| (3,0);
	
	\foreach \x in {1,2,...,3} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\foreach \x in {1,2,...,3} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	\begin{scope}[yshift=\phasedown cm]
	\draw[->] (0,0) -- ++(4.5,0);
	
	\draw[dashed] (2,0) |- (0,1/2) node[left] {$\ang{45}$};
	\draw[dashed] (3,0) |- (0,1) node[left] {$\ang{90}$};
	%\draw node[left] {$\ang{0}$};
	
	\draw[ultra thick,magenta] (0,0) -- (1,0) -- (3,1) -- (4,1);
	\end{scope}
	\end{tikzpicture}
	
	\item \( |G_2|_{\mathrm{dB}} = \cancelto{0}{20\log 1} + 20(-2)\log \omega = -40\log \omega  \) \\
	\( φ=\frac{νπ}{2} = -π \)
	
	\begin{tikzpicture}[scale=1,xscale=0.8]
	\pgfplotsset{
		/pgf/number format/freq/.style={
			fixed,
			%  fixed zerofill,
			%  precision=0,
		},
	}
	\def\phasedown{-1.5}
	\def\phaseextra{-1.5}
	
	\draw[->] (0,\phasedown+\phaseextra) -- (0,3);
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	%\draw[gray,dashed] (2,\phasedown) -- (2,0);
	%\draw[gray,dashed] (3,\phasedown) -- (3,0);
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,2.5) -- (3.5,-1) node[midway, above right] {-40 dB/dec};
	
	\draw[dashed] (0,2.5) node[left] {40 dB};
	
	\foreach \x in {1,2,...,3} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\foreach \x in {1,2,...,3} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	\begin{scope}[yshift=\phasedown cm]
	\draw[->] (0,0) -- ++(4.5,0);
	
	%\draw[dashed] (2.5,0) |- (0,1/2) node[left] {$\ang{45}$};
	%\draw[dashed] (3,0) |- (0,1) node[left] {$\ang{90}$};
	\draw node[left] {$\ang{0}$};
	\draw (0,-1) node[left] {$\ang{-180}$};
	
	\draw[ultra thick,magenta] (0,-1) -- (4.5,-1);
	\end{scope}
	\end{tikzpicture}
	
	\item \( |G_4|_{\mathrm{dB}} \approx \begin{cases}
	0\qquad&\text{για } \omega  < 2 \ \mathrm{rad/s}
	\\ -40\log\omega + 40\log 2 \qquad &\text{για } \omega > 2
	\end{cases} \) \\
	\( φ =  \begin{cases}
	0\degree &\qquad \text{αν } \omega< 0.2\\
	-90\degree -90\degree\log\frac{\omega}{2} &\qquad 
	\text{αν }0.2 < \omega < 20 \\
	-180\degree &\qquad \text{αν } \omega>20
	\end{cases} \)
	
	\begin{tikzpicture}[scale=1,xscale=0.8]
	\pgfplotsset{
		/pgf/number format/freq/.style={
			fixed,
			%  fixed zerofill,
			%  precision=0,
		},
	}
	\def\phasedown{-3}
	\def\phaseextra{-1.5}
	
	\draw[->] (0,\phasedown+\phaseextra) -- (0,1);
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	%\draw[gray,dashed] (2,\phasedown) -- (2,0);
	%\draw[gray,dashed] (3,\phasedown) -- (3,0);
	
	\draw[ultra thick,orange!90!blue!80!black]
	(0,0) -- (1.3010,0) -- (4.5,-2) node[midway, above right] {-40 dB/dec};
	
	%\draw[dashed] (0,2.5) node[left] {40 dB};
	
	\foreach \x in {1,1.3010,2.3010} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	}
	\foreach \x in {1,1.3010,2.3010} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	}
	
	\begin{scope}[yshift=\phasedown cm]
	\draw[->] (0,0) -- ++(4.5,0);
	
	\draw[dashed] (1.3010,0) |- (0,-1.5/2) node[left] {$\ang{-90}$};
	\draw[dashed] (2.3010,0) |- (0,-1.5) node[left] {$\ang{-180}$};
	\draw node[left] {$\ang{0}$};
	
	\draw[ultra thick,magenta] (0,0) -- (0.3010,0) -- (2.3010,-1.5) -- (4.5,-1.5);
	\end{scope}
	\end{tikzpicture}
\end{itemize}

Τελικά, για να βρούμε τη σωστή απάντηση, προσθέτουμε όλα τα παραπάνω διαγράμματα
(αφού ο πολλαπλασιασμός γίνεται πρόσθεση μετά την εφαρμογή του λογαρίθμου):

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{
	/pgf/number format/freq/.style={
		fixed,
		%  fixed zerofill,
		%  precision=0,
	},
}
\def\phasedown{-3}
\def\phaseextra{-4}

\draw[->] (0,\phasedown+\phaseextra) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {1,1.3010,2,2.3010,3,3.3010} {
	\draw[densely dotted] (\x,\phasedown) -- (\x,0);
}

\def\at{20}
\draw[ultra thick,orange!90!blue!80!black]
(0,2.5) 
-- ++(-2*\at:{1/cos(2*\at)}) node(c1) {} node[above right] {-40 dB/dec}
-- ++(-2*\at:{1/cos(2*\at)}) node(c2) {}
-- ++(-1*\at:{0.3010/cos(1*\at)}) node(c3) {} node[midway,above right] {-20 dB/dec}
-- ++(-3*\at:{1/cos(3*\at)}) node(c4) {} node[pos=1,right] {-60 dB/dec}
;

\foreach \p in {c1,c2,c3,c4} {
	\draw[densely dashed] (\p.center) -- (\p.center |- 0,0) (\p.center) -- (\p.center -| 0,0);
}
\draw (c1 -| 0,0) node[left] {60 dB};
\draw (c2 -| 0,0) node[left,yshift=1mm] {20 dB};
\draw (c3 -| 0,0) node[left,yshift=-1mm] {14 dB};

\foreach \x in {1,2,2.3010,3.3010} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {1.3010,2,2.3010,3} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\begin{scope}[yshift=\phasedown cm]
\draw[->] (0,0) -- ++(4.5,0);
\def\at{40}

\draw[ultra thick,magenta]
(0,0) -- (1,0)
-- ++(1*\at:{0.3010/cos(1*\at)}) node(c1) {} node[above,scale=.9] {$\ang{45}$/dec}
-- ++(-1*\at:{1.7000/cos(1*\at)}) node(c3) {} node[pos=.6,below left] {-$\ang{45}$/dec}
-- ++(-2*\at:{0.3010/cos(2*\at)}) node(c4) {} node[midway,right,xshift=1mm] {-$\ang{90}$/dec}
-- ++(1,0)
;

\foreach \p in {c1,c3,c4} {
	\draw[dashed,gray] (\p.center) -- (\p.center |- 0,0) (\p.center) -- (\p.center -| 0,0);
}

\draw[every node/.style={scale=.8}]
(c1 -| 0,0) node[left] {$-\ang{166}$}
(c3 -| 0,0) node[left] {$-\ang{198}$}
(c4 -| 0,0) node[left] {$-\ang{270}$}
;
\end{scope}

\end{tikzpicture}
\end{exercise}

\begin{exercise}
Ποιά είναι η συνάρτηση μεταφοράς της οποίας το προσεγγιστικό διάγραμμα Bode φαίνεται στο
παρακάτω σχήμα;

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-0.2) -- (0,3);
\draw[->] (-0.2,0) -- (4.5,0) node[below] {$\omega$};

\draw[ultra thick,blue!50!cyan!70!black]
(0,2) -- (1,2) -- (1.3,1.5) -- (3,1.5) -- (4,{-0.5/3});

\draw (0,2) node[left] {$20\log 0.8$};
\draw[dashed] (1,2) -- (1,0) node[below,scale=.9,xshift=-1mm] {$0.5$};
\draw[dashed] (0,1.5) node[left] {$-14\ \mathrm{dB}$} -| (1.3,0) node[below,scale=.9,xshift=0.5mm] {$2$};
\draw[dashed] (3,1.5) -- (3,0) node[below] {$10$};

\draw[blue!50!black] (1.2,1.7) node[above right] {$-20 \ \mathrm{db/dec}$};
\draw[blue!50!black] (3.5,0.8) node[above right] {$-20 \ \mathrm{db/dec}$};
\end{tikzpicture}

Επιέξετε μία από τις πιθανές απαντήσεις
\begin{enumgreekparen}
	\item \( \displaystyle \frac{10(s+1)(s+2)}{(s+0.5)(5s+10)(s+10)} \)
	\item \( \displaystyle \frac{10(s+0.5)}{(s+2)(s+10)} \)
	\item \( \displaystyle \frac{10(s+1)(s+2)}{(s+0.5)(5s+5)(s+10)} \)
	\item \( \displaystyle \frac{10(s+10)}{(s+0.5)(s+2)} \)
\end{enumgreekparen}

\tcblower
Κανονικά, φέρνουμε όλες τις συναρτήσεις μεταφοράς στη μορφή (π.χ. για την \textbf{(α)}):
\[
\frac{10\left(\frac{s}{1}+1\right)2\left(\frac{s}{2}+1\right)}{
	0.5\left(\frac{s}{0.5}+1\right)10\left(\frac{s}{2}+1\right)10\left(\frac{s}{10}+1\right)}
\]
και ελέγχουμε τις θέσεις των πόλων και των μηδενικών για τα σημεία μείωσης του κέρδους. Για
παράδειγμα, για το \textbf{(γ)}:
\[
\text{(γ)} =
\frac{10\cancel{(s+1)}2\left(\frac{s}{2}+1\right)}{0.5\left(\frac{s}{0.5}+1\right)
	5\cancel{(s+1)}10\left(\frac{s}{10}+1\right)}
\]
Στην παραπάνω συνάρτηση παρατηρούμε ότι απλοποιούνται ο πόλος και το μηδενικό για \( s=-1 \),
και μένουν ένας πόλος με συντελεστή \( \frac{1}{0.5} \) (άρα υπάρχει πτώση \( 20
\si{\decibel}/\mathrm{dec} \) από τη συχνότητα 0.5 και μετά), ένα μηδενικό με συντελεστή
\( \frac{1}{2} \) (άρα υπάρχει άνοδος που ακυρώνει την πτώση από το 2 και μετά), και ένας
πόλος με συντελεστή \( \frac{1}{10} \) (άρα υπάρχει ξανά πτώση από το 10 και μετά).

Εναλλακτικά, σε αυτήν την άσκηση, μπορώ να υπολογίσω το κέρδος της κάθε συνάρτησης
μεταφοράς, που πρέπει να είναι \( 20\log 0.8 \SI{}{\decibel} \), άρα να έχει μέτρο \( 0.8 \).

Έτσι, για κάθε απάντηση έχουμε:
\begin{enumgreekparen}
	\item \( \displaystyle \frac{10\cdot 1\cdot 2}{0.5\cdot 10 \cdot 10} 
	= 0.4 \xrightarrow{\si{\decibel}} 20\log 0.4 \neq 20\log 0.8 \)
	\item \( \displaystyle \frac{10\cdot 0.5}{2\cdot 10} = 0.25 \nrightarrow 20\log 0.8 \)
	\item \( \displaystyle \frac{10\cdot 1\cdot 2}{0.5\cdot 5\cdot 10} = 0.8
	\rightarrow 20\log 0.8 \quad \checkmark \)
	\item \( \displaystyle \frac{10\cdot 10}{0.5\cdot 2} = 100
	\nrightarrow 20\log 0.8 \)
\end{enumgreekparen}

\end{exercise}
\begin{exercise}
Τι τιμή έχει το προσεγγιστικό διάγραμμα μέτρου και φάσης στη συνάρτηση μεταφοράς:
\[ \displaystyle \frac{100}{(s+1)^2(s+10)} \] στη συχνότητα \( \omega = 1\ \sfrac{\mathrm{rad}}{\mathrm{s}} \);
\tcblower
\begin{attnbox}{}
	Εδώ μας ζητείται η τιμή του προσεγγιστικού διαγράμματος, όχι η ακριβής τιμή.
\end{attnbox}
Αν ζητούνταν η ακριβής τιμή, θα θέταμε \( s=j\omega = j\cdot 1 \), και υπολογίζαμε το
μέτρο και το όρισμα του μιγαδικού που θα προέκυπτε από τη συνάρτηση μεταφοράς.

Αρχικά, μετασχηματίζουμε ελαφρά τη συνάρτηση μεταφοράς:
\[
\frac{100}{(s+1)^2(s+10)}
\xrightarrow{\quad}
\frac{100}{1\left(\frac{s}{1}+1\right)^2 10 \left(\frac{s}{10}+1\right)}
= \frac{10}{\left(\frac{s}{1}+1\right)^2\left(\frac{s}{10}+1\right)}
\]

Εδώ έχουμε έναν πόλο για \( \omega  = \SI{10}{\radian/\second} \), ο οποίος ξεκινάει μία
πτώση \( \SI{20}{\decibel/\decade} \) σε εκείνη τη συχνότητα, και έναν διπλό πόλο
\( \omega  = \SI{1}{\decibel/\decade} \), του οποίου η επίδραση είναι μια πτώση κατά
\( 2\cdot20 = \SI{40}{\decibel/\decade} \). Άρα το προσεγγιστικό διάγραμμα μοιάζει κάπως έτσι:

\begin{tikzpicture}[scale=1.4]
\draw[gray!70!white] (0,1.5) node[left,scale=.8] {$0 \ \mathrm{dB}$} -- ++(4.5,0);
\draw[->] (0,-1.5) -- (0,3);
\draw[->] (-0.2,0.3) -- (5,0.3) node[right] {$\omega\ \mathsmaller{(\mathrm{rad/s})}$};

\draw[ultra thick,blue!50!cyan!70!black]
(0,2) -- (2,2) -- (4,0) -- (5,-1.5);
\fill[blue!50!cyan!70!black]
(2,2) circle (2pt) node[above right,scale=0.8] {$20\ \mathrm{dB}$}
(4,0) circle (2pt);

\draw (0,2) node[left,align=right] {$20\log 10 $\\$=20\ \mathrm{dB}$};
\draw[dashed] (2,2) -- ++(0,-1.7) node[below] {$p=1$};
\draw[dashed] (4,0) -- (4,0.3) node[above] {$10$};

\draw[blue!50!black] (3,1) node[above right] {$-40 \ \mathrm{db/dec}$};
\draw[blue!50!black] (4.7,-1) node[above right] {$-60 \ \mathrm{db/dec}$};
\end{tikzpicture}

Το διάγραμμα φάσης είναι λίγο πιο δύσκολο, επειδή η απόκριση επηρεάζεται μία δεκάδα πριν
και μία δεκάδα μετά από τη συχνότητα του κάθε πόλου.

Έτσι, για \( p=1 \) (διπλός πόλος), η επίδραση ξεκινάει από την \( \omega = 0.1p =
\SI{0.1}{\radian/\second}  \), με μία κλίση \( 2\cdot/(\ang{-45}) = \ang{-90}/\si{\decade} \),
μέχρι και την \( \omega = 10p = \SI{10}{\radian/\second} \).

\begin{tikzpicture}[scale=1,yscale=0.8]
\draw[dashed] (1,-4) -- ++(0,2);
\draw[dashed] (2,-4) -- ++(0,2);
\draw[dashed] (3,-4) -- ++(0,2);

\draw (0,-1.5) -- (0,-4.5);
\draw[->] (0,-2) -- ++(4,0);
\draw[->] (0,-4) -- ++(4,0);

\draw[ultra thick,magenta!90!black,yshift=-2cm,yscale=.8,every node/.style={inner sep=3pt}]
(0,0) -- (1,0)
-- (3,-2) node[midway,above right,fill=white] {$\ang{-90} \mathrm{/dec}$}
-- (4,-2);

\draw (1,-4) node[below] {$0.1$};
\draw (2,-4) node[below] {$1$};
\draw (3,-4) node[below] {$10$};
\end{tikzpicture}

Αντίστοιχα, για τον απλό πόλο \( p=10 \), ξεκινάμε από \( \SI{1}{\radian/\second} \) μέχρι
τα \( \SI{100}{\radian/\second} \) με κλίση \( -\ang{45}/\si{\decade} \).

\begin{tikzpicture}[scale=1,yscale=0.8]
\draw[dashed] (1,-4) -- ++(0,2);
\draw[dashed] (2,-4) -- ++(0,2);
\draw[dashed] (3,-4) -- ++(0,2);

\draw (0,-1.5) -- (0,-4.5);
\draw[->] (0,-2) -- ++(4,0);
\draw[->] (0,-4) -- ++(4,0);

\draw[ultra thick,magenta!90!black,yshift=-2cm,yscale=.6,every node/.style={inner sep=1pt}]
(0,0) -- (1,0)
-- (3,-2) node[midway,above right,yshift=-2pt,xshift=2pt,fill=white] {$\ang{-45} \mathrm{/dec}$}
-- (4,-2);

\draw (1,-4) node[below] {$1$};
\draw (2,-4) node[below] {$10$};
\draw (3,-4) node[below] {$100$};
\end{tikzpicture}

Προσθέτοντας τα δύο παραπάνω διαγράμματα για τις φάσεις, έχουμε:

\begin{tikzpicture}[scale=1.4]
\draw[dashed] (1,-4) -- ++(0,4.3);
\draw[dashed] (2,-4) -- ++(0,4.3);
\draw[dashed] (3,-4) -- ++(0,4.3);

\draw[gray!70!white] (0,1.5) node[left,scale=.8] {$0 \ \mathrm{dB}$} -- ++(4.5,0);
\draw[->] (0,-4.5) -- (0,3);
\draw[->] (-0.2,0.3) -- (5,0.3) node[right] {$\omega\ \mathsmaller{(\mathrm{rad/s})}$};

\draw[ultra thick,blue!50!cyan!70!black]
(0,2) -- (2,2) -- (3,0) -- (3.5,-1.5);
\fill[blue!50!cyan!70!black]
(2,2) circle (2pt) node[above right,scale=0.8] {$20\ \mathrm{dB}$}
(3,0) circle (2pt);

\draw (0,2) node[left,align=right] {$20\log 10 $\\$=20\ \mathrm{dB}$};
\draw[dashed] (2,2) -- ++(0,-1.7) node[below,fill=white,yshift=-1pt] {$p=1$};
\draw[dashed] (3,0) -- (3,0.3) node[above] {$10$};

\draw[blue!50!black] (3,1) node[above right] {$-40 \ \mathrm{db/dec}$};
\draw[blue!50!black] (3.5,-1) node[above right] {$-60 \ \mathrm{db/dec}$};

\draw[->] (0,-2) -- ++(5,0);
\draw[->] (0,-4) node[left] {$\ang{-270}$} -- ++(5,0);

\draw[ultra thick,magenta!90!black,yshift=-2cm,yscale=2/3]
(0,0) -- (1,0)
-- (2,-1) node[midway,below left,fill=white] {$\ang{-90} \mathrm{/dec}$}
-- (3,-2.5) node[midway,above right,fill=white] {$\ang{-135} \mathrm{/dec}$}
-- (4,-3) node[midway,above right,fill=white] {$\ang{-45} \mathrm{/dec}$}
-- ++(0.5,0);

\draw (1,-4) node[below] {$0.1$};
\draw (2,-4) node[below] {$1$};
\draw (3,-4) node[below] {$10$};
\draw (4,-4) node[below] {$100$};
\end{tikzpicture}

Γενικά είναι εύκολο να εργαζόμαστε με συναρτήσεις μεταφοράς των οποίων οι πόλοι και τα
μηδενικά είναι μεταξύ τους πολλαπλασιασμένα με παράγοντες του 10.

\end{exercise}
\begin{exercise}
Ποιά από τις παρακάτω συναρτήσεις μεταφοράς έχει διάγραμμα Bode κέρδους με κλίση
\( \SI{-60}{\decibel/\decade} \) στο \( \omega = \SI{30}{\radian/\second} \);

\begin{enumgreek}
	\item \( \displaystyle \frac{s+70}{(s+1)(s+2)(s+4)(s+6)} \)
	\item \( \displaystyle \frac{s+60}{(s+80)(s+90)(s^2+18s+100)} \)
	\item \( \displaystyle \frac{s+4}{(s+2)(s^2+18s+100)} \)
	\item \( \displaystyle \frac{s+4}{(s+6)(s+9)(s^2+18s+100)} \)
\end{enumgreek}

\tcblower
Ας μελετήσουμε κάθε συνάρτηση ξεχωριστά:
\begin{enumgreek}
	\item Ο όρος \( s+70 \) είναι πιο μακριά από τα \( \SI{30}{\radian/\second} \), άρα
	τον αγνοούμε. Στον παρονομαστή έχουμε 4 όρους πριν από το 30, άρα κλίση
	\( -4\cdot 20 = \SI{-80}{\decibel/\decade} \), που δεν συμφωνεί με την εκφώνηση.
	\item Οι όροι \( s+60 \), \( s+80 \) και \( s+90 \) είναι πολύ μακριά και δεν μας
	απασχολούν. Ο όρος \( s^2+18s+100 \) είναι ένα πολυώνυμο με μιγαδικές ρίζες και
	\( \sqrt{100} = 10\omega_n \), άρα έχει κλίση \( \SI{-40}{\decibel/\decade} \)
	(αφού \( 30 > 10 = \omega_n \)), και
	δεν συμφωνεί με την εκφώνηση.
	\item Μετά από το \( \omega = \SI{10}{\radian/\second} \) συνεισφέρουν το
	μηδενικό με \( \SI{+20}{\decibel/\decade} \), ο απλός πόλος με \( \SI{-20}{\decibel/\decade} \), και το πολυώνυμο με \( \SI{-40}{\decibel/\decade} \).
	Συνολικά έχουμε \( +20 -20 - 40 = \SI{-40}{\decibel/\decade} \), άρα δεν συμφωνούμε με την
	εκφώνηση.
	\item Έχουμε μηδενικό (\( \SI{+20}{\decibel/\decade} \)) και τέσσερις πόλους
	(\( -20\cdot 4 = \SI{-80}{\decibel/\decade} \)), άρα συνολικά \( \SI{60}{\decibel/\decade} \), που είναι και η ζητούμενη απάντηση.
\end{enumgreek}

Άρα το σωστό αποτέλεσμα είναι το \textbf{(δ)}.

\end{exercise}
\begin{exercise}
Δίνεται το διάγραμμα Bode πλάτους, καθώς και η βηματική απόκριση ενός συστήματος. Να βρεθεί
η αντίστοιχη συνάρτηση μεταφοράς, και το σφάλμα θέσης αν την τοποθετήσουμε σε σύστημα κλειστού
βρόχου μοναδιαίας αρνητικής ανάδρασης.

\begin{minipage}{15cm}
	\centering
	\raisebox{-0.5\height}{
\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{
	/pgf/number format/freq/.style={
		fixed,
		%  fixed zerofill,
		%  precision=0,
	},
}
\def\phasedown{-3}
\def\phaseextra{-4}

\draw[->] (0,-5) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};


\def\at{60}
\draw[ultra thick,orange!90!blue!80!black]
(0,1)
-- ++(1.6021,0) node(c1) {}
-- ++(-1*\at:{1/cos(1*\at)}) node(c2) {} node[near start,above right] {-40 dB/dec}
-- ++(-1.2*\at:{1/cos(1.2*\at)}) node(c3) {} node[near start,below left,fill=white] {-60 dB/dec}
-- ++(-1.2*\at:0.2)
;

\foreach \p in {c1,c2,c3} {
	\draw[densely dashed] (\p.center) -- (\p.center |- 0,0) (\p.center) -- (\p.center -| 0,0);
}
\draw (c1 -| 0,0) node[left] {20 dB};
\draw (c2 -| 0,0) node[left,yshift=1mm] {-20 dB};
\draw (c3 -| 0,0) node[left,yshift=-1mm] {-80 dB};

\foreach \x in {1.6021,2.6021,3.6021} {
	\pgfmathsetmacro\result{10^\x/10}
	\draw (\x,-0.1) node[below] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\end{tikzpicture}}
\hspace{2cm}
\raisebox{-0.5\height}{
\begin{tikzpicture}
\draw (0,-0.2) -- (0,3);
\draw[->] (-0.2,0) -- (5,0) node[right] {$t$};

\draw[path fading=east,dashed] (0,2) -- (3.5,2);
\draw (0,2) node[left] {$1$};

\draw[very thick,blue!80!cyan!80!black]
plot[domain=0:5,variable=\t,smooth,samples=18]
(\t,{2*(1-exp(-1.4*\t))});
\end{tikzpicture}}
\end{minipage}

\tcblower
Παρατηρούμε μία πτώση κατά \( \SI{-40}{\decibel/\decade} \) στη συνάρτηση μεταφοράς. Οπότε,
προκύπτει το ερώτημα αν αυτή προέρχεται από δύο απλούς πραγματικούς πόλους, ή από δύο
μιγαδικούς συζυγείς.

Παρατηρούμε ότι η βηματική απόκριση δεν παρουσιάζει υπερύψωση, αλλά είναι υπεραποσβεννύμενη.
Επομένως δεν έχουμε μιγαδικούς πόλους, αλλά δύο πραγματικούς.

Υπολογίζουμε το κέρδος \( G \) του συστήματος: αφού το διάγραμμα Bode ξεκινάει από την τιμή
\( \SI{20}{\decibel} = 20\log G \implies G = 10 \). Η συνάρτηση μεταφοράς έχει μια κλίση
\( \SI{-40}{\decibel/\decade} \) που ξεκινάει από \( \omega = \SI{4}{\radian/\second} \),
άρα στον παρονομαστή της έχει δύο όρους της μορφής \( \left(\frac{s}{4}+1\right) \). Επίσης,
έχει μια επιπλέον κλίση \( \SI{-20}{\decibel/\decade} \) από το \( \omega = \SI{40}{\radian/\second} \) και μετά, άρα έναν όρο της μορφής \( \left(\frac{s}{40} + 1\right) \).

Επομένως, τελικά η συνάρτηση γίνεται:
\[
H(s) = 10 \frac{1}{\left(\frac{s}{4}+1\right)^2\left(\frac{s}{40}+1\right)}
\]

Αν το τοποθετήσουμε σε κλειστό βρόχο:

\begin{tikzpicture}
\draw (2,0) node[rectangle,draw] (h) {$\displaystyle 10\frac{1}{\left(\frac{s}{4}+1\right)^2\left(\frac{s}{40}+1\right)}$};
\draw (h.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h);
\draw[->] (h.east) -- ++(2,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1) -| (mix);
\end{tikzpicture}

Το σύστημα έχει τύπο 0 (αφού δεν υπάρχουν ολοκληρωτές), άρα και πεπερασμένο σφάλμα θέσης:
\begin{align*}
	K_{\mathrm{p}} &= \lim_{s\to 0} \cancel{s}\frac{1}{\cancel{s}}H(s) = 10 \\
	e_{\mathrm{ss}} &= \frac{1}{1+K_{\mathrm{p}}} = 0.09
\end{align*}

\end{exercise}
\begin{exercise}
Να βρεθεί η συνάρτηση μεταφοράς με το παρακάτω προσεγγιστικό διάγραμμα Bode:

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{
	/pgf/number format/freq/.style={
		fixed,
		%  fixed zerofill,
		%  precision=0,
	},
}
\def\phasedown{-3}
\def\phaseextra{-4}

\draw[->] (0,-3) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
\draw[opacity=.8] (0,0) node[above left] {dB};


\def\at{30}
\draw[ultra thick,orange!90!blue!80!black]
(0,2)
-- (2.5,0) node[midway,above right] {-20 dB/dec}
-- (3.5,-1) node(c1) {}
-- (4.1,-3) node[midway,above right] {-40 dB/dec}
;

\foreach \p in {c1} {
	\draw[densely dashed] (\p.center) -- (\p.center |- 0,0);
}

\foreach \x in {2.5,3.5} {
	\pgfmathsetmacro\result{5*\x-7.5}
	\draw (\x,0.1) node[above] {$\pgfmathprintnumber[freq]\result$} -- ++(0,-0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\end{tikzpicture}

\tcblower
Έχουμε πτώση \( \SI{-20}{\decibel/\decade} \) από τη συχνότητα \( \omega = 0 \), άρα έχουμε
έναν πόλο στο 0, δηλαδή έναν ολοκληρωτή. Μετά από τα \( \omega = \SI{10}{\radian/\second} \),
εμφανίζεται και μία δεύτερη πτώση \( \SI{-20}{\decibel/\decade} \) που υποδηλώνει πόλο
στο 10.

Θυμόμαστε ότι το αντίστοιχο κέρδος του ολοκληρωτή \( \frac{G}{s^N} \) είναι και το σημείο τομής του με τον οριζόντιο άξονα, δηλαδή σε αυτήν την περίπτωση το 5. Άρα η συνάρτηση
μεταφοράς έχει τη μορφή:
\[
H(s) = \frac{5}{s\left(\frac{s}{10}+1\right)} = \frac{50}{s(s+10)}
\]
\end{exercise}
\subsection{Ευστάθεια}
Για να ελέγξουμε την ευστάθεια του συστήματος χρησιμοποιούμε τη
\textbf{συνάρτηση δέλτα}. Θυμόμαστε ότι ένα σύστημα είναι ευσταθές
αν έχει πόλους μόνο στο αριστερό ημιεπίπεδο, και οριακά ευσταθές
αν έχει συζυγείς πόλους (ή πραγματικό πόλο) πολλαπλότητας 1 επάνω
στον φανταστικό άξονα:
\\*
\begin{tikzpicture}[scale=1,xscale=1]
\def\xp{8cm}
\def\yp{5cm}

\tikzstyle{pole}=[cross=4pt,red!80!black,very thick]
\draw[->] (-1.5,0) -- (5,0) node[below] {$t$};
\draw (0,-2) -- (0,2);
\draw (2,-2) -- (2,2);

\draw (-0.5,0) node[pole] {};

\draw[very thick,blue!50!cyan!80!white,xshift=2cm]
plot[variable=\x,domain=0:3,samples=18,smooth]
(\x,{-1.5+3*exp(-1.1*\x)});

\begin{scope}[xshift=\xp]
\draw[->] (-1.5,0) -- (5,0) node[below] {$t$};
\draw (0,-2) -- (0,2);
\draw (2,-2) -- (2,2);

\draw (0.5,1) node[pole] {};
\draw (0.5,-1) node[pole] {};

\draw[very thick,blue!50!cyan!80!white,xshift=2cm]
plot[variable=\x,domain=0:3,samples=\gsamples/2.5,smooth]
(\x,{sin(7*\x r)*(-1+exp(\x/3.5))});
\end{scope}

\begin{scope}[yshift=-\yp]
\draw[->] (-1.5,0) -- (5,0) node[below] {$t$};
\draw (0,-2) -- (0,2);
\draw (2,-2) -- (2,2);

\draw (-0.5,1) node[pole] {};
\draw (-0.5,-1) node[pole] {};

\draw[very thick,blue!50!cyan!80!white,xshift=2cm]
plot[variable=\x,domain=0:3,samples=\gsamples/2.5,smooth]
(\x,{cos(9*\x r)*(1.5*exp(-\x))});
\end{scope}

\begin{scope}[xshift=\xp,yshift=-\yp]
\draw[->] (-1.5,0) -- (5,0) node[below] {$t$};
\draw (0,-2) -- (0,2);
\draw (2,-2) -- (2,2);

\draw (0,0) node[pole] {};

\draw[very thick,blue!50!cyan!80!white,xshift=2cm]
(0,1) -- (3,1);
\end{scope}
\end{tikzpicture}

Θα ασχοληθούμε επίσης με τη \textbf{σχετική ευστάθεια}, που δηλώνει
το πόσο ευσταθές είναι ένα σύστημα σε σχέση με ένα άλλο. Για παράδειγμα,
αν έχουμε δύο συστήματα
\( A \) και \( B \) με πόλους στο αριστερό ημιεπίπεδο:

\begin{tikzpicture}[scale=.7]
\fill[green,path fading=west,fill opacity=.4] (-3,3) rectangle (0,-3);

\tikzstyle{pole}=[cross=4pt,red!80!black,very thick]

\draw (-3,0) -- (3,0);
\draw (0,-3) -- (0,3);

\draw (-1,2) node[pole] (pa1) {};
\draw (-1,-2) node[pole] (pa2) {};
\draw (-2,2) node[pole] (pb1) {};
\draw (-2,-2) node[pole] (pb2) {};

\draw[dashed] (pa1.center) -- (pa2.center);
\draw[dashed] (pb1.center) -- (pb2.center);

\draw (pa1.north) node[above] {A};
\draw (pb1.north) node[above] {B};
\end{tikzpicture}

Τότε παρατηρούμε ότι και τα δύο είναι ευσταθή, αλλά το \( A \) έχει
πόλους πιο κοντά στον φανταστικό άξονα, άρα μπορούμε να θεωρήσουμε
ότι είναι "λιγότερο ευσταθές".

\paragraph{}
\phantomsection
\label{sec:stability_trick}

Έστω δύο συστήματα με συναρτήσεις μεταφοράς κλειστού βρόχου \( T_1 \) και \( T_2 \):

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]

\draw (2,0) node[transfer] (h1) {$\displaystyle H_1(s)$};
\draw (h1.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.east) ++(1.2,0) node[transfer] (h2) {$\displaystyle H_2(s)$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw (h1) -- (h2);
\draw[->] (h2.east) -- ++(1,0) node (end) {} node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1) -| (mix);
\draw (mix.south) node[below left] {$-$};

\draw(-1,0) node[left] {$\displaystyle T_1(s) = \frac{H_1H_2}{1+H_1H_2}$};

\begin{scope}[yshift=-2cm]
\draw (3,0) node[transfer] (h1) {$\displaystyle H_1(s)$};
\draw (mix |- 0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle H_2(s)$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw[->] (h1.east) -- (end |- 0,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix);
\draw (mix.south) node[below left] {$-$};

\draw(-1,0) node[left] {$\displaystyle T_1(s) = \frac{H_1}{1+H_1H_2}$};
\end{scope}
\end{tikzpicture}

και τα δύο έχουν τον ίδιο παρονομαστή (άρα και χαρακτηριστικό πολυώνυμο) στη συνάρτηση
μεταφοράς, επομένως είναι ισοδύναμα ως προς την ευστάθεια.

Επομένως μπορούμε να μελετάμε τα παρακάτω ισοδύναμα συστήματα, με συνάρτηση μεταφοράς ανοιχτού
βρόχου \( A(s) = H_1H_2 \):
\\*
\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm,minimum width=10mm]

\draw (2,0) node[transfer] (h1) {$\displaystyle H_1$};
\draw (h1.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.east) ++(1.2,0) node[transfer] (h2) {$\displaystyle H_2$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw (h1) -- (h2) node[midway] (center) {};
\draw[->] (h2.east) -- ++(0.5,0) node (end) {} node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1.5) -| (mix);
\draw (mix.south);

\draw[->,thick] (center.center |- 0,-1.5/2) arc [start angle=120,end angle=-170,radius=2mm];

\begin{scope}[yshift=-2.5cm]
\draw (3,0) node[transfer] (h1) {$\displaystyle H_1$};
\draw (mix |- 0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle H_2$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw[->] (h1.east) -- (end |- 0,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix);
\draw (mix.south);
\end{scope}
\end{tikzpicture}

Για τη μελέτη της ευστάθειας, ορίζουμε το \textbf{περιθώριο φάσης} και το \textbf{περιθώριο κέρδους}.
\begin{defn}{Περιθώριο φάσης}{}
	\textbf{Περιθώριο φάσης} ονομάζεται η απόσταση της φάσης της συνάρτησης μεταφοράς
	από τις \( \ang{180} \), στο σημείο στο οποίο το πλάτος της είναι \( \SI{0}{\decibel} \)
	ή 1:

	\begin{tikzpicture}[scale=1.2]
	\pgfplotsset{
		/pgf/number format/freq/.style={
			fixed,
		},
	}
	\def\phasedown{-2.2}
	\def\phaseextra{-2}
	
	\draw[->] (0,\phasedown+\phaseextra) -- (0,2);
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	\def\at{20}
	\draw[ultra thick,orange!90!blue!90!black]
	(0.7,1.2) -- (2.8,0)
	.. controls (3.5,-0.5) and (4,-1) .. (4,-2);
	
	\draw[dashed] (2.8,0) -- ++(0,\phasedown-1.215);
	
	\draw (0,0) node[above left,orange!90!blue!50!black] {$20\log\left|A(j\omega)\right|$};
	
	\filldraw[orange!90!blue!90!black,fill opacity=.6] (2.8,0) circle (1mm)
	node[above,orange!90!blue!40!black,yshift=1mm,opacity=1] {$\omega_c$};
	
	\begin{scope}[yshift=\phasedown cm]
	\draw[->] (0,0) -- ++(4.5,0);
	
	\draw[dashed] (2.8,-1.215) -- +(-0.7,0) node[midway] (mp) {} -- +(0.7,0);
	\draw[<-,thick] (mp.center) -- (mp.center |- 0,-1.7) node[midway,left] {$\phi_M$};
	
	\draw (0,-0.3) node[left,scale=.8] {$\ang{-90}$};
	\draw[dashed] (0,-1.7) node[left,scale=.8] {$\ang{-180}$} -- ++(4,0);
	\draw (0,-1) node[left,blue!50!cyan!50!green!50!black] {$\measuredangle\ A(j\omega)$};
	
	\draw[very thick,blue!50!cyan!50!green!70!black]
	plot[smooth,variable=\x,domain=0:4.4,samples=30]
	(\x,{-1+1.5*atan((-\x +2.7)*5)/180});
	
	\filldraw[very thin,blue!50!cyan!50!green!70!black,fill opacity=.4] (2.8,-1.215) circle (.6mm);
	\end{scope}
	
	\end{tikzpicture}
	
	Το περιθώριο φάσης συμβολίζεται \( \phi_M \) (margin) και έχει τύπο:
	\[
	\boxed{\phi_M = \ang{180} + \measuredangle A(j\omega_c)}
	\]
	όπου \underline{\( \omega_c \) είναι το σημείο τομής του πλάτους με τον άξονα των
		\( \SI{0}{\decibel} \)}.
\end{defn}

Για να καταλάβουμε ποιοτικά τη σημασία της απόστασης της φάσης από τις \( \ang{180} \),
δίνουμε ένα ημιτονοειδές σήμα σε ένα σύστημα μοναδιαίας αρνητικής ανάδρασης:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]

\draw (2,0) node[transfer] (h1) {$\displaystyle A(j\omega)$};
\draw (h1.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};

\draw[<-] (mix) -- ++(-1,0) node[above] {$\sim$};
\draw[->] (mix) -- (h1);
\draw (h1.east) -- ++(1,0) node (end) {} node[midway] (fb) {} node[above right] {$\sim$};
\draw[->] (fb.center) -- ++(0,-1) -| (mix);
\draw (mix.south) node[below left] {$-$};
\end{tikzpicture}

Αν η συνάρτηση \( A(j\omega) \) προκαλεί σε εκείνο το σημείο διαφορά φάσης \( \ang{180} \),
τότε στην έξοδο εμφανίζεται αρχικά ένα αντίθετο ημίτονο (αφού \( \sin(t-\ang{180})=-\sin(t)
 \)). Αυτό όμως αφαιρείται από την είσοδο λόγω της ανάδρασης, άρα η είσοδος διπλασιάζεται,
και αυτή η διαδικασία επαναλαμβάνεται συνεχώς, οδηγώντας σε συνεχώς αυξανόμενη και άρα
ασταθή έξοδο.

Για την ευστάθεια θέλουμε όσο το δυνατόν πιο \textbf{θετικό περιθώριο φάσης}.

Επίσης, για το εύρος ζώνης \( \omega_b \) της συνάρτησης (δηλαδή το εύρος μεταξύ των
συχνοτήτων στις οποίες το κέρδος είναι \( \SI{-3}{\decibel} \)), ισχύει:
\[
\boxed{\omega_b > \omega_c}
\]

\begin{defn}{Περιθώριο κέρδους}{}
	Ως περιθώριο κέρδους ορίζουμε τον αριθμό:
	\[
	g_M = \frac{1}{\left\lvert A(j\omega_1) \right\rvert}
	\]
	όπου \( \omega_1 \) είναι η συχνότητα στην οποία η συνάρτηση μεταφοράς εισάγει
	διαφορά φάσης \( \ang{180} \).
	
	Για να έχουμε ευστάθεια, θέλουμε \( g_M > 1 \), ή, εκφρασμένο σε \( \si{\decibel} \):
	\[
	\boxed{-20\log\left\lvert A(j\omega_1) \right\rvert > 0}
	\]
	
	Δηλαδή το περιθώριο κέρδους είναι η απόσταση (από κάτω προς τα επάνω) του \emph{πλάτους} της
	\( A \) από τα 0 dB (κέρδος 1), όταν η φάση της είναι \( \ang{180} \).
	
    \begin{tikzpicture}[scale=1.2]
    \pgfplotsset{
    	/pgf/number format/freq/.style={
    		fixed,
    	},
    }
    \def\phasedown{-1.2}
    \def\phaseextra{-2}
    
    \draw[->] (0,\phasedown+\phaseextra) -- (0,2);
    \draw[->] (0,1.1) -- (4.5,1.1) node[above] {$\si{\radian/\second}$};
    
    \def\at{20}
    \draw[ultra thick,orange!90!blue!90!black]
    (0.2,1.4) -- (1.5,1.4)
    .. controls (3,1.4) and (4,-1) .. (4,-1);
    
    \draw[dashed] (2.82,0.775) -- (2.82,\phasedown-1.48);
    
    \draw (0,0) node[above left,orange!90!blue!50!black] {$20\log\left|A(j\omega)\right|$};
    
    \filldraw[orange!90!blue!50!black,fill opacity=.4] (2.82,0.775) circle (.65mm) node (circ) {};
    \draw[very thick,->] ([yshift=.65mm]circ.center) -- (2.82,1.1) node[midway,right,yshift=-2mm,xshift=2mm] {$20\log g_M$};
    
    \begin{scope}[yshift=\phasedown cm]
    \draw[->] (0,0) -- ++(4.5,0);
    
    \draw[dashed] (0,-1.48) node[left,scale=.8] {$\ang{-180}$} -- ++(4,0);
    \draw (0,-1) node[left,blue!50!cyan!50!green!50!black] {$\measuredangle\ A(j\omega)$};
    
    \draw[very thick,blue!50!cyan!50!green!70!black]
    plot[smooth,variable=\x,domain=0:4.4,samples=30]
    (\x,{-1+1.5*atan((-\x +2.5)*5)/180});
    
    \filldraw[blue!50!cyan!50!green!70!black,fill opacity=.4] (2.82,-1.48) circle (1mm) node[opacity=1,below,yshift=-1mm] {$\omega_1$};
    \end{scope}
    
    \end{tikzpicture}
\end{defn}

Παρατηρούμε πως όσο αυξάνεται το πλάτος της συνάρτησης μεταφοράς, τόσο πιο κοντά στον
άξονα των \( \SI{0}{\decibel} \) φτάνει
(και μειώνεται το περιθώριο κέρδους), και το σύστημα γίνεται ασταθές μόλις τον ξεπεράσει.


\begin{exercise}[Εφαρμογή]
Για το παρακάτω σύστημα:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm,minimum width=10mm]

\draw (2,0) node[transfer] (h1) {$\displaystyle H_i(s)$};
\draw (h1.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.east) ++(1.2,0) node[transfer] (h2) {$\displaystyle H(s)$};
\draw (h2.east) ++(1.5,0) node[circle,draw,minimum size=5mm] (d) {};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw (h1) -- (h2) node[midway] (center) {} -- (d);
\draw[<-] (d) -- ++(0,1.2) node[right] {$d$};
\draw[->] (d.east) -- ++(1,0) node (end) {} node[midway] (fb) {} node[right] {$y$};
\draw[->] (fb.center) -- ++(0,-1.5) -| (mix);
\draw (mix.south);

\draw (h2.north) node[above] {$H(s)=\frac{6}{s+6}$};
\end{tikzpicture}

Να σχεδιαστεί ο ελεγκτής \( H_i(s) \) ώστε να τηρούνται ταυτόχρονα οι προδιαγραφές:
\begin{enumpar}
	\item Για βηματική είσοδο διαταραχής \( d=s(t) \), να έχουμε \( \displaystyle
	\lim_{t\to \infty} y(t) = 0 \).
	\item Για το εύρος ζώνης να ισχύει \( \omega_b > \SI{35}{\radian/\second} \)
	\item Για τα περιθώρια να ισχύει \( g_M = \infty\) και \( \phi_M > \ang{70} \)
\end{enumpar}

\tcblower
Θυμόμαστε ότι η συνάρτηση \( H_i(s) \) θα πρέπει να περιέχει έναν ολοκληρωτή
για να καλύπτει την πρώτη προδιαγραφή, άρα
να έχει τη μορφή \( \underbrace{\frac{κ}{s}}_{\mathclap{\text{ελεγκτής } I}} \) ή
τη μορφή \( \underbrace{\frac{κ(s+z)}{s}}_{\mathclap{\text{ελεγκτής } PI}} \).

Η προδιαγραφή \( \omega_b > \SI{35}{\radian/\second} \) σημαίνει ότι \( \omega_c >
 \SI{35}{\radian/\second} \).
 
Ας ξεκινήσουμε να μελετάμε την \( \frac{κ}{s} \).
Η απαίτηση \( g_M = \infty \) ικανοποιείται, αφού η συνάρτηση μεταφοράς δεν φτάνει ποτέ
στις \( \ang{180} \), άρα έχει άπειρο περιθώριο κέρδους.

Για την απαίτηση \( \omega_c > 35 \), μελετάμε τις συναρτήσεις μεταφοράς.
Η \( H_i(s) \) έχει πλάτος (σε \( \si{\decibel} \)) \( 20\left[\log κ - \log\omega\right] \),
και η \( H(s) \) έχει πλάτος \( 20\left[-\log\frac{\omega}{6}\right] \). Επομένως πρέπει:
\begin{align*}
	20\left[\log κ - \log \omega_c - \log\frac{\omega_c}{6}\right] = 0
	\implies \log\left( \frac{κ}{\frac{\omega_c^2}{6}} \right) = 0
\end{align*}
άρα:
\begin{align*}
	\frac{6κ}{\omega_c^2} &= 1 \implies \omega_c = \sqrt{6κ} \\
	\omega_c &>35 \implies κ > \frac{35^2}{6} \implies \underline{κ > 204.16}
\end{align*}

Ας εξετάσουμε και το περιθώριο φάσης στη συχνότητα \( \omega_c \):
\begin{align*}
	\phi_M &> \ang{70} \implies \\
	\ang{180} - \ang{90} - \tan^{-1}\frac{\omega_c}{6} &> \ang{70} \implies \\
	\ang{90} - \ang{80.2} &\ngtr \ang{70}
\end{align*}
κάτι που δεν ισχύει, επομένως δεν μπορούμε να χρησιμοποιήσουμε τον ελεγκτή I, και πρέπει
να τοποθετήσουμε τον PI. Με τον ίδιο συλλογισμό, θα οδηγηθούμε σε ένα αποτέλεσμα:
\[
κ \geq 5.8\qquad z=10
\]

\end{exercise}
\paragraph{Παράδειγμα}
Έστω η συνάρτηση μεταφοράς με ένα μηδενικό:
\[
\frac{s-a}{a} = (1\pm sτ)
\]
η οποία για τις φανταστικές συχνότητες γίνεται:
\[
1-j\omega t \quad \text{ή} \quad 1+j\omega t
\]
και έχει διάγραμμα Bode:

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{/pgf/number format/freq/.style={fixed}}
\def\phasedown{-3}
\def\phaseextra{-2}

\draw[->] (0,\phasedown+\phaseextra) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {1,3} {
	\draw[dashed] (\x,\phasedown) -- (\x,0);
}

\def\at{20}
\draw[ultra thick,orange!90!blue!80!black]
(0,0) -- (2,0) -- (4,2) node[near end,above,sloped] {+20 dB/dec}
;

\foreach \x in {2} {
	%\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {1,3} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\begin{scope}[yshift=\phasedown cm]
\draw[->] (0,0) -- ++(4.5,0);
\def\at{40}

\draw[ultra thick,magenta!60!blue,yshift=-1pt]
(0,0) -- (1,0) -- (3,-1) -- (4,-1) node[near end,below] {$1-j\omega t$};
\draw[ultra thick,magenta]
(0,0) -- (1,0) -- (3,1) -- (4,1) node[near end,above] {$1+j\omega t$};
\end{scope}

\end{tikzpicture}

Παρατηρούμε ότι το μέτρο παραμένει σταθερό ανεξάρτητα από το
πρόσημο του \( a \), αλλά η φάση αλλάζει προσανατολισμό ανάλογα
με αυτό το πρόσημο, δηλαδή αν ο πόλος βρίσκεται αριστερά ή δεξιά
του φανταστικού άξονα.

\subparagraph{}
Γενικότερα ισχύει:
\begin{align*}
	\text{Για \( (1+j\omega\tau) \)} &: \begin{cases}
	\omega \to 0 &\implies \phi = \ang{0}\\
	\omega \to \infty &\implies \phi = \ang{90}
	\end{cases} \\
	\text{Για \( (1-j\omega\tau) \)} &: \begin{cases}
	\omega \to 0 &\implies \phi = \ang{0}\\
	\omega \to \infty &\implies \phi = \ang{-90}
	\end{cases}
\end{align*}
και τα συστήματα που έχουν τουλάχιστον ένα ασταθές μηδενικό (δεξιά του φανταστικού άξονα) ονομάζονται \textit{συστήματα μη ελάχιστης φάσης}.

\paragraph{Σύστημα με καθυστέρηση}
Έστω ένα σύστημα που βάζει καθυστέρηση \( T \) δευτερολέπτων
στην είσοδο \( u \):
\[
y(t) = u(t-T)
\]

Αν πάρουμε το μετασχηματισμό Laplace έχουμε:
\[
y(s) = e^{-sT} u(s)
\]

Δηλαδή το σύστημα είναι μία πολύ απλή συνάρτηση:

\begin{tikzpicture}[scale=1,xscale=1]
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]

\draw (0,0) node[transfer] (H) {$e^{-sT}$};
\draw (H.north) node[above] {$H(s)$};
\draw[->] (H.east) -- ++(1,0) node[above] {$y$};
\draw[<-] (H.west) node[above left] {$u$} -- ++(-1,0);

\end{tikzpicture}

και για να κατασκευάσουμε το διάγραμμα Bode, θεωρούμε \( s=j\omega \),
και:
\begin{align*}
	H(j\omega) &= e^{-j\omega T}
	\\
	\left\lvert H(j\omega) \right\rvert &= 1 \\
	\measuredangle H(j\omega) &= - \omega T
\end{align*}

Γενικότερα, αν είχαμε ένα σύστημα \( H_1(j\omega) \) και εφαρμόζαμε
μία καθυστέρηση σε αυτό, θα είχαμε:
\begin{align*}
	H(j\omega) &= e^{-j\omega T} H_1(j\omega) \\
	\left\lvert H(j\omega) \right\rvert &= \left\lvert H_1(j\omega)
	\right\rvert \\
	\measuredangle H(j\omega) &= -\omega T + \measuredangle H_1(j\omega)
\end{align*}
Δηλαδή εισάγεται μία καθυστέρηση φάσης στο σύστημα.


\begin{exercise}[Παράδειγμα]
Έστω ότι δίνεται μία συνάρτηση μεταφοράς με χρονική καθυστέρηση:
\[
A(s) = e^{-sT} A_1(s)
\]

όπου ισχύει:
\[
A_1(s) = \frac{15(s+3)}{(s+1)(s+7)}
\]

Πόση μπορεί να είναι η χρονική καθυστέρηση μέχρι το σύστημα
να γίνει ασταθές;

\tcblower
Με πράξεις βρίσκουμε ότι το σημείο \( \omega_c \) στο οποίο η \( A_1 \) (και
ισοδύναμα η \( A \)) έχουν μέτρο 0 dB είναι:
\[
\left|A(j\omega_c)\right| = 0
\iff \left|\frac{15(j\omega_c + 3)}{(j\omega_c+1)(j\omega_c+7)}\right| = 0
\iff \frac{15\sqrt{\omega_c^2 + 3^2}}{\sqrt{\omega_c^2 + 1^2}\sqrt{\omega_c^2 + 7^2}}
\iff
\omega_c = 13.6 \cong 15
\]

Για αυτήν την τιμή υπολογίζουμε:
\begin{align*}
	\measuredangle A_1(j\omega_c) \cong -71
\end{align*}

Τότε, το περιθώριο φάσης
για την \( A_1 \) (η απόσταση από τις \( \ang{180} \)) είναι:
\[
\theta_M\left( A_1(j\omega c) \right)
= \ang{180} - \ang{71} = \ang{109}
= \frac{109π}{180} \ \mathrm{rad}
\]

και, λόγω της καθυστέρησης, το περιθώριο φάσης για την \( A \)
γίνεται:
\[
\theta_M\left( A(j\omega_c) \right)
= -\omega_c T + \theta_M \left( A_1(j\omega_c) \right)
\cong -\omega_c T + 1.9024
\]
(προσοχή στο ότι πρέπει να λαμβάνουμε τις μονάδες σε rad!)

Τελικά, προκύπτει ότι:
\[
T < \SI{0.1396}{\second},
\]
δηλαδή η καθυστέρηση του συστήματος πρέπει να είναι μικρότερη από
0.1396 δευτερόλεπτα για να έχουμε ευστάθεια.

\end{exercise}
\begin{exercise}[Παράδειγμα]
Έστω η συνάρτηση μεταφοράς ανοιχτού βρόχου:
\[
A(s) = \frac{300κ}{(s+2)(s+3)(s+5)}
\]

Για το σύστημα \underline{κλειστού} βρόχου:
\begin{enumparen}
	\item Ποιά τιμή πρέπει να έχει το \( κ \) ώστε να έχουμε ευστάθεια;
	\item Ποιά τιμή πρέπει να έχει το \( κ \) ώστε το περιθώριο κέρδους
	να είναι \( g_M = 3 \);
\end{enumparen}

\tcblower
Η συνάρτηση μεταφοράς κλειστού βρόχου προκύπτει:
\[
s^3+10s^2+31s+30+300κ = 0
\]

Επομένως μπορούμε να εφαρμόσουμε το \textbf{κριτήριο ευστάθειας Routh}
για να μελετήσουμε την ευστάθεια του συστήματος:
\[
\begin{array}{r|ccc}
s^3 & 1 & 31 & 0 \\
s^2 & 10 & 30+300κ & 0 \\
s^1 & 28-30κ & 0 & \\
s^0 & 30+300κ & &
\end{array}
\]

Θυμόμαστε ότι για να έχουμε ευστάθεια πρέπει όλοι οι συντελεστές
της πρώτης στήλης να είναι θετικοί:
\begin{align*}
	28 - 30κ &\geq 0 \quad \implies \boxed{κ \leq 0.93} \\
	30 + 300κ &\geq 0 \qquad \text{(ισχύει επειδή το $κ$ είναι θετικό)}
\end{align*}

Για το δεύτερο ερώτημα, θυμόμαστε ότι το περιθώριο κέρδους αναφέρεται
στην οριακή τιμή με την οποία μπορούμε να πολλαπλασιάσουμε το κέρδος του συστήματος για να έχουμε ευστάθεια, δηλαδή:
\[
g_M κ = 0.93 \implies \boxed{κ=0.31}
\]

\end{exercise}

\subsection{Διαγράμματα Nyquist}
Έστω η συνάρτηση μεταφοράς:
\[
\frac{1}{1+sτ} \quad \rightarrow \quad
\frac{1}{1+j\omega τ}
\]
με μέτρο \( \displaystyle \frac{1}{\sqrt{1+\omega^2τ^2}} \)
και φάση \( -\tan^{-1} \omega τ \).

Το διάγραμμα Nyquist είναι μία αναπαράσταση της συνάρτησης μεταφοράς στο
μιγαδικό επίπεδο.

Για \( \omega \to 0 \), το μέτρο γίνεται 1 και η φάση 0.\\
Για \( \omega \to \infty \), το μέτρο γίνεται 0 και η φάση \( \sfrac{π}{2} \).\\
Για \( \omega = \frac{1}{τ} \) (χαρακτηριστική συχνότητα), το μέτρο γίνεται
\( \frac{1}{\sqrt{2}} \), και η φάση \( -\frac{π}{4} \).

Μπορούμε επομένως να κατασκευάσουμε ένα διάγραμμα τοποθετώντας τα τρία παραπάνω
σημεία στο μιγαδικό επίπεδο:

\begin{tikzpicture}[scale=1.3]
% Sage Math code used:
% var('w')
% assume(w,'real')
%
% f(w) = 1/(1+i*w)
% show(real(f))
% show(imag(f))

\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\def\scale{2.5}
\pgfmathdeclarefunction{f}{1}{%
	\pgfmathparse{-#1*(sqrt(1/#1)-1)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
(0,0) --
plot[variable=\x,domain=0.001:1,samples=\gsamples,smooth,scale=\scale]
( \x, {f(\x)} );

\def\arrow{1}

\pgfmathsetmacro\xa{\arrow}
\pgfmathsetmacro\xb{\arrow + 0.1}
\pgfmathsetmacro\fa{\scale*f(\xa/\scale)}
\pgfmathsetmacro\fb{\scale*f(\xb/\scale)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,\fa) to (\xb,\fb);

\filldraw[blue!70!cyan,fill=blue!80!cyan] (0,0) circle(2pt) node[above right] {$\omega\to \infty$};
\filldraw[blue!70!cyan,fill=blue!80!cyan] (\scale,0) circle(2pt) node[above] {$\omega = 0$};
\filldraw[draw=blue!70!cyan,fill=blue!80!cyan!30!black] (-\scale,0) circle(2pt) node[above] {$-1+j0$};

\end{tikzpicture}

\paragraph{Παράδειγμα}
Έστω η συνάρτηση μεταφοράς με ολοκληρωτή:
\[
A(j\omega) =
\frac{1}{j\omega (1+j\omega τ)}
= \frac{1}{-\omega^2 τ +j\omega }
= \frac{-\omega^2 τ - j\omega }{\Re^2 + \Im^2}
= - \frac{τ}{\omega^2τ^2 + 1} - j\frac{1}{\omega (\omega^2τ^2+1)}
\]

Τότε, αντίστοιχα με παραπάνω, μπορούμε να βρούμε τα σημεία και να σχεδιάσουμε το
διάγραμμα Nyquist:
\begin{align*}
	\text{Για } \omega = 0 &: A(j\omega) = -\frac{\tau}{1} - j\infty
	\quad \text{(τείνει στο άπειρο με ασύμπτωτη την $x=-\tau$)} \\
	\text{Για } \omega = \frac{1}{\tau} &: A(j\omega) = -\frac{\tau}{2} -j\frac{\tau}{2} \\
	\text{Για } \omega = \infty &: A(j\omega) = -0 -j0
\end{align*}
Άρα το διάγραμμα είναι:

\begin{tikzpicture}[scale=1]
% Sage Math code used:
% var('w')
% assume(w,'real')

\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-5) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{0.5}
\pgfmathdeclarefunction{f}{1}{%
	\pgfmathparse{-1/(#1*(\t^2*(#1)^2+1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.1:3,samples=\gsamples,smooth,scale=\scale]
( {-\t/(\t^2*\x^2+1)}, {f(\x)} );

\def\arrow{1}

\pgfmathsetmacro\xa{\arrow}
\pgfmathsetmacro\xb{\arrow + 0.1}
\pgfmathsetmacro\fa{\scale*f(\xa/\scale)}
\pgfmathsetmacro\fb{\scale*f(\xb/\scale)}

\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (-0.88,-2.75) to (-0.86,-2.27);

\filldraw[blue!70!cyan,fill=blue!80!cyan] (0,0) circle(2pt) node[above right] {$\omega\to \infty$};
\filldraw[blue!70!cyan,fill=blue!80!cyan] (-1.5,-4) node[above] {$\omega \to 0$};

\draw[dashed] (-\t*\scale,-5) -- ++(0,7);
\draw (-\t*\scale,0) node[below left] {$-\tau$};

\end{tikzpicture}

\paragraph{}
Γενικά για τα διαγράμματα Nyquist έχει σημασία το \textbf{κρίσιμο σημείο} \( \mathbf{-1+j0} \).
Αν το διάγραμμα δεν περνάει στα αριστερά του σημείου αυτού, τότε το σύστημα
είναι ευσταθές.

Πιο συγκεκριμένα, έστω μια συνάρτηση μεταφοράς \( A(j\omega) \) και το διάγραμμα
Nyquist της:

\begin{tikzpicture}[scale=1]
% Sage Math code used:
% var('w')
% assume(w,'real')

\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-5) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{1}
\pgfmathdeclarefunction{f}{1}{%
	\pgfmathparse{-1/(#1*(\t^2*(#1)^2+1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{>}}},mark position=0.148(c)]
plot[smooth,scale=\scale,tension=1]
coordinates {(-0.2,-4) (-0.5,-2)  (-2,0) (-1,1) (0,0)};

\draw[thick,gray!80!brown] (0,0) circle (2.8cm);
\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-2.8,0) circle (2.5pt) node[above right] {$-1$};
\filldraw[top color=cyan,bottom color=blue,fill opacity=.5] (-2,0) circle (2pt) node[above right,opacity=1,color=blue] {$\omega_1$};
\filldraw[top color=cyan,bottom color=blue,fill opacity=.5] (c) circle (2pt) node[above left,opacity=1,color=blue] {$\omega_c$};

\draw[yellow!50!black,->] (-1,0) to[bend right] ++(-45:0.5) node[above right,scale=.7] {$\phi_M$};


\draw[<->,gray] (-\t,1.5) -- ++(\t,0) node[midway,fill=white] {$a$};

\filldraw[blue!70!cyan,fill=blue!80!cyan] (0,0) circle(2pt) node[above right] {$\omega\to \infty$};
\filldraw[blue!70!cyan,fill=blue!80!cyan] (-1,-4) node[above] {$\omega \to 0$};

\draw[dashed] (-\t*\scale,-5) -- ++(0,7);

\end{tikzpicture}

Στο παραπάνω διάγραμμα, το περιθώριο κέρδους εκφράζεται από τον αριθμό με τον
οποίο μπορούμε να πολλαπλασιάσουμε το κέρδος της συνάρτησης στο σημείο τομής με τον
πραγματικό άξονα μέχρι να συναντήσουμε το κρίσιμο σημείο, ενώ το περιθώριο
φάσης εκφράζει το πόσο μπορούμε να περιστρέψουμε τη φάση της συνάρτησης για να
έχουμε ευστάθεια, και αντιστοιχεί στη γωνία \( \phi_M \).

\newpage

\paragraph{Παράδειγμα} \hspace{0pt}

\begin{tikzpicture}[scale=0.8]
% Sage Math code used:
% var('w')
% assume(w,'real')

\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-5) -- (0,2) node[below left] {$\Im$};

\def\t{2}

\def\scale{1}
\pgfmathdeclarefunction{f}{1}{%
	\pgfmathparse{-1/(#1*(\t^2*(#1)^2+1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick,postaction={decorate},decoration={markings,mark=at position 0.5 with {\arrow{>}}},mark position=0.148(c)]
plot[smooth,scale=\scale,tension=1]
coordinates {(-0.2,-4) (-0.5,-2)  (-2,0) (-1,1) (0,0)};

\draw[thick,gray!80!brown] (0,0) circle (2cm);
\filldraw[top color=cyan,bottom color=blue,fill opacity=.5] (-2,0) circle (2pt) node[above right,opacity=1,color=blue] {$0.5$};


\filldraw[blue!70!cyan,fill=blue!80!cyan] (0,0) circle(2pt) node[above right] {$\omega\to \infty$};
\filldraw[blue!70!cyan,fill=blue!80!cyan] (-1,-4) node[above] {$\omega \to 0$};

\draw[dashed] (-\t*\scale,-5) -- ++(0,7);

\end{tikzpicture}

Στο παραπάνω διάγραμμα φάσης το περιθώριο κέρδους είναι \( \frac{1}{0.5} = 2 \),
δηλαδή μπορούμε να πολλαπλασιάσουμε το κέρδος με τον αριθμό 2 μέχρι να φτάσουμε
στο κρίσιμο σημείο.

\newpage

\subsubsection{Συνήθη διαγράμματα Nyquist}
\hspace{0pt}

% Sage math code used:
% print str(real(f(w))).replace('w','#1'); print str(imag(f(w))).replace('w','#1');

\begin{center}
\begin{tabular}{cc}
	\(\displaystyle\ \frac{1}{1+j\omega\tau_1}\) & \begin{tikzpicture}[scale=1,baseline]
	% Sage Math code used:
	% var('w')
	% assume(w,'real')
	% f(w) = ...
	% real(f(w))
	% imag(f(w))
	
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,1.5) node[left] {$\Im$};
	
	\def\t{2}
	
	\def\scale{2}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{1/(#1^2+1)}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{-#1/(#1^2+1)}%
	}
	
	%\pgfkeys{/pgf/fpu=true}
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.001:10,samples=2*\gsamples,smooth,scale=\scale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{1}
	
	\pgfmathsetmacro\xa{\scale*fx(\arrow)}
	\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}
	
	\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	
	\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
	\end{tikzpicture}\\
	\( \displaystyle
	\frac{1}{(1+j\omega\tau_1)(1+j\omega\tau_2)}
	\) & \begin{tikzpicture}[scale=1,baseline]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,1) node[left] {$\Im$};
	
	\def\t{2}
	
	\def\scale{2}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{-2*#1^2/((4*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(#1^2 + 1))}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{-3*#1/((4*#1^2 + 1)*(#1^2 + 1))}%
	}
	
	%\pgfkeys{/pgf/fpu=true}
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.001:3,samples=\gsamples,smooth,scale=\scale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{1}
	
	\pgfmathsetmacro\xa{\scale*fx(\arrow)}
	\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}
	
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	
	\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
	\end{tikzpicture}
	\\
	\(
	\displaystyle
	\frac{1}{(1+j\omega\tau_1)(1+j\omega\tau_2)(1+j\omega\tau_3)}
	\)
	&
	\begin{tikzpicture}[scale=1,baseline]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,1.5) node[left] {$\Im$};
	
	\def\scale{2}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{
			-6.38000000000000*#1^2/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1))
		}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{7.92000000000000*#1^3/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1)) - 4.46000000000000*#1/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1))
		}%
	}
	
	%\pgfkeys{/pgf/fpu=true}
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.001:2,samples=\gsamples,smooth,scale=\scale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{0.5}
	
	\pgfmathsetmacro\xa{\scale*fx(\arrow)}
	\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.01)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
	
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	
	\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
	\end{tikzpicture}
	\\
	\(
	\displaystyle
	\frac{1}{j\omega(1+j\omega\tau_1)}
	\)
	&
	\begin{tikzpicture}[scale=1,baseline]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
	
	\def\scale{2}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{
			-1/(#1^2 + 1)
		}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{
			-1/((#1^2 + 1)*#1)
		}%
	}
	
	\draw[thick,gray!80!brown,opacity=.8] (0,0) circle (1.2cm);
	\draw[gray!80!brown,opacity=.8,->] (190:1) to[bend right] (210:1);
	
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.6:4,samples=\gsamples,smooth,scale=\scale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{0.8}
	
	\pgfmathsetmacro\xa{\scale*fx(\arrow)}
	\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.01)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
	
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	\end{tikzpicture}
	\\
	\(
	\displaystyle
	\frac{1}{j\omega(1+j\omega\tau_1)(1+j\omega\tau_2)}
	\)
	&
	\begin{tikzpicture}[scale=1,baseline]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
	
	\def\scale{3}
	\def\xscale{1}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{
			-5/((9*#1^2 + 1)*(4*#1^2 + 1))
		}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{
			6*#1/((9*#1^2 + 1)*(4*#1^2 + 1)) - 1/((9*#1^2 + 1)*(4*#1^2 + 1)*#1)
		}%
	}
	
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.3:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{0.8}
	
	\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
	\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
	
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	\end{tikzpicture}
	\\
	\(
	\displaystyle
	\frac{1}{(j\omega)^2(1+j\omega\tau_1)(1+j\omega\tau_2)}
	\)
	&
	\begin{tikzpicture}[scale=1,baseline]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-1) -- (0,2.5) node[left] {$\Im$};
	
	\def\scale{1}
	\def\xscale{7}
	\pgfmathdeclarefunction{fx}{1}{%
		\pgfmathparse{
			3/((9*#1^2 + 1)*(#1^2 + 1)) - 1/((9*#1^2 + 1)*(#1^2 + 1)*#1^2)
		}%
	}
	\pgfmathdeclarefunction{fy}{1}{%
		\pgfmathparse{
			4/((9*#1^2 + 1)*(#1^2 + 1)*#1)
		}%
	}
	
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0.5:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);
	
	\def\arrow{0.6}
	
	\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
	\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
	
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	\end{tikzpicture}
\end{tabular}
\end{center}

\subsubsection{Γενικό κριτήριο Nyquist}
Παραπάνω παρουσιάστηκε το απλοποιημένο κριτήριο Nyquist, για το οποίο παίρναμε
τιμές του \( \omega \) μεταξύ του 0 και του \( +\infty \).

Για την εφαρμογή του γενικευμένου κριτηρίου Nyquist, δεν θεωρούμε πάντα ότι \( s=j\omega \),
αλλά παίρνουμε τιμές του \( s \) από το 0 μέχρι το \( +j\infty \), μετά συνεχίζουμε με
ένα ημικύκλιο άπειρης ακτίνας μέχρι το \( \omega = -j\infty \), για να επιστρέψουμε ξανά
στο 0.

\begin{center}
\begin{tikzpicture}[scale=1.2]

\fill[brown,path fading=east,opacity=.6] (0,-2) rectangle (3,2);

\draw[ultra thick,red,opacity=.8]
(0,-1.9) -- (0,1.9)  arc (90:-90:1.9);
\draw[very thick,black,opacity=1,postaction={decorate},decoration={markings,mark=at position 0.3 with {\arrow{>}},mark=at position 0.1 with {\arrow{>}},mark=at position 0.5 with {\arrow{>}}}]
(0,-1.9) -- (0,1.9)  arc (90:-90:1.9);

\draw[->,brown!50!black] (-2,0) -- (2.2,0) node[right] {$\Re$};
\draw[->,brown!50!black] (0,-2) node[left,red!50!brown] {$-\infty$}
-- (0,2) node[right] {$\Im$} node[left,red!50!brown] {$+\infty$};

\draw[brown] (-1,-1) node[below left] {$s$};
\filldraw[top color=brown,bottom color=white,opacity=.7] (0,0) circle (2.5pt);

\draw[very thick,green!70!blue,->,xshift=-4pt] ([yshift=3pt]0,0) node[left,scale=.6] {$j\omega$} -- ++(0,1.7)
node[scale=.7,midway,sloped,align=center,above] {(απλοποιημένο\\διάγραμμα)};

\end{tikzpicture}
\end{center}

Τότε το διάγραμμα Nyquist γίνεται:

\begin{tikzpicture}[scale=.5]
% Sage Math code used:
% var('w')
% assume(w,'real')


\draw[->] (-3,0) -- (5,0) node[right] {$\Re$};
\draw[->] (0,-5) -- (0,5) node[left] {$\Im$};

\def\t{2}

\def\scale{1}
\pgfmathdeclarefunction{f}{1}{%
	\pgfmathparse{-1/(#1*(\t^2*(#1)^2+1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick,postaction={decorate},decoration={markings,
	mark=at position 0.5 with {\arrow{>}},
	mark=at position 0.7 with {\arrow{>}},
	mark=at position 0.93 with {\arrow{>}},
	mark=at position 0.97 with {\arrow{>}},
}]
plot[smooth,scale=\scale,tension=1,yscale=-1]
coordinates {(0,0) (-1,1) (-2,0) (-0.5,-2) (-0.2,-4) (-0.2,-4.42)}
--
(0,4.41) arc(90:-90:4.41)
--
plot[smooth,scale=\scale,tension=1]
coordinates {(-0.1,-4.42) (-0.2,-4) (-0.5,-2)  (-2,0) (-1,1) (0,0)}
%--
%plot[smooth,scale=\scale,tension=1,yscale=-1]
%coordinates {(-0.2,-4) (-0.5,-2)  (-2,0) (-1,1) (0,0)}
;

\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-2.8,0) circle (2.5pt) node[above right] {$-1$};

\end{tikzpicture}

και τα παραπάνω συνήθη διαγράμματα:

\begin{center}
	\begin{tabular}{cc}
		\(\displaystyle\ \frac{1}{1+j\omega\tau_1}\) & 
		\begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-2) -- (0,1.5) node[left] {$\Im$};
		
		\def\t{2}
		
		\def\scale{2}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{1/(#1^2+1)}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{-#1/(#1^2+1)}%
		}
		
		%\pgfkeys{/pgf/fpu=true}
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.001:10,samples=2*\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick,yscale=-1]
		plot[variable=\x,domain=0.001:10,samples=2*\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		
		\def\arrow{1}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}
		
		\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		
		\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
		\end{tikzpicture}
		\\
		\( \displaystyle
		\frac{1}{(1+j\omega\tau_1)(1+j\omega\tau_2)}
		\) & \begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-1.5) -- (0,1.5) node[left] {$\Im$};
		
		\def\t{2}
		
		\def\scale{2}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{-2*#1^2/((4*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(#1^2 + 1))}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{-3*#1/((4*#1^2 + 1)*(#1^2 + 1))}%
		}
		
		%\pgfkeys{/pgf/fpu=true}
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.001:3,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick]
		plot[variable=\x,domain=0.001:3,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {-fy(\x)} ) -- (0,0);
		
		\def\arrow{1}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		\def\arrow{0.3}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		
		\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
		\end{tikzpicture}
		\\
		\(
		\displaystyle
		\frac{1}{(1+j\omega\tau_1)(1+j\omega\tau_2)(1+j\omega\tau_3)}
		\)
		&
		\begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-2) -- (0,1.5) node[left] {$\Im$};
		
		\def\scale{2}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{
				-6.38000000000000*#1^2/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1))
			}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{7.92000000000000*#1^3/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1)) - 4.46000000000000*#1/((4*#1^2 + 1)*(2.13160000000000*#1^2 + 1)*(#1^2 + 1))
			}%
		}
		
		%\pgfkeys{/pgf/fpu=true}
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.001:2,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick]
		plot[variable=\x,domain=0.001:2,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {-fy(\x)} ) -- (0,0);
		
		\def\arrow{0.5}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		\def\arrow{0.2}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		
		\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-\scale,0) circle (2.5pt) node[above right] {$-1$};
		\end{tikzpicture}
		\\
		\(
		\displaystyle
		\frac{1}{j\omega(1+j\omega\tau_1)}
		\)
		&
		\begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};
		
		\def\scale{2}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{
				-1/(#1^2 + 1)
			}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{
				-1/((#1^2 + 1)*#1)
			}%
		}
		
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.6:4,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick,yscale=-1]
		plot[variable=\x,domain=0.6:4,samples=\gsamples,smooth,scale=\scale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		
		\draw[blue!30!cyan,very thick,dashed,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}]
		(70:2.5) arc (70:-70:2.5);
		
		\def\arrow{0.8}
		
		\pgfmathsetmacro\xa{\scale*fx(\arrow)}
		\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		\end{tikzpicture}
		\\
		\(
		\displaystyle
		\frac{1}{j\omega(1+j\omega\tau_1)(1+j\omega\tau_2)}
		\)
		&
		\begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
		
		\def\scale{3}
		\def\xscale{1}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{
				-5/((9*#1^2 + 1)*(4*#1^2 + 1))
			}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{
				6*#1/((9*#1^2 + 1)*(4*#1^2 + 1)) - 1/((9*#1^2 + 1)*(4*#1^2 + 1)*#1)
			}%
		}
		
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.3:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick]
		%plot[smooth] coordinates {(
		%{\xscale*fx(0.3)}, {\scale*fy(0.3)} ) 
		%(2.3,0) 
		%({\xscale*fx(0.3)}, {-\scale*fy(0.3)}) 
		%} --
		plot[variable=\x,domain=0.3:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
		( {fx(\x)}, {-fy(\x)} ) -- (0,0);
		
		\draw[blue!30!cyan,very thick,dashed,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}]
		(50:2.5) arc (50:-50:2.5);
		
		\def\arrow{0.8}
		
		\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
		\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		\end{tikzpicture}
		\\
		\(
		\displaystyle
		\frac{1}{(j\omega)^2(1+j\omega\tau_1)(1+j\omega\tau_2)}
		\)
		&
		\begin{tikzpicture}[scale=1,baseline]
		\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
		\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};
		
		\def\scale{1}
		\def\xscale{7}
		\pgfmathdeclarefunction{fx}{1}{%
			\pgfmathparse{
				3/((9*#1^2 + 1)*(#1^2 + 1)) - 1/((9*#1^2 + 1)*(#1^2 + 1)*#1^2)
			}%
		}
		\pgfmathdeclarefunction{fy}{1}{%
			\pgfmathparse{
				4/((9*#1^2 + 1)*(#1^2 + 1)*#1)
			}%
		}
		
		\draw[blue!50!cyan,very thick]
		plot[variable=\x,domain=0.5:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
		( {fx(\x)}, {fy(\x)} ) -- (0,0);
		\draw[blue!30!cyan,very thick]
		plot[variable=\x,domain=0.51:2,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
		( {fx(\x)}, {-fy(\x)} ) -- (0,0);
		
		\def\arrow{0.6}
		
		\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
		\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
		
		\def\arrow{0.7}
		
		\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
		\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
		\pgfmathsetmacro\fa{\scale*fy(\arrow)}
		\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
		
		\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);
		\end{tikzpicture}
	\end{tabular}
\end{center}

\paragraph{}
Για το διάγραμμα Nyquist (στη γενικευμένη μορφή) ισχύει:
\[
\mathbf{N = Z - P}
\]

όπου:
\begin{itemize}
	\item \( N \) ο αριθμός των περικυκλώσεων γύρω από το \( -1 \) κατά την
	ωρολογιακή φορά
	\item \( Z \) 
	είναι ο αριθμός των \textbf{ασταθών πόλων} του συστήματος \textbf{κλειστού βρόχου}
	(δηλαδή οι ρίζες της χαρακτηριστικής εξίσωσης \( 1+A(s) \))
	\item \( P \) 
	είναι ο αριθμός των \textbf{ασταθών πόλων} του συστήματος \textbf{ανοιχτού βρόχου}
	(δηλαδή οι πόλοι της \( A(s) \))
\end{itemize}
(όπου με τον όρο \textit{ασταθείς πόλοι} εννοούμε τους πόλους που βρίσκονται στο δεξί
ημιεπίπεδο)

Το ζητούμενο συνήθως είναι να βρούμε τον αριθμό των ασταθών πόλων του συστήματος
\textit{κλειστού βρόχου}, ενώ, όπως αναφέραμε παραπάνω, δεν μπορούμε να χρησιμοποιήσουμε
το απλοποιημένο κριτήριο, επειδή η \( A(s) \) έχει και ασταθείς πόλους.

\paragraph{Για να βρούμε τον αριθμό \( N \) των περικυκλώσεων}
Για να βρούμε τον αριθμό των περικυκλώσεων, παίρνουμε μια ημιευθεία με οποιαδήποτε κλίση από το κρίσιμο σημείο \( (-1) \).

Για κάθε σημείο τομής της \textit{ημιευθείας} με το \textit{διάγραμμα}, αντιστοιχίζουμε
έναν αριθμό, ανάλογα με τη φορά του διαγράμματος σε σχέση με την ευθεία: \( -1 \) αν
το διάγραμμα τείνει να στρέψει την ευθεία κατά την \textit{αντιωρολογιακή} φορά,
και \( +1 \) αν το διάγραμμα τείνει να στρέψει την ευθεία κατά την \textit{ωρολογιακή} φορά:

\begin{tikzpicture}[scale=1.2]

\draw[->] (-3,0) -- (5,0) node[right] {$\Re$};
\draw[->] (0,-4) -- (0,4) node[left] {$\Im$};

\def\scale{1}
%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,opacity=.7,thick,postaction={decorate},decoration={markings,
	mark=at position 0.35 with {\arrow{>}},%
	mark=at position 0.5 with {\arrow{>}},%
	mark=at position 0.8 with {\arrow{>}},%
	mark=at position 0.97 with {\arrow{>}}
},name path=(n)]
plot[smooth cycle,scale=\scale,tension=.8]
coordinates {(-0.3,0) (-1,1.5) (-2,2.5) (1,3) (3,0) (1,-3) (-2,-2.5) (-1,-1.5)};

\draw[brown!50!red,thick,densely dotted,name path=(l)] (-1,0) -- ++(45:5);
\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-1,0) circle (2.5pt) node[below left] {$-1$};

\path [name intersections={of=(l) and (n)}];

\filldraw[fill opacity=.8] (intersection-1) node[rounded corners=2pt,draw,top color=white,bottom color=brown] {};
\filldraw[fill opacity=.8] (intersection-2) node[rounded corners=2pt,draw,top color=white,bottom color=brown] {};

\draw[ultra thick,-stealth,brown!40!orange!80!black] (intersection-2) ++(45:0.3) ++(45-90:0.2) -- ++(45+90:0.8);
\draw[ultra thick,-stealth,brown!40!orange!80!black] (intersection-1) ++(45:0.3) ++(45+90:0.3) -- ++(45-90:0.8);

\end{tikzpicture}

Το ζητούμενο \( N \) είναι το άθροισμα των αριθμών που αντιστοιχούμε στο κάθε σημείο τομής,
δηλαδή:
\[
N = -1 + 1 = 0
\]

\subsubsection{Ασκήσεις}

\begin{exercise}
Να σχεδιαστεί το πλήρες διάγραμμα Nyquist και να εξεταστεί η ευστάθεια του συστήματος:

\begin{circuitikz}
	\begin{scope}[every node/.style={rectangle,draw,minimum width=40pt}]
		\draw (0,0) node[circle,minimum width=25pt] (a) {};
		\draw  (a) ++ (2,0) node (h1) {$\displaystyle \frac{10}{s+2}$};
		\draw (h1) ++(3,0) node (h2) {$\displaystyle \frac{5}{s-6}$};
	\end{scope}
	
	\draw[<-] (a) -- ++(-2,0) node[near end,above] {$v$};
	\draw[->] (a) -- (h1) node[near end, above] {$e$};
	\draw[->] (h1) -- (h2);
	\draw[->] (h2) -- ++(2,0) node[near end,above] {$y$} node[midway] (m) {};
	\draw[->] (m.center) -- ++(0,-1.2) -| (a.south) node[right] {$-$};
\end{circuitikz}

\tcblower
Κατ' αρχάς, παίρνω τη συνάρτηση ανοιχτού βρόχου:
\[
A(s) = \frac{50}{(s+2)(s-6)}
\]

και ξεκινώ την κατασκευή του διαγράμματος.

\begin{itemize}
	\item Για \( \omega  = 0 \):\[
	A(0) = \frac{50}{-12} = -4.16
	\]
	\item Για \( \omega \to \infty \): \[
	A(\infty) = 0
	\]
	
	Μάλιστα, με δύο πόλους πολλαπλότητας 1, η φάση του διαγράμματος στο \( +\infty \)
	καταλήγει στις \( \ang{-180} \), για πολύ μεγάλο \( \omega  \), όπως γνωρίζουμε από
	τα διαγράμματα Bode.
	\item Για να βρούμε αν το διάγραμμα βρίσκεται στο επάνω ή στο κάτω ημιεπίπεδο,
	κάνουμε τις πράξεις για \( s= j \omega  \):
	\begin{align*}
		A(j\omega ) &= \frac{50}{(j\omega +2)(j\omega -6)}
		\\ &= \frac{-50(\omega^2+12) + 200j\omega }{(\omega^2+12)^2 + 16\omega^2}
	\end{align*}
	Παρατηρούμε ότι το φανταστικό μέρος (\( \frac{200\omega}{(\omega^2+12)^2 + 16\omega^2} \)) είναι θετικό, άρα το απλό διάγραμμα Nyquist βρίσκεται στην επάνω μεριά
	του επιπέδου:
	
	\begin{tikzpicture}[scale=1]
	\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};
	
	\def\scale{1}
	\def\xscale{0.5}
	
	\pgfmathdeclarefunction{fx}{1}{%
		{\pgfkeys{/pgf/fpu=true}%
			\pgfmathsetmacro\f{%
				-50*#1^2/((#1^2 + 36)*(#1^2 + 4)) - 600/((#1^2 + 36)*(#1^2 + 4))%
			}%
			\pgfkeys{/pgf/fpu=false}%
			\xdef\ga{\f}%
		}%
		\pgfmathfloattofixed{\ga}%
	}%
	\pgfmathdeclarefunction{fy}{1}{%
		{\pgfkeys{/pgf/fpu=true}%
			\pgfmathsetmacro\f{%
				200*#1/((#1^2 + 36)*(#1^2 + 4))			}%
			\pgfkeys{/pgf/fpu=false}%
			\xdef\ga{\f}%
		}%
		\pgfmathfloattofixed{\ga}%
	}
	
	
	\draw[blue!50!cyan,very thick]
	plot[variable=\x,domain=0:20,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
	( {fx(\x)}, {fy(\x)} ) -- (0,0);

	
	\def\arrow{1.4}
	
	\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
	\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
	\pgfmathsetmacro\fa{\scale*fy(\arrow)}
	\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
	\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);
	
	\filldraw[top color=red,bottom color=blue,fill opacity=.5] (-4.16*\xscale,0) circle (2.5pt) node[below left,opacity=.7] {$-4.16$};

	\end{tikzpicture}
\end{itemize}

Για να σχεδιάσουμε το πλήρες διάγραμμα Nyquist, λαμβάνουμε υπ' όψιν και τα αρνητικά
\( \omega \), δηλαδή σχεδιάζουμε και το συζυγές του παραπάνω διαγράμματος:

\begin{tikzpicture}[scale=1]
\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};

\def\scale{1}
\def\xscale{0.5}

\pgfmathdeclarefunction{fx}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			-50*#1^2/((#1^2 + 36)*(#1^2 + 4)) - 600/((#1^2 + 36)*(#1^2 + 4))%
		}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}%
\pgfmathdeclarefunction{fy}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			200*#1/((#1^2 + 36)*(#1^2 + 4))			}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}


\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0:20,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);
\draw[blue!50!cyan!70!red,very thick]
plot[variable=\x,domain=0:20,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
( {fx(\x)}, {-fy(\x)} ) -- (0,0);

\def\arrow{1.4}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\def\arrow{1.7}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);

\filldraw[top color=red,bottom color=blue,fill opacity=.5] (-4.16*\xscale,0) circle (2.5pt) node[below left,opacity=.7] {$-4.16$};

\end{tikzpicture}

Όσον αφορά το ημικυκλικό κομμάτι που παρουσιάσαμε στη θεωρία, σε εκείνο ισχύει
ότι για \( s \to \infty: \left|A(s)\right| = 0 \), οπότε αντιστοιχεί στο σημείο \( 0 \).

Για να βρούμε αν το σύστημα κλειστού βρόχου είναι ασταθές, πρώτα θεωρούμε μια ημιευθεία
γύρω από το -1:

\begin{tikzpicture}[scale=1]
\draw[->] (-3,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};

\def\scale{1}
\def\xscale{0.5}

\pgfmathdeclarefunction{fx}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			-50*#1^2/((#1^2 + 36)*(#1^2 + 4)) - 600/((#1^2 + 36)*(#1^2 + 4))%
		}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}%
\pgfmathdeclarefunction{fy}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			200*#1/((#1^2 + 36)*(#1^2 + 4))			}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}


\draw[blue!50!cyan,very thick,name path=(n)]
plot[variable=\x,domain=0:20,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale)]
( {fx(\x)}, {fy(\x)} ) -- (0,0);
\draw[blue!50!cyan!70!red,very thick]
plot[variable=\x,domain=0:20,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
( {fx(\x)}, {-fy(\x)} ) -- (0,0);

\def\arrow{1.4}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\def\arrow{1.7}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);

\filldraw[top color=red,bottom color=blue,fill opacity=.5] (-4.16*\xscale,0) circle (2.5pt) node[below left,opacity=.7] {$-4.16$};

\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-1*\xscale,0) circle (2pt) node[below left] {$-1$};

\draw[brown!50!red,thick,densely dotted,name path=(l)] (-1*\xscale,0) -- ++(70:2);

\path [name intersections={of=(l) and (n)}];
\filldraw[fill opacity=.8] (intersection-1) node[rounded corners=2pt,draw,inner sep=2pt,top color=white,bottom color=brown] {};
\draw[ultra thick,-stealth,brown!40!orange!80!black] (intersection-1) ++(45:0.3) ++(45+90:0.3) -- ++(45-90:0.8);

\end{tikzpicture}

Αυτή τέμνει το διάγραμμα Nyquist σε ένα σημείο με ωρολογιακή φορά, οπότε αντιστοιχούμε σε
αυτόν τον αριθμό 1. Επομένως, για το δείκτη Nyquist ισχύει:
\[
N = +1
\]

Η συνάρτηση ανοιχτού βρόχου έχει έναν πόλο στο δεξί ημιεπίπεδο (τον \( +6 \)):
\[
P = 1
\]

Άρα τελικά ο αριθμός των πόλων του κλειστού βρόχου υπολογίζεται:
\[
N = Z-P \implies \boxed{Z = N+P = 2}
\]

Δηλαδή το σύστημα κλειστού βρόχου έχει δύο ασταθείς πόλους, και επομένως είναι ασταθές.

\end{exercise}
\begin{exercise}
Δίνεται το παρακάτω διάγραμμα Nyquist:

\begin{tikzpicture}[scale=1,baseline]
\draw[->] (-2,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{2}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{-2*#1^2/((4*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(#1^2 + 1))}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-3*#1/((4*#1^2 + 1)*(#1^2 + 1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:3,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);
\draw[thick,gray!80!brown] (0,0) circle (\scale*0.65cm);

\def\arrow{1}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\filldraw[top color=white,bottom color=blue,fill opacity=.5] (0.65*\scale,0) circle (2pt) node[above right,scale=.9] {$1$};
\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-0.65*\scale,0) circle (2.5pt) node[above right] {$-1$};

\draw ({\scale*fx(0)},0) node[circle,inner sep=1pt,top color=cyan,bottom color=white,opacity=.4,draw=blue!50!white] {} node[above] {$2$};
\draw (0,0) node[circle,inner sep=1pt,top color=cyan,bottom color=white,opacity=.4,draw=blue!50!white] {} node[above right] {$0$};
\end{tikzpicture}

Ποιό είναι το περιθώριο κέρδους; Σε ποιό διάστημα ανήκει το περιθώριο φάσης;
\tcblower
Το περιθώριο κέρδους είναι άπειρο, αφού δεν υπάρχει αριθμός με τον οποίο μπορούμε
να πολλαπλασιάσουμε το κέρδος της συνάρτησης για να φτάσει το σημείο -1.

Για το περιθώριο φάσης, παίρνουμε το σημείο τομής της συνάρτησης με το μοναδιαίο κύκλο:

\begin{tikzpicture}[scale=1.2]
\draw[->] (-2,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{2}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{-2*#1^2/((4*#1^2 + 1)*(#1^2 + 1)) + 1/((4*#1^2 + 1)*(#1^2 + 1))}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-3*#1/((4*#1^2 + 1)*(#1^2 + 1))}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:3,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);
\draw[thick,gray!80!brown] (0,0) circle (\scale*0.65cm);

\def\arrow{1}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\draw[very thick,green!70!black] (0,0) -- (-70:2);
\draw[->,green!70!black] (-0.5,0) to[bend right] node[near start,left,scale=.8] {$\phi_M$} (-70:0.5);
\draw[thick,left color=green,fill opacity=.5,right color=gray!80!brown] (-70:0.65*\scale) circle (2.5pt);

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\filldraw[top color=white,bottom color=blue,fill opacity=.5] (0.65*\scale,0) circle (2pt) node[above right,scale=.9] {$1$};
\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-0.65*\scale,0) circle (2.5pt) node[above right] {$-1$};

\draw ({\scale*fx(0)},0) node[circle,inner sep=1pt,top color=cyan,bottom color=white,opacity=.4,draw=blue!50!white] {} node[above] {$2$};
\draw (0,0) node[circle,inner sep=1pt,top color=cyan,bottom color=white,opacity=.4,draw=blue!50!white] {} node[above right] {$0$};
\end{tikzpicture}

Παρατηρούμε από το διάγραμμα ότι ισχύει \( \ang{90} < \phi_M < \ang{150} \).

\subparagraph{}
Διαισθητικά, αν περιστρέψουμε το διάγραμμα κατά το περιθώριο φάσης, δηλαδή κατά
\( \phi_M \), τότε η καμπύλη θα συμπέσει με το κρίσιμο σημείο -1, άρα θα αρχίσουμε να
έχουμε αστάθεια.

Αντίστοιχα, αν "φουσκώσουμε" (κάνουμε scaling) την καμπύλη, πολλαπλασιάζοντας το μέτρο
της με έναν αριθμό που είναι το περιθώριο κέρδους, τότε μια καμπύλη πάλι θα συμπέσει
με το -1, και θα υπάρχει αστάθεια. Στη συγκεκριμένη άσκηση βέβαια, όσο κι αν μεγαλώσουμε
την καμπύλη, αυτή δεν πρόκειται να φτάσει στο -1.

\end{exercise}
\begin{exercise}
Δίνεται το διάγραμμα Bode της \( A(s) \):

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{/pgf/number format/freq/.style={fixed}}
\def\phasedown{-2}
\def\phaseextra{-2}

\draw[->] (0,\phasedown+\phaseextra) -- (0,3) node[below left,orange!90!blue!80!black] {$|A|_{\si{\decibel}}$};
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {} {
	\draw[dashed] (\x,\phasedown) -- (\x,0);
}

\def\at{20}
\draw[ultra thick,orange!90!blue!80!black]
(0,2.5) -- (4,-1)
;

\foreach \x in {} {
	%\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\draw (2.86,0) node[above right] {$\omega_c$};
\draw[dashed] (2.857,\phasedown-1.7) -- (2.857,0);
\draw[fill=green!50!black] (2.857,\phasedown-1.75) circle (2pt) node[right,blue!50!cyan!50!green!70!black] {$\measuredangle A(j\omega c)$}
-- ++(0,-2) circle (1.5pt) node[right,scale=.8] {$-\ang{180}$} node[midway,blue!50!cyan!50!green!70!black,right] {$\phi_M$};

\begin{scope}[yshift=\phasedown cm]
\draw[->] (0,0) -- ++(4.5,0);
\def\at{40}

\draw (0,-0.2) node[left,scale=.8] {$-\ang{92}$};
\draw[dashed] (0,-1.9) node[left,scale=.8] {$-\ang{102}$} -- ++(2.5,0);


\draw[very thick,blue!50!cyan!50!green!70!black]
plot[smooth,tension=.8] coordinates {(0,-0.2) (1,-0.5) (2.5,-1.9) (3.5,-0.7) (4.5, -0.4)};

\draw (0,-1) node[left,blue!50!cyan!50!green!50!black] {$\measuredangle\ A(j\omega)$};
\end{scope}

\end{tikzpicture}

Ποιό είναι το περιθώριο φάσης;

\tcblower
Αν \( \omega_c \) είναι η συχνότητα στην οποία η συνάρτηση έχει μηδενικό κέρδος, θα έχουμε:
\[
\phi_M = \measuredangle A(j\omega_c) - (\ang{-180}) = \ang{180} + \measuredangle A(j\omega_c)
\]

Από το διάγραμμα παρατηρούμε ότι \( \measuredangle A(j\omega_c) \in (\ang{-102},\ \ang{-92}) \), ή, προσεγγιστικά,
\( \measuredangle A(j\omega_c) = \ang{-98} \).

Άρα:
\[
\phi_M = \ang{180} - \ang{98} = \ang{82}
\]

\end{exercise}
\begin{exercise}
Δίνεται το διάγραμμα Bode της \( A(s) \):

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{/pgf/number format/freq/.style={fixed}}
\def\phasedown{-3}
\def\phaseextra{-2}

\draw[->] (0,\phasedown+\phaseextra) -- (0,3) node[below left,orange!90!blue!80!black] {$|A|_{\si{\decibel}}$};
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {} {
	\draw[dashed] (\x,\phasedown) -- (\x,0);
}

\draw (2.86,0) node[above right] {$\omega_c$};

\def\at{20}
\draw[ultra thick,orange!90!blue!80!black]
(0,2.5) -- (4,-1)
;

\foreach \x in {} {
	%\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\draw (0,0) node[left] {$0$};

\draw[dashed] (2.857,\phasedown-0.9) -- (2.857,0);
\draw[fill=green!50!black] (2.857,\phasedown-0.9) circle (2pt) node[right,blue!50!cyan!50!green!70!black] {$\measuredangle A(j\omega c)$};

\begin{scope}[yshift=\phasedown cm]
\draw[->] (0,0) -- ++(4.5,0);
\def\at{40}

\draw (0,0) node[left] {$\ang{-180}$};

\draw[very thick,blue!50!cyan!50!green!70!black]
plot[smooth,tension=.5] coordinates {(0,0) (2,-0.05) (3,-1) (4.5,-1)};
\end{scope}

\end{tikzpicture}

Είναι το σύστημα ευσταθές;

\tcblower
Για το \textbf{περιθώριο φάσης} ισχύει:
\[
\phi_M = \ang{180} + \measuredangle A(j\omega_c)
\]

Όμως για τη γωνία \( \measuredangle A(j\omega_c) \) παρατηρούμε από το διάγραμμα ότι ισχύει \( \measuredangle A(j\omega_c) < \ang{-180} \). Επομένως:
\[
\phi_M < 0
\]
άρα το σύστημα είναι \textit{ασταθές}.

\end{exercise}
\begin{exercise}
Ποιό είναι το περιθώριο κέρδους για το παρακάτω διάγραμμα Bode;

\begin{tikzpicture}[scale=1,xscale=1]
\pgfplotsset{/pgf/number format/freq/.style={fixed}}
\def\phasedown{-3}
\def\phaseextra{-3}

\draw[->] (0,\phasedown+\phaseextra) -- (0,1.5) node[below left,blue!50!cyan!70!black] {$|A|_{\si{\decibel}}$};
\draw[->] (0,0) -- (4.5,0) node[above] {$\omega$};

\foreach \x in {} {
	\draw[dashed] (\x,\phasedown) -- (\x,0);
}

\def\at{20}
\draw[ultra thick,blue!50!cyan!70!black]
plot[smooth,tension=.7] coordinates
{ (0,1) (1.5,0.7) (3,-1) (4.5,-2) }
;

\draw[dashed] (0,-1.57) node[left,scale=.8] {$\SI{-45}{\decibel}$} -- ++(3.74,0);
\draw[dashed] (0,-1.9) node[left,scale=.8] {$\SI{-50}{\decibel}$} -- ++(4.3,0);

\foreach \x in {} {
	%\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {} {
	\pgfmathsetmacro\result{10^\x/100}
	\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\draw[dashed] (3.74,\phasedown-2.25) -- (3.74,-1.5);
\draw[blue!50!cyan!70!black] (3.74,-1.5) -- (3.74,0) node[black,scale=.7,above] {$\omega_1$} node[midway,right] {$g_m$};
\draw[fill=green!50!black] (3.74,\phasedown-2.25) circle (2pt) node[above right,blue!50!cyan!50!green!70!black] {$\omega_1$};

\begin{scope}[yshift=\phasedown cm]
\draw[->] (0,0) -- ++(4.5,0);
\def\at{40}
\draw (-1,\phasedown/2) node[left,blue!50!cyan!50!green!50!black] {$\measuredangle\ A(j\omega)$};

\draw (0,0) node[left,scale=.8] {$\ang{0}$};
\draw[dashed] (0,-2.5/2) node[left,scale=.8] {$-\ang{100}$} -- ++(2.2,0);
\draw[dashed] (0,-2.5) node[left,scale=.8] {$-\ang{200}$} -- ++(4.5,0);
\draw[dashed] (0,-2.25) node[left,scale=.8,green!30!black,yshift=2pt] {$-\ang{180}$} -- ++(3.7,0);

\draw[very thick,blue!50!cyan!50!green!70!black]
plot[smooth,tension=.8] coordinates {(0,0) (1,-0.9) (2,-1.2) (3,-1.7) (4,-2.4) (4.7,-2.5)};
\end{scope}

\end{tikzpicture}

\tcblower
Για το περιθώριο κέρδους ισχύει:
\[
g_m = 0 - \left|A(\omega_1)\right|_{\mathrm{dB}}
\]
όμως για τη συχνότητα \( \omega_1 \) στην οποία η φάση είναι \( \ang{-180} \) ισχύει περίπου \( \left|A(\omega_1)\right|_{\mathrm{dB}} = \SI{-45}{\decibel} \), άρα:
\[
g_m = 0 - (-45) = \SI{45}{\decibel}
\]

\end{exercise}
\begin{exercise}
Να εξεταστεί η ευστάθεια του συστήματος με χαρακτηριστική συνάρτηση:
\[
s^4+8s^3+18s^2+16s+5=0
\]

\tcblower
Εδώ μπορούμε να εφαρμόσουμε το κριτήριο ευστάθειας Routh:

\[
\begin{array}{r|rrc}
s^4 & 1 & 18 & 5\\
s^3 & 8 & 16 & 0\\
s^2 & \frac{8\cdot18-1\cdot16}{8} = 16 & \frac{8\cdot5-1\cdot0}{8} = 5\\
s^1 & 13.5 & 0 \\
s^0 & 5
\end{array}
\]

Εφ' όσον δεν υπάρχει αλλαγή προσήμου στην πρώτη στήλη, το σύστημα είναι ευσταθές.

\end{exercise}
\begin{exercise}
Να εξεταστεί η ευστάθεια του συστήματος με χαρακτηριστική εξίσωση:
\[
s^5+s^4+2s^3+2s^2+3s+5=0
\]

\tcblower
Εφαρμόζουμε κριτήριο Routh:
\begin{multicols*}{2}
	\[
	\begin{array}{r|ccc}
	s^5 & \textcolor{green!50!black}{1} & 2 & 3 \\
	s^4 & \textcolor{green!50!black}{1} & 2 & 5\\
	s^3 & \textcolor{green!50!black}{ε} & -2 & \\
	s^2 & \textcolor{green!50!black}{\frac{2ε+2}{ε}} & 5 &\\
	s^1 & \textcolor{red!50!black}{\frac{-4ε-4-5ε^2}{2ε+2}} & 0 \\
	s^0 & \textcolor{green!50!black}{5}
	\end{array}
	\]
	\columnbreak

	Στην 3η σειρά προκύπτει 0. Για αυτό θεωρούμε έναν αριθμό \( ε>0 \) αλλά πολύ μικρό. Όταν προκύπτει 0 στην πρώτη θέση στήλης,
	τότε έχουμε πόλο στον φανταστικό άξονα ή στο δεξί ημιεπίπεδο.
	
	Ο πρώτος όρος της προτελευταίας γραμμής είναι αρνητικός, αφού:
	\[
	\lim_{\epsilon\to0^+} \frac{-4ε-4-5ε^2}{2ε+2} = -2
	\]
	
	Οι υπόλοιποι όροι της πρώτης στήλης είναι θετικοί.
\end{multicols*}

Αφού έχουμε 2 εναλλαγές προσήμου στην 1\textsuperscript{η} στήλη, έχουμε 2 ρίζες στο δεξί ημιεπίπεδο, και το σύστημα είναι ασταθές.

\end{exercise}
\begin{exercise}
Έστω το σύστημα:

\begin{tikzpicture}
\draw (2,0) node[rectangle,draw] (h) {$\displaystyle \frac{k}{s(s^2+s+1)(s+4)}$};
\draw (h.west) ++(-1,0) node[circle,draw,minimum size=5mm] (mix) {};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h);
\draw[->] (h.east) -- ++(2,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1) -| (mix);
\end{tikzpicture}

Είναι το σύστημα ευσταθές για κάποιο εύρος \( k \), και ποιό είναι αυτό;

\tcblower
Αρχικά υπολογίζουμε τη συνάρτηση μεταφοράς του συστήματος (αν θεωρήσουμε ότι η συνάρτηση μεταφοράς \textit{ανοιχτού} βρόχου είναι
\(G\)):
\[
G_{\text{ΣΜΚΒ}}(s) = \frac{G}{1+G} = \frac{k}{s(s^2+s+1)(s+4)+k} = \frac{k}{s^4+5s^3+5s^2+4s+k}
\]

Και εφρμόζουμε το κριτήριο Routh:
\[
\begin{array}{r|ccc}
s^4&1&5&k\\
s^3&5&4&0\\
s^2&\frac{21}{5}& k\\
s^1&\frac{84-25k}{21} & 0\\
s^0&k
\end{array}
\]

Για να είναι ευσταθές το σύστημα θέλουμε να μην υπάρχει καμία εναλλαγή προσήμου στην πρώτη στήλη, δηλαδή:
\[
\left.
\begin{aligned}
84-25k > 0 \implies k &< 3.36 \\
k&>0
\end{aligned}
\right\rbrace \implies 0 < k < 3.36
\]

\end{exercise}
\begin{exercise}
Δίνεται το παρακάτω σύστημα:

\begin{tikzpicture}
	\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
	\draw (2,0) node[transfer] (h1) {$\displaystyle \frac{5}{s(s+2)}$};
	\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
	\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle \frac{4}{s+5}$};
	
	\draw[<-] (mix) -- ++(-1,0);
	\draw[->] (mix) -- (h1);
	\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
	\draw[->] (fb.center) |- (h2) -| (mix);
	\draw (mix.south);
\end{tikzpicture}

Να προσδιοριστούν το περιθώριο φάσης και το περιθώριο κέρδους.

\tcblower
\begin{enumgreekparen}
	\item Για το περιθώριο φάσης βρίσκουμε τη συνάρτηση μεταφοράς ανοιχτού βρόχου και σχεδιάζουμε το διάγραμμα Bode. Εκμεταλλευόμαστε την ιδιότητα της σελίδας
	\pageref{sec:stability_trick} για να βρούμε την ισοδύναμη συνάρτηση:
	\[
	G(s) = \frac{5}{s(s+2)}\frac{4}{s+5} = \frac{20}{s(s+2)(s+5)}
	\]
	
	\begin{tikzpicture}[scale=1,xscale=1]
	\pgfplotsset{/pgf/number format/freq/.style={fixed}}
	\def\phasedown{0}
	\def\phaseextra{-0.5}
	
	\draw[->] (0,\phasedown+\phaseextra) -- (0,3) node[below left,orange!90!blue!80!black] {$|A|_{\si{\decibel}}$};
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	\foreach \x in {} {
		\draw[dashed] (\x,\phasedown) -- (\x,0);
	}
	
	\def\at{22}
	\draw[ultra thick,orange!90!blue!80!black]
	(0,2.5)
	-- ++(-1*\at:{1/cos(1*\at)}) node(c1) {} node[above right] {-20 dB/dec}
	-- ++(-2*\at:{1/cos(2*\at)}) node(c2) {} node[above right] {-40 dB/dec}
	-- ++(-3*\at:{1/cos(3*\at)}) node(c3) {} node[above right] {-60 dB/dec}
	;
	
	\draw[dashed] (1,0) node[below] {$2$} -- (c1);
	\draw[dashed] (2,0) node[below] {$5$} -- (c2);
	
	\foreach \x in {} {
		%\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\foreach \x in {} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	
	\end{tikzpicture}
	
	Βρίσκουμε την \( \omega_c \) ώστε \( \left|A(j\omega_c)\right| = 1 \):
	\[
	G(s) = \frac{20}{j\omega\left(\frac{j\omega}{2}+1\right)\left(\frac{j\omega}{5}+1\right)\cdot 2\cdot5}
	\]
	
	\begin{enumroman}
		\item Για \( \omega_c \ll 2\):
		\[
		G(s) \approx \frac{20}{2\cdot 5 j\omega}
		\]
		Και \( |G| = 1 \implies \omega_c = 2 \), άτοπο αφού υποθέσαμε ότι \( \omega_c \ll 2 \).
		
		\item
		Για \( \omega_c \ll 5 \):
		\[
		G(s) \approx \frac{20}{2\cdot 5(j\omega)\left(\frac{j\omega}{2}+1\right)}
		\]
		
		Λύνουμε την εξίσωση \( G(s) = 1 \) και έχουμε:
		\begin{align*}
			\left| G(s) \right| &= 1 \implies \\
			\left|\frac{20}{5s(s+2)}\right| &= 1 \implies \\
			\frac{4}{\left| -\omega^2 + 2j\omega \right|} &= 1 \implies \\
			16 &= \left|-\omega^2+2j\omega\right|^2 \implies \\
			\omega^4+4\omega^2&=16 \implies \underline{\omega_c = 1.57}
		\end{align*}
	\end{enumroman}

	Επομένως, για \( \omega_c = \SI{1.57}{\radian/\second} \), έχουμε (για τον κάθε πόλο):
	\[
	\left.
	\begin{aligned}
	\measuredangle \frac{1}{s} &= \ang{-90} \\
	\measuredangle \frac{1}{s+2} &= \measuredangle \frac{1}{1.57j+2}
	= \tan^{-1} \left(\frac{1.57}{2}\right) = \ang{-38} \\
	\measuredangle \frac{1}{s+5} &= \ang{-17}
	\end{aligned}
	\right\rbrace \xRightarrow{+} \measuredangle A(j\omega_c) = \ang{-145}
	\]
	
	Άρα τελικά:
	\[
	\phi_M = \measuredangle A(j\omega_c) - (\ang{-180}) = \ang{35}
	\]
	
	Μάλιστα, μπορούμε να σχεδιάσουμε αναλυτικά το προσεγγιστικό διάγραμμα Bode, υπολογίζοντας την τιμή για \( \omega=1 \),
	η οποία προκύπτει \( 20\log 2\, \si{\decibel} \):
	
	\begin{tikzpicture}[scale=1,xscale=1]
	\pgfplotsset{/pgf/number format/freq/.style={fixed}}
	\def\phasedown{0}
	\def\phaseextra{-0.5}
	
	\draw[->] (0,\phasedown+\phaseextra) -- (0,3) node[below left,orange!90!blue!80!black] {$|A|_{\si{\decibel}}$};
	\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};
	
	\foreach \x in {} {
		\draw[dashed] (\x,\phasedown) -- (\x,0);
	}
	
	\def\at{22}
	\draw[ultra thick,orange!90!blue!80!black]
	(0,2.2)
	-- ++(-1*\at:{1/cos(1*\at)}) node(c1) {} node[above right] {-20 dB/dec}
	-- ++(-2*\at:{1/cos(2*\at)}) node(c2) {} node[above right] {-40 dB/dec}
	-- ++(-3*\at:{1/cos(3*\at)}) node(c3) {} node[above right] {-60 dB/dec}
	;
	
	\draw[dashed] (1,0) node[below] {$2$} -- (c1);
	\draw[dashed] (2,0) node[below] {$5$} -- (c2) -- (c2 -| 0,0) node[left] {$0$};
	\draw (3,0) node[below] {$10$};
	
	\draw[fill=yellow,fill opacity=.3] (0,2.2) circle (1.7pt) node[left,opacity=1] {$20\log 2$};
	\draw[fill=yellow,fill opacity=.3] (c2) circle (1.7pt);
	
	\foreach \x in {} {
		%\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,-0.1) node[below] {$a=\frac{1}{τ}$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\foreach \x in {} {
		\pgfmathsetmacro\result{10^\x/100}
		\draw (\x,\phasedown-0.1) node[below] {$\pgfmathprintnumber[freq]\result a$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	\end{tikzpicture}
	
	Συγκεκριμένα, έχουμε:
	\[
	\begin{cases}
	\text{για } \omega \in [1,2] \implies &\quad |A|_{\mathrm{dB}} = 20\log2 - 20\log(\omega) \\
	\text{για } \omega \in [2,5] \implies &\quad |A|_{\mathrm{dB}} = 20\log2 - 20\log(\omega) -20\log\left(\frac{\omega}{2}\right) \\
	\text{για } \omega \in [5,\infty) \implies &\quad |A|_{\mathrm{dB}} = 20\log2 - 20\log(\omega) -20\log\left(\frac{\omega}{2}\right) -20\log\left(\frac{\omega}{5}\right) \\
	\end{cases}
	\]
	
	\item Για να βρούμε το περιθώριο κέρδους, πρώτα ψάχνουμε τη συχνότητα \( \omega_a \) για την οποία ισχύει \( \measuredangle
	A(j\omega_a) = \ang{-180} \):
	\begin{align*}
		\left(\measuredangle\frac{1}{s}\right)+ \left(\measuredangle\frac{1}{s+2}\right)
		+ \left(\measuredangle\frac{1}{s+5}\right) &= \ang{-180}\\
		-\ang{90} + \measuredangle \frac{1}{j\omega_a+2} + \measuredangle \frac{1}{j\omega_a+5} &= \ang{-180} \\
		-\ang{90} -\tan^{-1}\left(\frac{\omega_a}{2}\right)-\tan^{-1}\left(\frac{\omega_a}{5}\right) &= \ang{-180} \\
		-\tan^{-1}\left(\frac{\omega_a}{2}\right)-\tan^{-1}\left(\frac{\omega_a}{5}\right) &= \ang{-90}
	\end{align*}
	
	Για να προχωρήσουμε χρησιμοποιούμε την ταυτότητα:
	\[
	\infoboxed{
		\tan^{-1}(x) + \tan^{-1}(y) = \tan^{-1} \left( \frac{x+y}{1-xy} \right)	
	}
	\]
	
	Άρα:
	\[
	\tan^{-1}\left(\frac{\frac{7\omega_a}{10}}{1-\frac{\omega_a^2}{10}}\right)
	= \tan^{-1}\left(\frac{\frac{7\omega_a}{10}}{\frac{10-\omega_a^2}{10}}\right)
	= \tan^{-1}\left(\frac{7\omega_a}{10-\omega_a^2}\right) = \ang{90}
	\]
	
	Για να τείνει η γωνία στις \( \ang{90} \) πρέπει:
	\[
	\frac{7\omega_a}{10-\omega_a^2} \to \infty \implies 10-\omega_a^2 = 0 \implies \underline{\omega_a = \sqrt{10} \approx 3.16}
	\]
	
	Εφ' όσον \( \omega_a \in (2,5] \) παίρνουμε την κατάλληλη προσέγγιση για το πλάτος της συνάρτησης:
	\[
	\left| A(j\omega_a) \right|_{\mathrm{dB}} = 20\log 2-20\log(3.16)-20\log\left(\frac{3.16}{2}\right) \approx
	\SI{-7.95}{\decibel}
	\]
	
	Άρα τελικά:
	\[
	g_m = - |A| = \SI{7.95}{\decibel}
	\]
	
	\subparagraph{}
	Εναλλακτικά, για να βρούμε το περιθώριο κέρδους μπορούμε να χρησιμοποιήσουμε το κριτήριο Routh, και να ψάξουμε ποιός
	είναι ο μέγιστος όρος με τον οποίο μπορούμε να πολλαπλάσιασουμε τη συνάρτηση ανοιχτού βρόχου και να παραμείνουμε στην
	ευστάθεια.
	
	Για αυτό χρειάζεται να θεωρήσουμε το σύστημα:
	
	\begin{tikzpicture}
	\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
	\draw (1,0) node[rectangle,draw] (h0) {$k$};
	\draw (3,0) node[transfer] (h1) {$\displaystyle \frac{5}{s(s+2)}$};
	\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
	\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle \frac{4}{s+5}$};
	
	\draw[<-] (mix) -- ++(-1,0);
	\draw[->] (mix) -- (h0);
	\draw[->] (h0) -- (h1);
	\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
	\draw[->] (fb.center) |- (h2) -| (mix.south) node[below right] {$-$};
	\draw (mix.south);
	
	\draw [decorate,decoration={brace,amplitude=10pt},orange!20!black]
	(h0.north west |- h1.north east) -- (h1.north east) node [midway,above,yshift=4mm] {$G(s)$};
	\end{tikzpicture}
	
	με συνάρτηση μεταφοράς:
	\[
	H_c = \frac{G}{1+GF} = \frac{5k(s+5)}{s(s+2)(s+5)+k\cdot 20}
	\]
	και χαρακτηριστική εξίσωση:
	\[ s(s+2)(s+5)+20k = 0 \iff s^3+7s^2+10s+20k = 0 \]
	
	Εφαρμόζουμε το κριτήριο Routh:
	\[
	\begin{array}{r|cc}
	s^3&1&10 \\
	s^2&7&20k \\
	s^1 & \frac{70-20k}{7} & 0\\
	s^0 & 20k
	\end{array}
	\]
	
	Θέλουμε \(
		\begin{cases}
		\frac{70-20k}{7}> 0 \implies 70-20k > 0 \implies k<\frac{7}{2}\\
		20k > 0 \implies k>0
		\end{cases}
	\), δηλαδή \( k_{\max} = \frac{7}{2} \).
	
	Επομένως:
	\[
	g_m = k_{\max} = 3.5 \to 20\log\left( \frac{7}{2} \right) = \SI{10.88}{\decibel}
	\]
	
	\subparagraph{}
	Η διαφορά των \( \approx \SI{3}{\decibel} \) μεταξύ των δύο αποτελεσμάτων οφείλεται στο ότι
	λάβαμε \textit{προσεγγιστικό} διάγραμμα Bode, το οποίο εισάγει ένα σφάλμα. Στην προκειμένη
	περίπτωση, πιο σωστό είναι το αποτέλσμα που προέκυψε από το κριτήριο Routh.
\end{enumgreekparen}

\hspace{0pt}

\end{exercise}

\begin{exercise}
Να σχεδιαστεί διαγραμμα Nyquist και να εξεταστεί η ευστάθεια του συστήματος κλειστού βρόχου, αν η συνάρτηση ανοιχτού βρόχου είναι:
\[
A(s) = \frac{s+2}{(s+3)(s+5)}
\]
\tcblower
Πρώτα βρίσκουμε τις ακραίες τιμές:
\begin{align*}
	A(0) &= 0.133 + j0 \\
	\left|A(\infty)\right| &= 0 + j0
\end{align*}

Αφού έχουμε ένα μηδενικό (\( \ang{+90} \)) και δύο πόλους (\( 2\cdot(\ang{-90}) \)), η γωνία στο \( \infty \) γίνεται:
\[
\phi(\omega\to\infty) = \ang{-90}
\]

Για να ελέγξουμε από ποιά μεριά είναι το διάγραμμα, θεωρούμε:
\begin{align*}
\frac{s+2}{s^2+8s+15} &= \frac{j\omega+2}{-\omega^2+8j\omega+15} = \frac{(j\omega+2)(15-\omega^2-8j\omega)}{(-\omega^2+15+8j\omega)(15-\omega^2-8j\omega)}\\
&=\frac{15j\omega-j\omega^3-8j^2\omega^2+30-2\omega^2-16j\omega}{(15-\omega^2)^2+(8\omega)^2}
=\underbrace{\frac{30+6\omega^2}{\omega^4+34\omega^2+225}}_{>0}
\underbrace{-j\frac{\omega(\omega^2+1)}{\omega^4+34\omega^2+225}}_{<0}
\end{align*}

Με τη μελέτη της μορφής του μιγαδικού, μπορούμε να καταλάβουμε ότι το μηδέν προσεγγίζεται από κάτω. Εναλλακτικοί τρόποι
προσέγγισής του είναι οι εξής:

\begin{tikzpicture}[scale=1,baseline]

\draw[->] (-0.5,0) -- (2.5,0) node[right] {$\Re$};
\draw[->] (0,-1.5) -- (0,1.5) node[left] {$\Im$};

\def\t{2}

\def\scale{2}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{1/(#1^2+1)}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-#1/(#1^2+1)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:10,samples=0.5*\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);

\def\arrow{1}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\end{tikzpicture}
\hfill
\begin{tikzpicture}[scale=1,baseline]
\draw[->] (-1.5,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{1}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{1/3*#1*sin(#1 r) - 1/30*sin(#1 r)}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-1/3*#1*cos(#1 r) + 1/30*cos(#1 r)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:7.85398163397448,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} );

\def\arrow{5}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,\fa) -- (\xb,\fb);
\end{tikzpicture}
\hfill
\begin{tikzpicture}[scale=1,baseline]
\draw[->] (-1.5,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-1.5) -- (0,2) node[left] {$\Im$};

\def\t{2}

\def\scale{0.5}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{2/3*#1*cos(-0.500000000000000*pi r - 0.750000000000000*#1 r)}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{2/3*#1*sin(-0.500000000000000*pi r - 0.750000000000000*#1 r)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:6.28,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} );

\def\arrow{5}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,\fa) -- (\xb,\fb);
\end{tikzpicture}

Τελικά, το διάγραμμα Nyquist είναι:

\begin{tikzpicture}[scale=1]
\draw[->] (-2,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-1.5) -- (0,1.5) node[left] {$\Im$};

\def\t{2}

\def\scale{2}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{1/(#1^2+1)}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-#1/(#1^2+1)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0.001:10,samples=0.5*\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);

\def\arrow{1}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,xshift=-0.5pt,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\draw (0,0) node[above left] {$0$};
\draw (\scale,0) node[above] {$0.133$};

\end{tikzpicture}

Αφού δεν περικυκλώνεται το -1, το σύστημα είναι ευσταθές.

\end{exercise}
\begin{exercise}
Να σχεδιαστεί το διάγραμμα Nyquist:
\[
G(s) = \frac{10(s+2)}{(s+3)^2+25}
\]
\tcblower
Έχουμε:
\[
A(j\omega) = \frac{10\left( 4\omega^2+68-j\omega(\omega^2-22) \right)}{\omega^4-32\omega^2+1156}
\]
και επιπλέον:
\begin{alignat*}{2}
	\omega=0 : &&\quad A(j\omega) &= 0.588 \\
	\omega\to \infty : &&\quad \left|A(j\omega)\right| &= 0
\end{alignat*}

Θα ψάξουμε ακόμα τα σημεία τομής με τον πραγματικό άξονα:
\[
\Im\left[A(j\omega)\right] = 0 \implies \omega(\omega^2-22) = 0 \implies \begin{cases}
\omega &= 0\\
\omega &= \sqrt{22} = 4.69
\end{cases}
\]

Τέλος, παρατηρούμε ότι \( \Re\left[A(j\omega)\right] = 1.66 \), ότι για \( \omega \in [0,\ 4.69] \implies \omega^2-22 < 0
\implies \Im\left[A(j\omega)\right] > 0 \), άρα προσεγγίζουμε από επάνω, και ότι στον φανταστικό άξονα πηγαίνουμε μόνο όταν
\( \Re\left[A(j\omega)\right] = 0 \implies \omega \to \infty \):

	\begin{tikzpicture}[scale=1]
\draw[->] (-1,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};

\def\scale{1.5}
\def\xscale{1.5}

\pgfmathdeclarefunction{fx}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			60*#1^2/(#1^4 - 32*#1^2 + 1156) - 20*(#1^2 - 34)/((#1^2 - 34)^2 +36*#1^2)%
		}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}%
\pgfmathdeclarefunction{fy}{1}{%
	{\pgfkeys{/pgf/fpu=true}%
		\pgfmathsetmacro\f{%
			-10*#1^3/(#1^4 - 32*#1^2 + 1156) + 340*#1/(#1^4 - 32*#1^2 + 1156) -
			120*#1/((#1^2 - 34)^2 + 36*#1^2)			}%
		\pgfkeys{/pgf/fpu=false}%
		\xdef\ga{\f}%
	}%
	\pgfmathfloattofixed{\ga}%
}


\draw[blue!50!cyan,very thick]
plot[variable=\x,domain=0:80,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
( {fx(\x)}, {fy(\x)} ) -- (0,0);
\draw[blue!50!cyan!50!red,very thick]
plot[variable=\x,domain=0:80,samples=\gsamples,smooth,yscale=\scale,xscale=\xscale]
( {fx(\x)}, {-fy(\x)} ) -- (0,0);


\def\arrow{1.4}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\def\arrow{30}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\def\arrow{10}

\pgfmathsetmacro\xa{\xscale*fx(\arrow)}
\pgfmathsetmacro\xb{\xscale*fx(\arrow + 0.01)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.01)}
\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);

\draw(\xscale*0.388,0) node [below right,scale=.8] {$0.588$};
\draw(\xscale*1.66,0) node [below left,scale=.8] {$1.66$};
\filldraw[blue!70!cyan,fill=blue!80!cyan] (\xscale*1.66,0) node[above right,scale=.9] {$\omega \to 4.69$};

\end{tikzpicture}

Αφού το -1 δεν περικυκλώνεται, έχουμε \( N= 0\). Επειδή δεν υπάρχουν πόλοι δεξιά, ισχύει \( P = 0\). Άρα τελικά \( Z=0\), και
το σύστημα είναι ευσταθές.

\end{exercise}
\begin{exercise}
Να σχεδιαστεί το διάγραμμα Nyquist και να εξεταστεί η ευστάθεια:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (1.2,0) node[transfer] (h0) {$\displaystyle \frac{6}{s+1}$};
\draw (3.5,0) node[transfer] (h1) {$\displaystyle \frac{7}{s^2+5s+2}$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(-1,-1) node[transfer] (h2) {$\displaystyle \frac{8}{s+2}$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h0);
\draw[->] (h0) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix.south) node[below right] {$-$};
\draw (mix.south);
\end{tikzpicture}

\tcblower
Η (ισοδύναμη) συνάρτηση μεταφοράς \textit{ανοιχτού} βρόχου είναι:
\[
A(s) = \frac{6}{s+1}\frac{7}{s^2+5s+2}\frac{8}{s+2} = \frac{336}{s^4+8s^3+19s^2+16s+4}
\]
άρα:
\[
A(j\omega) = \frac{336}{\omega^4-j8\omega^3-19\omega^2+j16\omega+4}
= \frac{336\left[ (\omega^4-19\omega^2+4)+j(8\omega^3-16\omega) \right]}{\omega^8 + 26\omega^6 + 113\omega^4 + 104\omega^2+16}
\]

Αντίστοιχα με την προηγούμενη άσκηση, υπολογίζουμε:
\begin{align*}
	A(0) &= 84\\
	\left|A(\infty)\right| &= 0 \\
	\Im\left[ A(j\omega) \right] &= 0 \implies 8\omega^3-16\omega = 0 \implies \omega = 0 \text{ ή } \omega=\sqrt{2} \\
	\Im\left[A(j\omega)\right] &<0 \quad \text{(άρα προσεγγίζουμε από κάτω)} \\
	A(j\sqrt{2}) &= -11.2 \\
	\phi(\infty) &= -\ang{90}-\ang{90}-\ang{90}-\ang{90} = \ang{-360}
\end{align*}

Άρα το διάγραμμα γίνεται:

\begin{tikzpicture}[scale=1,baseline]
\draw[->] (-1.5,0) -- (3,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2.5) node[left] {$\Im$};

\def\t{2}

\def\scale{2}
\pgfmathdeclarefunction{fx}{1}{%
	\pgfmathparse{-1/2*#1*cos(-#1 r)/pi + cos(-#1 r)}%
}
\pgfmathdeclarefunction{fy}{1}{%
	\pgfmathparse{-1/2*#1*sin(-#1 r)/pi + sin(-#1 r)}%
}

%\pgfkeys{/pgf/fpu=true}
\draw[blue!50!cyan,very thick,name path=(n)]
plot[variable=\x,domain=0.001:6.28,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {fy(\x)} );
\draw[blue!50!cyan!50!red,very thick,name path=(nr)]
plot[variable=\x,domain=0.001:6.28,samples=\gsamples,smooth,scale=\scale]
( {fx(\x)}, {-fy(\x)} );

\def\arrow{5}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{>}}}] (\xa,\fa) -- (\xb,\fb);

\def\arrow{1}

\pgfmathsetmacro\xa{\scale*fx(\arrow)}
\pgfmathsetmacro\xb{\scale*fx(\arrow + 0.1)}
\pgfmathsetmacro\fa{\scale*fy(\arrow)}
\pgfmathsetmacro\fb{\scale*fy(\arrow + 0.1)}

\path[very thick,blue!60!cyan,postaction={decorate},decoration={markings,mark=at position 0.2 with {\arrow{<}}}] (\xa,-\fa) -- (\xb,-\fb);

\filldraw[top color=red,bottom color=blue,fill opacity=.5] (-1,0) circle (2.5pt) node[below left,opacity=.7] (ins) {$-11.2$};
\draw (ins.south) node[yshift=-2pt,scale=.5] {$\omega=\sqrt{2}$};

\filldraw[top color=white,bottom color=blue,fill opacity=.5] (-0.2,0) circle (1.5pt) node[below left] {$-1$};

\draw[brown!50!red,thick,densely dotted,name path=(l)] (-0.2,0) -- ++(30:3);

\path [name intersections={of=(l) and (n)}];
\filldraw[fill opacity=.8] (intersection-1) node[rounded corners=2pt,draw,inner sep=2pt,top color=white,bottom color=brown] {};
\draw[ultra thick,-stealth,brown!40!orange!80!black] (intersection-1) ++(45:0.3) ++(45+90:0.3) -- ++(45-90:0.8);
\path [name intersections={of=(l) and (nr)}];
\filldraw[fill opacity=.8] (intersection-1) node[rounded corners=2pt,draw,inner sep=2pt,top color=white,bottom color=brown] {};
\draw[ultra thick,-stealth,brown!40!orange!80!black] (intersection-1) ++(45:0.3) ++(45+90:0.3) -- ++(45-90:0.8);

\draw (2,0) node[above right,scale=.8] {$84$};
\end{tikzpicture}

Παρατηρούμε ότι έχουμε \( N=2 \) και \( P=0 \), άρα \( Z=2\), δηλαδή το σύστημα είναι ασταθές.

\end{exercise}
\subsection{Γεωμετρικός τόπος ριζών}
Έστω ότι έχουμε το σύστημα:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (3,0) node[transfer] (h1) {$\displaystyle \frac{\kappa}{s(s+10)}$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix1) {};
\draw (1,0) node[circle,draw,minimum size=5mm] (mix2) {};
\draw (h1.south) ++(-1,-0.7) node[draw,rectangle] (h2) {$bs$};

\draw[<-] (mix1) -- ++(-1,0);
\draw[->] (mix1) -- (mix2);
\draw[->] (mix2) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix2.south) node[below right] {$-$};
\draw[->] ([xshift=2mm]fb.center) -- ++(0,-2)  -| (mix1.south) node[below right] {$-$};
\draw (mix1.south);
\end{tikzpicture}

Τότε η συνάρτηση μεταφοράς έχει τη μορφή
\[
H_p(s) = \frac{\prod_{i}(s+z_i)}{s^N \prod_j (s+p_j)}
= \frac{N(s)}{D(s)}
\]

Για το συγκεκριμένο σύστημα, η συνάρτηση μεταφοράς ανοιχτού βρόχου
είναι:
\[
H_p(s) = \frac{κ}{s(s+10+κb)}
\]

Για να βρούμε το \textbf{γεωμετρικό τόπο ριζών}, χρειάζεται να
βρούμε μια εξίσωση της μορφής:
\[
\boxed{1+ K_\gamma H_p(s) = 0}
\]

Για το συγκεκριμένο πρόβλημα μπορούμε να εργαστούμε με \( K_γ = κ \)
ή \( Κ_\gamma = b \), δηλαδή:
\begin{enumgreekparen}
	\item Για \( K_γ = κ,\quad b=\mathrm{const.} \):
	\[
	1 + Kb \cdot \frac{(s+\sfrac{1}{b} )}{s(s+10)} = 0
	\]
	\item Για \( K_γ = b,\quad κ=\mathrm{const.}\):
	\[
	1 + bk \frac{s}{s^2+10s+κ} = 0
	\]
\end{enumgreekparen}

%todo{Reorganise}

Επομένως, έχουμε τη μορφή:
\[
1+K_γ\frac{N(s)}{D(s)} = 0
\implies
D(s) + K_γN(s) = 0
\]

Όταν στην παραπάνω εξίσωση θέσουμε το \( K_γ = 0 \), τότε αποκτά
τη μορφή \( D(s) = 0\), δηλαδή οι λύσεις της είναι οι πόλοι που αντιστοιχούν
στο χαρακτηριστικό πολυώνυμο.

Αντίστοιχα, αν θέσουμε \( Κ_γ \to \infty \), τότε αποκτά τη μορφή
\( N(s) \), δηλαδή οι λύσεις είναι τα μηδενικά της συνάρτησης μεταφοράς.

Για όλες τις υπόλοιπες τιμές του \( κ \), η λύση της παραπάνω
εξίσωσης αποκτά μια τιμή στο μιγαδικό επίπεδο. Ο γεωμετρικός τόπος
των ριζών αυτών μπορεί να σχεδιαστεί:

\begin{tikzpicture}
\draw[->] (-4,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[locus,very thick,postaction={decorate},
decoration={markings,
	mark=at position 0.2 with {\arrow{>}},%
	mark=at position 0.75 with {\arrow{<}},%
	mark=at position 0.89 with {\arrow{<}},%
	mark=at position 0.94 with {\arrow{<}},%
	mark=at position 0.72 with {\arrow{<}},%
	mark=at position 0.99 with {\arrow{>}}%
}]
(-2,0) circle (1.5cm)
(-1,0) -- (0,0)
(-3,0) -- (-4,0);

\draw (0,0) node[locuspole,label={[below right]0:$0$}] {};
\draw (-1,0) node[locuspole=$-10$] {};
\draw (-3,0) node[locuszero=$\sfrac{-1}{b}$] {};

\draw[locus,every node/.style={scale=.8,above right}]
(0,0) node {$k=0$}
(-1,0) node[above] {$k = 0$}
(-3,0) node {$k\to\infty$}
(-4,0) node[above left] {$k\to\infty$};
\end{tikzpicture}

Αυτό σημαίνει ότι, επιλέγοντας τις τιμές του \( κ \), μπορούμε να
έχουμε πόλους για το σύστημα μόνο στα συγκεκριμένα σημεία που
φαίνονται παραπάνω και ανήκουν στο γεωμετρικό τόπο. Παρ' όλα αυτά,
μπορούμε να μελετήσουμε πώς η μεταβολή του \( κ \) επηρεάζει
τις θέσεις των πόλων του συστήματος. Για παράδειγμα, στο συγκεκριμένο
διάγραμμα, παρατηρούμε πως όσο αυξάνεται το \( κ \to \infty \),
τότε, ακολουθώντας τα βελάκια, ο ένας πόλος πηγαίνει στο \( \infty \),
αλλά ο άλλος πηγαίνει όλο και πιο δεξιά, καθιστώντας το σύστημα
πιο αργό.

Αντίστοιχα, για το \( b \) με την εξίσωση \( 1+bκ\frac{s}{s^2+10s+κ}=0 \), έχουμε τον εξής
γεωμετρικό τόπο:

\begin{tikzpicture}
\draw[->] (-4,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[locus,very thick,postaction={decorate},
decoration={markings,
	mark=at position 0.2 with {\arrow{>}},%
	mark=at position 0.4 with {\arrow{>}},%
	mark=at position 0.60 with {\arrow{>}},%
	mark=at position 0.95 with {\arrow{>}},%
}]
(-1.5,1.5) arc(90:180:1.5)
(-1.5,-1.5) arc(-90:-180:1.5)
(-3,0) -- ++(-1,0)
(-3,0) -- ++(3,0)
;

\draw[dashed,gray] (0,1.5) -- ++(-1.5,0);
\draw[dashed,gray] (0,-1.5) -- ++(-1.5,0);
\draw[densely dashed,gray] (-1.5,1.5) -- (-1.5,-1.5);

\draw (0,0) node[locuszero,label={[below right]0:$0$}] {};
\draw (-1.5,1.5) node[locuspole] {};
\draw (-1.5,-1.5) node[locuspole] {};

\draw[locus,every node/.style={scale=.8,above right}]
(-1.5,1.5) node {$b=0$}
(-1.5,-1.5) node[below] {$b = 0$}
(-4,0) node[above] {$b\to\infty$};
\end{tikzpicture}

\subsubsection{Κανόνες}
Για να διευκολυνθούμε στο σχεδιασμό των διαγραμμάτων γεωμετρικών
τόπων, ακολουθούμε μερικούς \textbf{κανόνες}:
\begin{itemize}
	\item Το πλήθος των πόλων της \( D(s) \) είναι το πλήθος των κλάδων \( n \)
	\item Το πλήθος των πόλων της γης είναι 2
	\todo{remove}
	\item Το πλήθος των μηδενικών είναι ίσο με το πλήθος των κλάδων που
	τείνουν σε ένα μηδενικό \( m \)
	\item Η διαφορά του πλήθους των πόλων και των μηδενικών είναι το
	πλήθος των κλάδων που τείνουν στο άπειρο
	\item Τα τμήματα του \textit{πραγματικού} άξονα που ανήκουν στο
	γεωμετρικό τόπο είναι αυτά που αφήνουν δεξιά τους περιττό πλήθος
	πόλων και μηδενικών.
	\item
	Το σημείο τομής των ασυμπτώτων με τον πραγματικό άξονα είναι το:
	\begin{align*}
		σ_A &= \frac{\sum p_i - \sum z_i}{n-m}
		\intertext{Και η γωνία σε εκείνο το σημείο είναι}
		\theta_i &= \frac{(2i+1)\cdot 180}{n-m}
		\qquad i=0,1,\dots,n-m-1
	\end{align*}
	(όπου \( n\) και \( m \) ο \textit{αριθμός} των πόλων και των μηδενικών αντίστοιχα)
	\item
	Για να βρούμε τα \textbf{σημεία σύγκλισης} (\textbf{σημεία απόσχισης}) δύο καμπυλών, βρίσκουμε τη λύση της παραγώγου:
	\[
	\od{H_p(s)}{s} = 0
	\]
	και απορρίπτουμε τυχόν λύσεις που δεν ανήκουν στο γεωμετρικό τόπο.
	
	Στο συγκεκριμένο πρόβλημα, για \( \frac{1}{b}=20 \), βρίσκουμε
	\( s^2+40s+200 =0 \), άρα \( s = -5.35 \) και \( s=-34.14 \) για το πρώτο διάγραμμα,
	και \( s=-6 \) για το δεύτερο διάγραμμα.
	
	\item Για τη γωνία αναχώρησης από ένα μηδενικό ή έναν πόλο \( s \) ισχύει:
	\[
	\sum \measuredangle(s-z_i) - \sum\measuredangle(s-p_i) = \ang{180}
	\]
	Δηλαδή το άθροισμα όλων των γωνιών αναχώρησης από μηδενικά μείον πόλους
	είναι \( \ang{180} \).
	
	Για να βρούμε τη γωνία αναχώρησης από έναν πόλο, βρίσκουμε τις γωνίες από τους υπόλοιπους
	πόλους και μηδενικά, και εφαρμόζουμε τον τύπο:
	
\begin{tikzpicture}[xscale=0.8,scale=1.2]
\draw[->] (-6,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[very thick,locus,postaction={decorate},
decoration={markings,
	mark=at position 0.6 with {\arrow{>}},%
}] (-1,2) arc (0:40:1.5) node[above,scale=.5,align=center,rotate=20] {γεωμετρικός\\τόπος ριζών};

\begin{scope}[dashed,gray]
\draw (0,0) -- (-1,2) node[pos=.1] (a1) {};
\draw (-1,-2) -- (-1,2) node[pos=.1] (a2) {};
\draw (-2,0) -- (-1,2) node[pos=.1] (a3) {};
\draw (-3,0) -- (-1,2) node[pos=.1] (a4) {};
\draw (-4,0) -- (-1,2) node[pos=.1] (a5) {};
\draw (-5,0) -- (-1,2) node[pos=.1] (a6) {};
\end{scope}
\draw (0,0) node[locuspole] {};
\draw (-1,-2) node[locuspole] {};
\draw (-2,0) node[locuspole] {};
\draw (-3,0) node[locuspole] {};
\draw (-4,0) node[locuszero] {};
\draw (-5,0) node[locuspole] {};
\draw (-1,2) node[locuspole,very thick] {};

\draw[densely dotted] (0,2) -- ++(-2,0);
\draw[densely dotted] (0,-2) -- ++(-2,0);

\draw[blue,->] (0,0) ++(0.4,0) to[bend right] node[midway,right,scale=.8] {$\theta_1$} (a1.center);
\draw[blue,->] (-2,0) ++(0.4,0) to[bend right] node[midway,right,scale=.8] {$\theta_3$} (a3.center);
\draw[blue,->] (-3,0) ++(0.4,0) to[bend right] node[midway,right,scale=.7] {$\theta_4$} (a4.center);
\draw[blue,->] (-4,0) ++(0.4,0) to[bend right] node[midway,right,scale=.7] {$\theta_5$} (a5.center);
\draw[blue,->] (-5,0) ++(0.4,0) to[bend right] node[midway,right,scale=.6] {$\theta_6$} (a6.center);
\draw[blue,->] (-1,-2) ++(0.4,0)|- node[midway,right,scale=.8] {$\theta_3$} ++(-0.4,0.3);

\draw[blue!50!cyan,->] (-1,2) ++(0.4,0) to[bend right] node[right,midway] (lb) {$\theta_x$} ++(-0.4,0.3);
\draw[blue!50!cyan] (lb.south) node[below,scale=.4,align=center] {γωνία\\άφιξης};

\draw (3,1) node[right]
{$\displaystyle
	{\color{blue}\theta_4}
	- \left(
	{\color{blue}\theta_1}+{\color{blue}\theta_2}+{\color{blue}\theta_3}+{\color{blue}\theta_5}+{\color{blue!50!cyan}\theta_x}
	\right) = \ang{180}
	$};
\end{tikzpicture}
	
	%Συγκεκριμένα, στο παραπάνω παράδειγμα, βρίσκουμε \( \theta_x = \ang{-123.5} \):
	%\todo{Graph 115}
	
	\item Επειδή έχουμε συζυγείς μιγαδικές ρίζες, έχουμε συμμετρία ως προς τον οριζόντιο
	άξονα.

\end{itemize}

\paragraph{Παράδειγμα}
Θέλουμε να βρούμε το γεωμετρικό τόπο των ριζών για την:
\[
A(s) = \frac{κ}{s(s+2)(s+4)}
\]
\subparagraph{Λύση}
Η εξίσωση που πρέπει να λύσουμε είναι:
\[
1+κ\frac{1}{s(s+2)(s+4)} = 0
\]

Αρχικά τοποθετούμε στο μιγαδικό επίπεδο τους πόλους:

\begin{tikzpicture}[xscale=0.8]
\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw (0,0) node[locuspole,label={[below right]0:$0$}] {};
\draw (-2,0) node[locuspole=$-2$] {};
\draw (-4,0) node[locuspole=$-4$] {};

\end{tikzpicture}

Εφ' όσον έχουμε 3 πόλους, έχουμε και 3 κλάδους, και επειδή δεν υπάρχει κανένα μηδενικό,
οι κλάδοι αυτοί πηγαίνουν στο άπειρο.

Το σημείο τομής των ασυμπτώτων είναι:
\[
σ_A = \frac{-4-2-0}{3-0} = -2
\]
και οι ασύμπτωτες έχουν γωνία (από τον τύπο \( \theta_i = \frac{(2i+1)\cdot180}{n-m} \)):
\begin{align*}
	\theta_1 &= \ang{60} \\
	\theta_2 &= \ang{-60} \\
	\theta_3 &= \ang{180}
\end{align*}
επομένως στο διάγραμμα μπορούμε να προσθέσουμε τις ασύμπτωτες και τα κομμάτια του
πραγματικού άξονα:

\begin{tikzpicture}[xscale=0.8]
\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[locus,very thick,postaction={decorate},
decoration={markings,
	mark=at position 0.2 with {\arrow{>}},%
	mark=at position 0.5 with {\arrow{>}},%
	mark=at position 0.9 with {\arrow{<}},%
}]
(-4,0) -- +(-1,0)
(-2,0) -- (0,0)
;

\draw[green!60!black] (-2,0) -- (60:2) node[pos=.15] (m) {};
\draw[green!60!black,->] (-2,0) ++ (0.6,0) to[bend right] node[midway,scale=.8,right] {$\ang{60}$} (m.center);
\draw[green!60!black] (-2,0) -- (-60:2);

\draw (0,0) node[locuspole,label={[below right]0:$0$}] {};
\draw (-2,0) node[locuspole=$-2$] {};
\draw (-4,0) node[locuspole=$-4$] {};

\end{tikzpicture}

Επίσης, λύνοντας την εξίσωση \( \od{A}{s} = 0 \), βρίσκουμε το σημείο απόσχισης στη θέση
\( s \approx -0.85 \), και μπορούμε να σχεδιάσουμε το γεωμετρικό τόπο:

\begin{tikzpicture}[xscale=0.8,scale=1.4]
\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};


\draw[locus,very thick,postaction={decorate},
decoration={markings,
	mark=at position 0.1 with {\arrow{>}},%
	mark=at position 0.2 with {\arrow{>}},%
	mark=at position 0.35 with {\arrow{<}},%
	mark=at position 0.5 with {\arrow{<}},%
	mark=at position 0.9 with {\arrow{>}},%
}]
(-4,0) -- +(-1,0)
(-2,0) -- (0,0)
plot [smooth] coordinates {(0.7,1.38) (-0.85,0) (0.7,-1.38)}
;

\draw[green!60!black] (-2,0) -- (60:2) node[pos=.15] (m) {};
\draw[green!60!black] (-2,0) -- (-60:2);

\draw (0,0) node[locuspole,label={[below right]0:$0$}] {};
\draw (-2,0) node[locuspole=$-2$] {};
\draw (-4,0) node[locuspole=$-4$] {};

\draw (-0.85,0) node[locusbreak,label={[below,scale=.8,fill=white,fill opacity=.4,text opacity=1]-90:$-0.85$}] {};
\end{tikzpicture}

\paragraph{}
Για να έχουμε \textbf{άπειρο περιθώριο κέρδους}, θέλουμε να μην εμφανίζεται κανένα κομμάτι
του γεωμετρικού τόπου στο δεξί ημιεπίπεδο. Για να το διορθώσουμε αυτό στη συνάρτηση
του παραδείγματος, μπορούμε να αλλάξουμε τη διεύθυνση των ασυμπτώτων, προσθέτοντας ένα
μηδενικό, για παράδειγμα στη θέση \( \mu = -5 \):
\[
A(s) = \frac{κ(s-μ)}{s(s+2)(s+4)}
\]

Τότε ο γεωμετρικός τόπος θα αποκτήσει αυτήν τη μορφή (αφού ακολουθήσουμε πάλι την παραπάνω
διαδικασία):

\begin{tikzpicture}[xscale=0.8]
\draw[->] (-6,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[green!60!black,dashed] (-0.9,-2.5) -- (-0.9,2.5);

\draw[locus,very thick,postaction={decorate},
decoration={markings,
	mark=at position 0.07 with {\arrow{>}},%
	mark=at position 0.18 with {\arrow{>}},%
	mark=at position 0.30 with {\arrow{<}},%
	mark=at position 0.5 with {\arrow{<}},%
	mark=at position 0.85 with {\arrow{>}},%
}]
(-4,0) -- +(-1,0)
(-2,0) -- (0,0)
plot [smooth,tension=.8] coordinates {(-1,2) (-1.2,0.5) (-1.4,0) (-1.2,-0.5) (-1,-2)}
;

\draw (0,0) node[locuspole,label={[below right]0:$0$}] {};
\draw (-2,0) node[locuspole=$-2$] {};
\draw (-4,0) node[locuspole=$-4$] {};
\draw (-5,0) node[locuszero=$-5$] {};
\end{tikzpicture}

\subsubsection{Ασκήσεις}
\begin{exercise}
	Να σχεδιαστεί ο γεωμετρικός τόπος ριζών για το σύστημα με συνάρτηση μεταφοράς ανοιχτού βρόχου:
	\[
	GF = \frac{k}{(s+1)(s^2+4s+5)}
	\]
	για \( k>0 \)
	
	\tcblower
	
	Η συνάρτηση μεταφοράς \textit{κλειστού} βρόχου είναι, αν έχουμε μοναδιαία αρνητική
	ανάδραση:
	\[
	\frac{GF}{1+GF} = \frac{GF}{1+k\frac{1}{(s+1)(s^2+4s+5)}}
	\]
	δηλαδή στον παρονομαστή εμφανίζεται η μορφή \( 1+aL(s) = 1+k\frac{1}{(s+1)(s^2+4s+5)} \) που επιθυμούμε, με \( a=k \) και:
	\[
	L(s) = \frac{1}{(s+1)(s^2+4s+5)} = \frac{1}{(s+1)\left( s-(-2+j) \right)\left(s-(-2-j)\right)}
	\]
	
	Για να σχεδιάσουμε το διάγραμμα, λαμβάνουμε υπ' όψιν ότι:
	\begin{itemize}
		\item Έχουμε 3 πόλους, άρα 3 κλάδους
		\item Για τις ασύμπτωτες ευθείες ισχύει:
		\[
		\text{Αριθμός Ασυμπτώτων} = \text{Αριθμός πόλων} - \text{Αριθμός μηδενικών} = 3-0 = 3
		\]
		
		Το \textbf{κέντρο} των ασυμπτώτων είναι:
		\[
		\frac{\sum p_i - \sum z_j}{A_p - A_z} = \frac{-1-2+j-2-j}{3} = -1.67
		\]
		και η γωνία που σχηματίζουν είναι:
		\[
		\theta_ρ = \frac{2ρ+1}{A_ρ-Α_z} \cdot \ang{180}
		\]
		όπου \( ρ = 0,\ 1,\dots,\ A_ρ-A_z-1 \), \( A_ρ \) ο αριθμός των πόλων, και \( A_z \) ο
		αριθμός των μηδενικών, δηλαδή:
		\begin{alignat*}{2}
		\theta_0 &= \frac{1}{3}\cdot\ang{180} &&= \ang{60} \\
		\theta_1 &= \frac{2+1}{3}\cdot\ang{180} &&= \ang{180} \\
		\theta_2 &= \frac{5}{3}\cdot\ang{180} &&= \ang{300}
		\end{alignat*}
		
		Σε αυτό το σημείο μπορούμε να επισημάνουμε ότι οι γωνίες \( \theta_ρ \) θα βγαίνουν
		πάντα ίδιες, καθώς εξαρτώνται μόνο από τον αριθμό τον πόλων, οπότε δεν
		χρειάζεται να τις υπολογίζουμε κάθε φορά.
		\item Για τη γωνία αναχώρησης ισχύει:
		\[
		\phi_j = \left( \sum \measuredangle z_i - \sum \measuredangle p_k \right)_{s=p_j}
		+\ang{180}
		\]
		
		Θυμόμαστε τη συνάρτηση μεταφοράς ανοιχτού βρόχου:
		\[
		\frac{k}{(s+1)(s+2-j)(s+2+j)}
		\]
		οπότε απλά θέτουμε \( s \) για κάθε πόλο και βρίσκουμε τη γωνία που σχηματίζει αυτός
		ο μιγαδικός αριθμός.
		
		\begin{itemize}
			\item Για το \( -2+j \):
			\[
			\phi = -\measuredangle(-2+j+1) - \measuredangle 0 - \measuredangle(-2+j+2+j) + \ang{180}
			= -\ang{135} - \ang{90} + \ang{180} = -\ang{45}
			\]
			
			Για να βρούμε τις γωνίες του κάθε πόλου, μπορούμε να βρούμε με κάποιον τρόπο το
			όρισμα του μιγαδικού (π.χ. \( \arg(-1+j) \)), από τη συνάρτηση \( \mathrm{atan2} \)
			που δέχεται ως όρισμα το φανταστικό και το πραγματικό μέρος, ή από τη συνάρτηση
			\( \arctan \), προσέχοντας όμως να αφαιρέσουμε ή να προσθέσουμε \( \ang{180} \) αν
			χρειάζεται, ελέγχοντας αν η γωνία βρίσκεται στο σωστό τεταρτημόριο.
			
			\begin{attnbox}{atan2}
				Η συνάρτηση \( \displaystyle \mathlarger{\mathrm{atan2}} \) εκφράσει
				το \textbf{όρισμα ενός μιγαδικού αριθμού}
				\( x+jy \).
				
				Έχει την ίδια τιμή με την \( \arctan \) στο 1\textsuperscript{ο} τεταρτημόριο, αλλά
				μπορεί να είναι \textbf{διαφορετική στα υπόλοιπα τεταρτημόρια}.
				
				Έχει 2 ορίσματα, και ορίζεται ως εξής:
				\[
				\mathrm{atan2}\,(y,\, x)= \measuredangle(x+jy) = \begin{cases}
				\arctan\left|\frac{y}{x}\right|, \qquad & x,y>0 \\
				\pi - \arctan\left|\frac{y}{x}\right|, \qquad & x<0,\ y>0 \\
				-\pi + \arctan\left|\frac{y}{x}\right|, \qquad & x<0,\ y<0 \\
				-\arctan\left|\frac{y}{x}\right|, \qquad & x>0,\ y<0
				\end{cases}
				\]
				
				\begin{center}
					 \begin{tikzpicture}[scale=2]
					\draw (-2,0) -- (2,0);
					\draw (0,-2) -- (0,2);
					
					\draw(0,0) -- (1.5,1.5);
					\draw[dashed] (0,0) -- (-1.5,0) -- (-1.5,-1.5) -- (0,-1.5);
					\draw (0,0) -- (-1.5,-1.5);
					\draw (-0.4,0) arc (180:225:.4) node[midway,left,yshift=-1mm] {$\mathsmaller{\theta_0}$};
					\draw (0.7,0) arc (0:45:.7) node[midway,right] {$\theta_0$};
					\draw[->,blue!50!cyan!50!black] (0.5,0) arc(360:225:.5) node[midway,below,yshift=-2pt,fill=white,fill opacity=0.7,text opacity=1] {$-\pi+\theta_0$};
					
					\draw[dashed] (0,0) -- (-1.5,1.5);
					\draw[->,blue!50!cyan!50!black] (0.3,0) arc(0:180-45:.3) node[midway,above,yshift=2pt,xshift=-6pt,scale=.8,fill=white,fill opacity=0.7,text opacity=1] {$\pi-\theta_0$};
					
					\draw[dashed] (0,0) -- (1.5,-1.5);
					\draw[->,blue!50!cyan!50!black] (0.8,0) arc(0:-45:.8) node[midway,right,scale=.9] {$-\theta_0$};
					
					\draw[top color=red,bottom color=blue,fill opacity=.7] (1.5,1.5) circle (3pt) node[above] {$x+jy$};
					\draw[top color=red,bottom color=blue,fill opacity=.7] (-1.5,-1.5) circle (3pt) node[below] {$x+jy$};
					
					\draw[top color=red,bottom color=blue,fill opacity=.7] (-1.5,1.5) circle (3pt) node[above,scale=1] {$x+jy$};
					\draw[top color=red,bottom color=blue,fill opacity=.7] (1.5,-1.5) circle (3pt) node[below,scale=1] {$x+jy$};
					
					\draw[dashed] (0,1.5) -- (1.5,1.5) -- (1.5,0);
					
					\draw (current bounding box.south) node[below] {$\displaystyle \theta_0=\arctan\left|\frac{y}{x}\right|$};
					\end{tikzpicture}
				\end{center}
			\end{attnbox}
			
		\end{itemize}
		
		\item Τα βελάκια πηγαίνουν από τους πόλους προς το άπειρο ή προς τα μηδενικά.
	\end{itemize}
	
	Άρα το διάγραμμα γίνεται:
	
	\begin{tikzpicture}[xscale=1,scale=1.3]
\draw[->] (-3,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};

\draw[densely dotted] (0,1) -- ++(-2,0);

\draw[blue!50!cyan,->] (-2,1) ++(0.2,0) arc(0:300:0.2) node[below left,near end,scale=.7] (lb) {$\ang{-45}$};


\draw[dashed] (-2,1) -- (-2,-1);
\draw[dashed,gray] (-2,1) -- (0,1) node[right,scale=.8] {$1$};
\draw[dashed,gray] (-2,-1) -- (0,-1) node[right,scale=.8] {$-1$};

\draw[green!60!black] (-1.67,0) node[black,below,scale=.8] {$-1.63$} -- ++(50:3.3);
\draw[green!60!black] (-1.67,0) -- ++(-50:3.3);

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.2 with {\arrow{>}},%
	mark=at position 0.5 with {\arrow{>}},%
	mark=at position 0.85 with {\arrow{>}},%
}]
(-1,0) -- ++(-2,0)
plot [smooth] coordinates {(-2,1) (-1.5,0.8) (0.2,2.4)}
plot [smooth] coordinates {(-2,-1) (-1.5,-0.8) (0.2,-2.4)}
;


\draw (-1,0) node[locuspole=$-1$] {};
\draw (-2,1) node[locuspole,label={[above]90:$-2+j$}] {};
\draw (-2,-1) node[locuspole,label={[below]-90:$-2-j$}] {};
\end{tikzpicture}
	
	Παρατηρούμε πως όσο αυξάνουμε το \( k \), οι δύο επάνω πόλοι πηγαίνουν όλο και περισσότερο
	προς τα δεξιά, και κάποια στιγμή φτάνουν τον κατακόρυφο άξονα, οπότε έχουμε αστάθεια.
	
	Για να βρούμε τα σημεία τομής του γεωμετρικού τόπου με τον κατακόρυφο άξονα, μπορούμε επομένως
	να εφαρμόσουμε το κριτήριο Routh για τη χαρακτηριστική εξίσωση του συστήματος κλειστού
	βρόχου \(  s^3+5s^2+9s+5+k = 0 \):
	
	\[
	\begin{array}{r|cc}
	s^3&1&9\\
	s^2&5&5+k\\
	s^1&\frac{40-k}{5}&0\\
	s^0&5+k
	\end{array}
	\]
	Θέλουμε \( k>-5 \) και \( 40-k>0 \), άρα τελικά \( \underline{k<40} \).
	
	Για να βρούμε τα σημεία τομής, θεωρούμε τη \textbf{βοηθητική εξίσωση του κριτηρίου Routh
		αμέσως επάνω από την πρώτη αλλαγή προσήμου}, δηλαδή στο \( s^2 \):
	\[
	5s^2+5+k = 0 \xRightarrow{k=40} \underline{s= \pm j3}
	\]
	
	Άρα τα σημεία τομής των ασυμπτώτων με τον φανταστικό άξονα είναι τα \( s=\pm 3 \).
	\todo{Graph 121(optional)}

	\hspace{0pt}
\end{exercise}


\begin{exercise}
Έστω το σύστημα:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (1.2,0) node[transfer] (h0) {$k$};
\draw (3,0) node[transfer] (h1) {$\displaystyle \frac{s+5}{s(s+a)}$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h0);
\draw[->] (h0) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1.2) -| (mix.south) node[below right] {$-$};
\draw (mix.south);
\end{tikzpicture}

Να σχεδιαστεί ο γεωμετρικός τόπος ριζών ως προς το \( a \), για \( k=2 \).

\begin{enumgreekpar}
	\item Για ποιά τιμή του \( a \) το σύστημα γίνεται ασταθές;
	\item Για ποιά τιμή του \( a \) έχει πραγματικές ρίζες η χαρακτηριστική εξίσωση;
\end{enumgreekpar}

\tcblower
Η συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:
\[
k\frac{s+5}{s(s+a)}
\]
και η συνάρτηση μεταφοράς κλειστού βρόχου:
\[
\frac{k\frac{s+5}{s(s+a)}}{1+k\frac{s+5}{s(s+a)}}
= \frac{k(s+5)}{\underbrace{s(s+a)+k(s+5)}_{\mathclap{\text{Χαρακτηριστική Εξίσωση}}}}
\]

Πρέπει να φέρουμε την χαρακτηριστική εξίσωση \( s(s+a)+k(s+5) = 0 \) στη μορφή \( 1+aL(s)=0 \).

Έχουμε:
\begin{align*}
	 s(s+a)+k(s+5) &= 0 \implies \\
	 s^2+ks+5k &= -as \implies \\
	 1+a\frac{s}{s^2+ks+5k} &=0
\end{align*}
με \( L(s) = \frac{s}{s^2+ks+5k} \) ή, για \( k=2 \):
\[ L(s) = \frac{s}{s^2+2s+10} \]

Το σύστημα ανοιχτού βρόχου έχει πόλους στα \( -1\pm 3j \), και ένα μηδενικό στο 0. Επομένως
έχουμε δύο κλάδους που ξεκινούν από τους πόλους.

Έχουμε μία ασύμπτωτη, για την οποία δεν χρειάζεται να βρούμε το κέντρο και τη γωνία, επειδή
γνωρίζουμε πως είναι αυτή που αντιστοιχεί στον οριζόντιο άξονα. Επειδή η ημιευθεία
των αρνητικών πραγματικών αριθμών ανήκει στο γεωμετρικό τόπο (αφού έχει ένα μηδενικό στα δεξιά), είναι και η μοναδική ασύμπτωτη.

Για να βρούμε τα σημεία απόσχισης (\textbf{σημεία θλάσης}) μπορούμε να λύσουμε μία
από τις ισοδύναμες εξισώσεις:
\[
\od{a}{s}=0 \iff \od{L(s)}{s}=0
\]
Εδώ έχουμε \( 1+aL(s) = 0 \) άρα:
\[
-a(s)=\frac{s^2+2s+10}{s}
\]
επομένως:
\begin{align*}
	\frac{s(2s+2)-(s^2+2s+10)}{s^2} &= 0 \iff \\
	2s^2+2s-s^2-2s-10 &= 0 \iff \\
	s^2-10 &= 0 \iff s=\pm 3.16 \implies \underline{s=-3.16}
	\text{ (για να ανήκει στο γεωμ. τόπο)}
\end{align*}

Επιπλέον πρέπει να βρούμε τις γωνίες αναχώρησης για τους πόλους:
\begin{align*}
	\phi &= \ang{180}
	+ \measuredangle (-1+3j) - \measuredangle\left((-1+3j)+1+3j\right)
	- \measuredangle 0
	\\ &= \ang{180} + \underbrace{\atand(3,-1)}_{\ang{180}-\ang{71.56}} - \underbrace{\atand(3,0)}_{\ang{90}}
	\\ &= \ang{-161.56}
\end{align*}

\begin{tikzpicture}[xscale=.8,scale=1.3,yscale=1.2]
\draw[->] (-4,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-1.5) -- (0,1.5) node[left] {$\Im$};

\draw[densely dotted] (0,1) -- ++(-2,0);

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.2 with {\arrow{<}},%
	mark=at position 0.4 with {\arrow{>}},%
	mark=at position 0.6 with {\arrow{>}},%
	mark=at position 0.85 with {\arrow{<}},%
}]
(0,0) -- ++(-4,0)
plot [smooth] coordinates {(-1,1) (-3.16,0) (-1,-1)}
;
\draw[blue!50!cyan,->] (-1,1) ++(0.4,0) to[bend right=80] node[above,midway] (lb) {$\ang{-161.56}$} ++(-0.7,-0.09);

\draw (0,0) node[locuszero] {};
\draw (-1,1) node[locuspole,label={[below,yshift=-3mm,scale=.9]90:$-1+3j$}] {};
\draw (-1,-1) node[locuspole,label={[below,scale=.9]-90:$-1-3j$}] {};
\draw (-3.16,0) node[locusbreak=$-3.16$] {};
\end{tikzpicture}

Απ' ό,τι παρατηρούμε από το γεωμετρικό τόπο, δεν έχουμε αστάθεια για κανένα \( a \).

Η χαρακτηριστική εξίσωση θα έχει διπλή πραγματική ρίζα στο σημείο -3.16, όπου οι πόλοι
του συστήματος κλειστού βρόχου συναντώνται.

\todo{What is the value of a?}

\end{exercise}

\begin{exercise}
Δίνεται ένα σύστημα με συνάρτηση μεταφοράς ανοιχτού βρόχου (μετά από ένα κέρδος \( k \)) και
μοναδιαία αρνητική ανάδραση:

\begin{align*}
	H_p(s) &= \frac{s+\frac{1}{b}}{s(s+10)}\\
	b &= 0.05
\end{align*}

Να βρεθεί το περιθώριο κέρδους, αφού σχεδιαστεί ο γεωμετρικός τόπος ριζών.

\tcblower

Αφού έχουμε δύο πόλους, ο γεωμετρικός τόπος έχει δύο κλάδους. Θα έχουμε 1 ασύμπτωτη (αφού
υπάρχουν 2 πόλοι και 1 μηδενικό), άρα δεν χρειάζεται να υπολογίσουμε γωνίες και κέντρο
ασυμπτώτων (αφού η γωνία γνωρίζουμε ότι είναι στις \( \ang{180} \)), δηλαδή αντιστοιχεί
με τον οριζόντιο άξονα. Το ένα μηδενικό στη θέση \( -\frac{1}{b} \) προκύπτει από
τη συνάρτηση μεταφοράς κλειστού βρόχου \( H_c = \frac{kH_s}{1+1\cdot kH_s} = \frac{k\left(s+\frac{1}{b}\right)}{s(s+10)+k\left(s+\frac{1}{b}\right)} \).

Για να βρούμε το σημείο θλάσης, λύνουμε τη \textit{χαρακτηριστική εξίσωση}:
\[
1 + kL(s) = 0
\]
όπου \( L(s) = \displaystyle \frac{s+\frac{1}{b}}{s(s+10)} \), και λύνουμε την
εξίσωση \( \od{k}{s} = 0 \):
\begin{align*}
	\od{k}{s} &= 0 \iff \\
	\iff \frac{s(s+10)-\left(s+\frac{1}{b}\right)(2s+10)}{\dots} &= 0
	\implies \begin{cases}
	s_1 &= -5.857 \\
	s_2 &= -34.1421
	\end{cases}
\end{align*}

Και οι δύο τιμές ανήκουν στο γεωμετρικό τόπο.

\begin{tikzpicture}[xscale=1,scale=1.3]
\draw[->] (-4,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\draw[locus,yscale=.8,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.15 with {\arrow{<}},%
	mark=at position 0.25 with {\arrow{>}},%
	mark=at position 0.45 with {\arrow{>}},%
	mark=at position 0.82 with {\arrow{<}},%
}]
(0,0) -- ++(-1,0)
(-2,0) -- ++(-2,0)
(-2,0) circle (1.5cm)
;


\draw (0,0) node[locuspole] {};
\draw (-1,0) node[locuspole=$-10$] {};
\draw (-2,0) node[locuszero=$-20$] {};
\draw (-3.5,0) node[locusbreak=$-34.14$] {};
\draw (-0.5,0) node[locusbreak,label={[above]90:$-5.85$}] {};
\end{tikzpicture}

Το περιθώριο κέρδους είναι \( \infty \), αφού δεν έχουμε καμιά τιμή δεξιά του φανταστικού άξονα. Για να βρούμε συγκεκριμένες τιμές του \( k \) ή των πόλων, μπορούμε να λύσουμε την
εξίσωση \( 1+kL(s) = 0 \).

\end{exercise}

\begin{exercise}
Να σχεδιαστεί ο γεωμετρικός τόπος ριζών και το σφάλμα μόνιμης κατάστασης του συστήματος:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (1.2,0) node[transfer] (h0) {$k$};
\draw (3,0) node[transfer] (h1) {$\displaystyle \frac{1}{s(s+5)}$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(-1,-1) node[transfer] (h2) {$\displaystyle \frac{s+1}{s}$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h0);
\draw[->] (h0) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix.south) node[below right] {$-$};
\draw (mix.south);
\end{tikzpicture}

\tcblower
Η συνάρτηση μεταφοράς \textit{ανοιχτού βρόχου} είναι:
\[
A(s) = \frac{k(s+1)}{s^2(s+5)}
\]
όπως προκύπτει από τον πολλαπλασιασμό των δύο συναρτήσεων μεταφοράς.

Έχουμε έναν διπλό και έναν μονό πόλο, καθώς και ένα μηδενικό, επομένως 2 ασυμπτώτους,
με γωνίες \( \theta_\rho = \frac{2\rho + 1}{\#\text{Ασύμπτ.}} = \ang{90} \text{ και }
\ang{270} \), όπου \( \rho = 0,1 \).

Για να βρούμε το σημείο θλάσης, θεωρούμε τη χαρακτηριστική εξίσωση \( 
\frac{k(s+1)}{s^2(s+5)} + 1 =0
 \), και λύνουμε την:
\begin{gather*}
	\od{k}{s} =0 \implies \\ \implies
	\frac{(s+1)'\left( s^2(s+5) \right)-\left(s^2(s+5)\right)'(s+1)}{\text{παρονομαστής}}
	= 0 \implies \\ \implies s = 0
\end{gather*}

Το κέντρο \( ξ \) των ασυμπτώτων το βρίσκουμε ως εξής:
\begin{align*}
	ξ &= \frac{\sum p - \sum z}{\text{Αρ. Ασ.}} \qquad \hfill \text{όπου }
	\begin{cases}
	\sum r &\quad \text{το άθροισμα των πόλων}\\
	\sum z &\quad \text{το άθροισμα των μηδενικών}\\
	\text{Αρ. Ασ.} &\quad \text{ο αριθμός των ασυμπτώτων}
	\end{cases}
	\\
	&= \frac{-5-(-1)}{2} = -2
\end{align*}

\begin{tikzpicture}[xscale=1,scale=1.3]
\draw[->] (-4,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\draw[green!50!black] (-1,2.2) -- (-1,-2.2);

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.15 with {\arrow{>}},%
	mark=at position 0.45 with {\arrow{<}},%
	mark=at position 0.82 with {\arrow{>}},%
}]
(-2.5,0) -- (-0.5,0)
plot [smooth,tension=.6]
coordinates {(-0.93,2) (-0.8,1) (0,0) (-0.8,-1) (-0.93,-2)}
;


\draw (0,0) node[locuspole] {};
\draw (0,0) node[locuspole,xshift=2pt] {};
\draw (-0.5,0) node[locuszero=$-1$] {};
\draw (-1,0) node[below,scale=.8] {$-2$};
\draw (-2.5,0) node[locuspole=$-5$] {};
\end{tikzpicture}

\end{exercise}

\begin{exercise}[Προηγούμενο Θέμα Εξετάσεων]
Δίνεται το σύστημα κλειστού βρόχου που φαίνεται στο σχήμα:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (2,0) node[transfer] (h1) {$\displaystyle \frac{2(s+8)}{(s+4)(s+6)}$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle H_c(s)$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix);
\draw (mix.south) node[below right] {$-$};
\end{tikzpicture}

\begin{enumgreekparen}
	\item 
	Για \( H_c(s) = k \),	
	σχεδιάστε προσεγγιστικά τον τόπο ριζών και δώστε μια εκτίμηση για το χρόνο αποκατάστασης
	\( t_s \) του \textit{κλειστού βρόχου} για πολύ μεγάλα κέρδη (\( k\to \infty \)).
	\item
	Θεωρούμε τον ελεγκτή:
	\[
	H_c(s) = k(s+a)
	\]
	
	Προσδιορίστε το \( a \) και τοποθετήστε τους πόλους έτσι ώστε να εξασφαλίσετε ότι ο
	χρόνος αποκατάστασης θα είναι \( t_s < \SI{0.5}{\second} \).
\end{enumgreekparen}

\tcblower
\begin{enumgreekparen}
	\item Η συνάρτηση μεταφοράς του ανοιχτού βρόχου είναι:
	\[
	A(s) = \frac{2k(s+8)}{(s+4)(s+6)}
	\]
	
	Έχουμε 2 πόλους, 1 μηδενικό, και 1 ασύμπτωτη ευθεία με γωνία \( \ang{180} \). Για το
	σημείο θλάσης έχουμε:
	\begin{gather*}
		\od{k}{s} = \od{\left[ -\frac{(s+4)(s+6)}{2(s+8)} \right]}{s} = 0
		\\ \implies \dots \implies \\
		\implies s^2+16s+36 = 0 \implies \begin{cases}
		s_a &= -5.17 \\
		s_b &= -10.83
		\end{cases}
	\end{gather*}
	
	\begin{tikzpicture}[xscale=1.3,scale=1.3]
	\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
	\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};
	
	\draw[locus,yscale=1.5,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.03 with {\arrow{>}},%
		mark=at position 0.07 with {\arrow{<}},%
		mark=at position 0.15 with {\arrow{<}},%
		mark=at position 0.25 with {\arrow{>}},%
		mark=at position 0.45 with {\arrow{>}},%
		mark=at position 0.82 with {\arrow{<}},%
	}]
	(-1.5,0) -- (-1,0)
	(-2,0) -- ++(-1,0)
	(-1.875,0) circle (0.625cm)
	;
	
	
	\draw (-1,0) node[locuspole=$-4$] {};
	\draw (-1.5,0) node[locuspole=$-6$] {};
	\draw (-2,0) node[locuszero=$-8$] {};
	\draw (-1.25,0) node[locusbreak,label={[above,scale=.8]90:$-5.17$}] {};
	\draw (-2.5,0) node[locusbreak,label={[above,scale=.8]90:$-10.82$}] {};
	\end{tikzpicture}
	
	Για να βρούμε το χρόνο αποκατάστασης, πρώτα βρίσκουμε τη συνάρτηση μεταφοράς κλειστού
	βρόχου \( G \):
	\begin{align*}
		G &= \frac{\frac{2(s+8)}{(s+4)(s+6)}}{1+k\frac{2(s+8)}{(s+4)(s+6)}}
		\\ &= \frac{2(s+8)}{(s+4)(s+6)+2k(s+8)}
	\end{align*}
	
	Παρατηρούμε ότι στον κλειστό βρόχο συνεχίζει να υπάρχει το μηδενικό \( (s+8) \).
	Καθώς αυξάνουμε το \( k \), ο ένας από τους πόλους τείνει στο \( -8 \), δηλαδή θα είναι
	\( -8+Δp \), άρα θα είναι πολύ κοντά στο \( (s+8) \), άρα το μηδενικό και ο πόλος
	αλληλοαναιρούνται. Επομένως μένει ο πόλος που τείνει στο \( -\infty \), ο οποίος
	αντιστοιχεί σε χρόνο αποκατάστασης που τείνει στο 0 (το προς τα πού τείνουν να βρεθούν
	οι πόλοι φαίνεται από τα βελάκια στο διάγραμμα).
	
	\item Η νέα συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:
	\[
	A(s) = \frac{k2(s+8)(s+a)}{(s+4)(s+6)}
	\]
	
	Αν οι πόλοι είναι της μορφής \( -σ \pm j\omega_d \), τότε θέλουμε \( t_s = \frac{4}{σ}
	< \SI{0.5}{\second} \implies σ > 8 \), δηλαδή θέλουμε να θέσουμε το \( k \) έτσι
	ώστε κάποιοι πόλοι να βρίσκονται αριστερά από το \( -8 \).
	
	\begin{itemize}
		\item Έστω ότι βάζουμε ένα μηδενικό μεταξύ του \( -4 \) και \( 0 \).
		\todo{Graph 129}
		
		Τότε ο γεωμετρικός τόπος δεν θα πηγαίνει αριστερά από το \( -8 \), επομένως δεν
		θα έχουμε τον επιθημητό χρόνο αποκατάστασης.
		
		\item Έστω ότι βάζουμε ένα μηδενικό μεταξύ του \( -6 \) και \( -4 \).
		
		Με την ίδια λογική με παραπάνω, δεν μπορούμε να βάλουμε το μηδενικό εκεί.
		
		\item Έστω ότι βάζουμε ένα μηδενικό μεταξύ του \( -8 \) και \( -6 \).
		
		Με την ίδια λογική με παραπάνω, δεν μπορούμε να βάλουμε το μηδενικό εκεί.
		
		\item Άρα μπορούμε να βάλουμε το μηδενικό μόνο \textit{αριστερά} από το \( -8 \).
	\end{itemize}
	
	Αν για παράδειγμα θέσουμε \( a = 10 \), τότε:
	
	\begin{tikzpicture}[xscale=1.3,scale=1.3]
	\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
	\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.04 with {\arrow{>}},%
		mark=at position 0.08 with {\arrow{<}},%
		mark=at position 0.14 with {\arrow{<}},%
		mark=at position 0.19 with {\arrow{>}},%
		mark=at position 0.30 with {\arrow{<}},%
		mark=at position 0.60 with {\arrow{>}},%
	}]
	(-1.5,0) -- (-1,0)
	(-2.5,0) -- ++(0.5,0)
	plot[smooth cycle] coordinates {(-2.25,0) (-1.8,1)  (-1.25,0) (-1.8,-1)}
	;
	
	\draw (-1,0) node[locuspole=$-4$] {};
	\draw (-1.5,0) node[locuspole=$-6$] {};
	\draw (-2,0) node[locuszero=$-8$] {};
	\draw (-2.5,0) node[locuszero=$-10$] {};
	\draw (-1.25,0) node[locusbreak,label={[above,scale=.8]90:$-5.27$}] {};
	\draw (-2.25,0) node[locusbreak,label={[above,scale=.8]90:$-8.73$}] {};
	\end{tikzpicture}
	
	Για να βρούμε ακριβώς το \( k \), βρίσκουμε τα σημεία θλάσης:
	\begin{align*}
		\od{k}{s} &= 8s^2 +112s+368 = 0 \implies \\
		s &= -5.267 \text{ ή } = - 8.73
	\end{align*}
	
	Άρα, για το συγκεκριμένο \( a \), ισχύει \( k > k_a \), όπου:
	\[
	k_a = -\left.\frac{(s+4)(s+6)}{2(s+8)(s+10)}\right|_{s=-8.73} = 6.96
	\]
\end{enumgreekparen}

\hspace{0pt}
\end{exercise}

\subsection{Ευαισθησία σε θόρυβο}
Έστω ένα σύστημα με είσοδο θορύβου \( n \) και είσοδο διαταραχής \( d \):

\begin{tikzpicture}[scale=1.2]
\tikzstyle{transfer}=[rectangle,draw,minimum width=32pt]
\draw (2,0) node[transfer] (h1) {$\displaystyle A(s)$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (4,0) node[circle,draw,minimum size=5mm] (d) {};

\draw[<-] (mix) -- ++(-1,0) node[left] {$r$};
\draw[->] (mix) -- (h1);
\draw[->] (h1) -- (d);
\draw[->] (d) ++(0,1) node[right] {$d$} -- (d.north) node[above right] {$+$};
\draw[->] (d.east) -- +(1,0) node[midway] (fb) {} node[right] {$y$};
\draw[->] (fb.center) -- ++(0,-1)  -| (mix);
\draw (mix.south) node[below right] {$-$};
\draw[<-] (mix.north) node[above right] {$+$} -- ++(0,1) node[right] {$n$};
\end{tikzpicture}

Οι συναρτήσεις μεταφοράς για την είσοδο \( r \), την είσοδο θορύβου \( n \) και την
είσοδο διαταραχής \( d \) είναι:

\[ \boxed{\begin{aligned}
	H_{yr}(s) &= \frac{A(s)}{1+A(s)} \\
	H_{yn}(s) &= \frac{A(s)}{1+A(s)} \\
	H_{yd}(s) &= \frac{1}{1+A(s)}
	\end{aligned}}
\]

Αυτό που επιθυμούμε είναι να μειώσουμε όσο περισσότερο γίνεται την επίδραση των σημάτων
διαταραχής \( d \) και θορύβου \( n \). Για να το πραγματοποιήσουμε αυτό, μπορούμε να
λάβουμε υπ' όψιν ότι ο θόρυβος είναι σήμα υψηλών συχνοτήτων (π.χ \( \omega > 100 \)), ενώ
η διαταραχή είναι χαμηλών συχνοτήτων (π.χ. \( \omega < 1 \)). Επομένως θέλουμε για το κάθε
σήμα να αποκόψουμε αυτές τις συχνότητες, δηλαδή για παράδειγμα:
\begin{align*}
	\left|H_{yn}(j\omega )\right| &\quad \text{για } \omega > 100\\
	\left|H_{yd}(j\omega )\right| &\quad \text{για } \omega < 1
\end{align*}

\begin{exercise}[Παράδειγμα]
Δίνεται η συνάρτηση μεταφοράς ανοιχτού βρόχου του παραπάνω συστήματος:
\[
A(s) = \frac{10k(s+3)}{(s+5)(s+10)}
\]

Να προσδιοριστεί η σταθερά \( k \) ώστε να έχουμε απόρριψη διαταραχών 
\( \SI{20}{\decibel} \) για \( \omega \leq \SI{1}{\radian/\second} \), δηλαδή
\[ \left|H_{yd}(j\omega)\right| \leq \SI{-20}{\decibel} \]

Να βρεθούν τα περιθώρια φάσης και κέρδους.

\tcblower
Η συνάρτηση μεταφοράς της διαταραχής, όπως είδαμε παραπάνω, είναι:
\[
H_{yd}(s) = \frac{1}{1+A(s)}
\]
και θέλουμε για το μέτρο της:
\begin{align*}
	20\log\left|\frac{1}{1+A(j\omega )}\right| &\leq \cancelto{\log\left(\sfrac{1}{10} \right)}{-20} \\
	\left|\frac{1}{1+A(j\omega )}\right| &\leq \frac{1}{10} \\
	\Aboxed{\left| 1+A(j\omega ) \right| &\geq 10}
\end{align*}
για \( \omega \leq 1 \).

Προσεγγιστικά, θεωρούμε ότι η παραπάνω σχέση μπορεί να γίνει:
\[
\left| A(j\omega ) \right|_{\omega \leq 1} \geq 10
\]
και αν αντικαταστήσουμε την \( A \) για \( s=j\omega \):
\[
\left|\frac{30k\left(1+\sfrac{j\omega }{3} \right)}{50\left(1+\frac{j\omega }{5}\right)\left( 1+\frac{j\omega }{10} \right)}\right|
\]

Αν αγνοήσουμε τους όρους της μορφής \( \left( 1+\frac{j\omega }{p} \right) \) (αφού πριν
από τη χαρακτηριστική τους συχνότητα προσεγγιστικά έχουν κέρδος \( \SI{0}{\decibel} \)
ή \( 1 \)), θα έχουμε μια τιμή \( k \approx 16 \).

Αναπτύσσοντας την παραπάνω σχέση, λύνουμε την εξίσωση για να βρούμε ακριβώς την τιμή
του \( k \):
\begin{align*}
	&\hphantom{=}\left|\frac{(10k+15)j+(49+30k)}{49+15j}\right|
	\\ &= \frac{10^2+50^2}{15^2+49^2}k^2 + \frac{(60\cdot 19 + 20\cdot 15)}{15^2+49^2}k - 99
	\\ &= 0.3808k^2 + 1.2338k + 99 = 0
	\\ &\implies \begin{cases}
	k &= 14.58 \\
	k &= -17.8 \quad \text{απορρίπτεται επειδή το $k$ πρέπει είναι θετικό}
	\end{cases}
\end{align*}

Επομένως για το επιθυμητό \( k \) ισχύει \( \underline{k \geq 14.58} \), κάτι αρκετά
κοντά στο προσεγγιστικό \( k \approx 16 \), το οποίο μάλιστα είναι εντός του σετ τιμών του
ακριβούς \( k \), αφού \( 16 \geq 14.58 \).

\tcbsubtitle{}
Η συνάρτηση μεταφοράς έχει τη μορφή:
\[
\frac{\frac{3}{5}k \left(1+\frac{j\omega }{3}\right)  }{\left( 1+\frac{j\omega }{5} \right)
	\left(1+\frac{j\omega }{10}\right)}
= \frac{8.75 \left(1+\frac{j\omega }{3}\right)  }{\left( 1+\frac{j\omega }{5} \right)
	\left(1+\frac{j\omega }{10}\right)}
\]

Το περιθώριο κέρδους είναι \( \infty \), αφού έχουμε δύο απλούς πόλους και ένα μηδενικό,
άρα στο \( \omega\to \infty \), η συνάρτηση μεταφοράς φάσης του συστήματος γίνεται
\( -\ang{90}-\ang{90}+\ang{90} = \ang{-90} \), και δεν φτάνει τις \( \ang{180} \).

Αν υπολογίσουμε την τιμή της συνάρτησης μεταφοράς ώστε να έχει μέτρο 1, θα βρούμε ότι
\( \underline{\omega_c = 145.8} \), και επομένως το περιθώριο φάσης είναι:
\[
\phi_M = \left. 180 + \measuredangle \underbrace{A(j\omega_c)}_{-85.5}
\right|_{\omega_c=145.3} = 94.5
\]

\end{exercise}

\begin{exercise}[Παλιό θέμα εξετάσεων]
Δίνεται το ελεγχόμενο σύστημα:
\[
H_p(s) = \frac{6(s+6)}{(s+3)(s+9)}
\]

Να σχεδιαστεί σύστημα ελέγχου κλειστού βρόχου με μοναδιαία αρνητική ανάδραση έτσι ώστε
να έχουμε:
\begin{itemize}
	\item Σφάλμα θέσης \( e_{\mathrm{ss}} < 0.1 \)
	\item Περιθώριο φάσης \( \theta_m \geq \ang{60} \)
	\item Απόρριψη θορύβου για \( \omega = \SI{150}{\radian/\second} \) τέτοια ώστε
	\( \left|H_{yn}(j\omega )\right| < 0.5 \)
\end{itemize}

Επίσης να σχεδιαστεί ένα πρόχειρο διάγραμμα Bode της συνάρτησης μεταφοράς ανοιχτού βρόχου.
(δηλαδή χωρίς να βρίσκουμε την τιμή του κάθε σημείου).

\tcblower
Η συνάρτηση είναι τύπου 0, επομένως έχει πεπερασμένο σφάλμα θέσης.

Εισάγουμε έναν \textit{proportional} ελεγκτή \( \underline{H_c = k} \) πριν από
την \( H_p \) έτσι ώστε να προσθέσουμε μια παράμετρο που να μεταβάλλεται. Επομένως τελικά
η συνάρτηση μεταφοράς είναι:
\[
A(s) = H_cH_p = \frac{k\cdot 6(s+6)}{(s+3)(s+9)}
\]

Για το σφάλμα θέσης, από τη θεωρία θυμόμαστε ότι ισχύει:
\begin{align*}
	e_{\mathrm{ss}} &= \frac{1}{1+\left.k\frac{6(s+6)}{(s+3)(s+9)}\right|_{s=0}} < 0.1
	\\ \implies \cdots &\implies k > 6.75
\end{align*}

Για να υπολογίσουμε το περιθώριο φάσης, πρώτα φέρνουμε τη συνάρτηση μεταφοράς στη μορφή:
\[
\frac{6^2\left( \frac{s}{6} + 1 \right)}{9\cdot 3 \left( \frac{s}{3}+1 \right)\left(
	\frac{s}{9}+1
	\right)}
\]
και σχεδιάζουμε ένα πρόχειρο διάγραμμα Bode:

\begin{tikzpicture}[scale=1,xscale=2]
\pgfplotsset{
	/pgf/number format/freq/.style={fixed},
}
\def\phasedown{-4}
\def\phaseextra{-3}

\draw (-1,1) node[orange!90!blue!80!black] {$\displaystyle \left|H_p\cdot H_c\right|_{\si{\decibel}}$};

\draw[->] (0,\phasedown+\phaseextra) -- (0,3);
\draw[->] (0,0) -- (4.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {2,2.3010,2.4771} {
	\draw[densely dotted] (\x,\phasedown) -- (\x,0);
}

\def\at{60}
\draw[ultra thick,orange!90!blue!80!black]
(0,2.5)
-- ++(2,0) node (c1) {}
-- ++(-1*\at:{0.3010/cos(1*\at)}) node(c2) {} node[above right] {-20 dB/dec}
-- ++(0.4771-0.3010,0) node (c3) {}
-- ++(-1*\at:{1.5/cos(1*\at)}) node(c4) {} node[above right] {-20 dB/dec}
;

\foreach \p in {c1,c2,c3} {
	\draw[densely dashed] (\p.center) -- (\p.center |- 0,0);
}

\draw (0,2.5) node[left] {$20\log\left(\kappa\cdot\frac{36}{27}\right)$};


\foreach \x in {2,2.3010,2.4771} {
	\pgfmathsetmacro\result{3*10^\x/100}
	\draw (\x,-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {1,1.4771,2,2.3010,2.4771,3,3.301030,3.47715} {
	\pgfmathsetmacro\result{3*10^\x/100}
	\draw (\x,\phasedown-0.1) node[below,fill=white,fill opacity=.8,text opacity=1,scale=.75] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\draw (1.3010,\phasedown-0.1) node[below,scale=.75] {$0.6$} -- ++(0,0.2);

\begin{scope}[yshift=\phasedown cm]
\draw (-1,-1) node[magenta,left] {$\phi$};
\draw[->] (0,0) -- ++(4.5,0);
\def\at{60}

\draw[ultra thick,magenta]
(0,1.5) -- ++(1,0) node(c1) {}
-- ++(-1*\at:{0.3010/cos(1*\at)}) node(c2) {} node[above right,scale=.9] {$-\ang{45}$/dec}
-- ++(0.4771-0.3010,0) node(c3) {}
-- ++(-1*\at:{(1-0.4771+1)/cos(1*\at)}) node(c4) {} node[pos=.6,below left] {$-\ang{45}$/dec}
-- ++(0.3010,0) node(c5) {}
-- ++(-1*\at:{(0.4771-0.3010)/cos(1*\at)}) node(c6) {} node[pos=.6,below left] {$-\ang{45}$/dec}
-- ++(0.7,0)
;

\foreach \p in {c1,c2,c3,c4,c5,c6} {
	\draw[dashed,gray] (\p.center) -- (\p.center |- 0,0);
}

\draw (c1 -| 0,0) node[left] {$\ang{0}$};
\draw[dashed] (c6) -- (c6 -| 0,0) node[left] {$\ang{-90}$};
\end{scope}

\end{tikzpicture}

Το διάγραμμα φάσης παίρνει τιμές μόνο μεγαλύτερες από \( \ang{-90} \). Αφού όμως το
περιθώριο φάσης είναι \( \ang{180} + \measuredangle A \), ισχύει:
\begin{align*}
	\measuredangle A &> \ang{-90} \\
	\ang{180} + \measuredangle A &> \ang{180} - \ang{90} \\
	\Aboxed{\theta_m &> \ang{90}}
\end{align*}
δηλαδή η δεύτερη συνθήκη ήδη ικανοποιείται.

Για την απόρριψη θορύβου, έχουμε:
\begin{align*}
	\left|H_{yn}(j\omega )\right| &< 0.5 \\
	\left|H_{yn}\right| = \frac{|A|}{|1+A|} &< 0.5
\end{align*}

Αφού η τιμή \( |1+A| \) είναι πολύ μεγαλύτερη από το \( |A| \), το \( |Α| \) είναι πολύ
μικρότερο του 1, και ο παρονομαστής προσεγγίζεται από το 1. Επομένως, προσεγγιστικά θα
έχουμε:
\[
\left|A(j\omega )\right|_{\omega =150} < 0.5
\]

Άρα, αν θέσουμε \( \omega = \SI{150}{\radian/\second} \), θα πάρουμε:
\begin{gather*}
	\left|A(j\omega )\right|_{\omega=\SI{150}{\radian/\second}}
	= \frac{6k\cdot 150}{150\cdot 150} < 0.5 \implies \underline{k < 12.5}
\end{gather*}

Επομένως τελικά ο περιορισμός για το \( k \) είναι \( 6.75 < k < 12.5 \).

\end{exercise}
\begin{exercise}
Δίνεται η συνάρτηση:
\[
A(s) = \frac{k(s+6)}{(s+3)(s+8)(s^2+4s+8)}
\]

Να σχεδιαστεί ο γεωμετρικός τόπος ριζών με μοναδιαία αρνητική ανάδραση.

Υπάρχει περιθώριο τιμών του \( k \) για το οποίο το σύστημα είναι ασταθές; Αν ναι, και επιθυμούμε το σύστημα να είναι ευσταθές για κάθε \( k \), πρέπει να προσθέσουμε πόλο ή
μηδενικό; Επιλέξτε και σχεδιάστε ξανά το γεωμετρικό τόπο ριζών σε αυτήν την περίπτωση.

\tcblower

Η \( s^4+4s+8 \) έχει ρίζες \( -2 \pm 2j\).

Έχουμε 4 πόλους, άρα 4 κλάδους, και 1 μηδενικό, άρα 3 ασύμπτωτες.
\begin{align*}
	\text{Αρ. Ασ. } &=\text{Αρ. Π. } - \text{ Αρ. Μ} = 3
\end{align*}

Μετρώντας περιττό ή άρτιο αριθμό πόλων και μηδενικών, βλέπουμε ότι από τον οριζόντιο άξονα
στο γεωμετρικό τόπο ανήκουν τα σημεία \( (-\infty,-8) \) και \( (-6,-3) \).

Από την εμπειρία μας (ή από τον τύπο \( \frac{2ρ+1}{\text{Αρ.Ασ.}}\cdot\ang{180} \)) γνωρίζουμε ότι οι γωνίες των ασυμπτώτων είναι:
\begin{align*}
	\theta_0 &= +\ang{60}\\
	\theta_1 &= -\ang{60}\\
	\theta_2 &= \ang{180}
\end{align*}

Το κέντρο των ασυμπτώτων είναι στο σημείο με τετμημένη:
\[
\frac{\sum ρ - \sum z}{\text{Αρ. Ασ.}}
= \frac{-4-8\,-3+6}{3} = -3
\]

\begin{tikzpicture}[xscale=1,scale=1.7]
\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};

\draw[green!50!black] (-0.6,0) -- ++(30:2);
\draw[green!50!black] (-0.6,0) -- ++(-30:2);

\draw[gray,dashed] (-0.0,0.7) node[right] {$j2$} -| (-0.4,-0.7) -- ++(0.4,0) node[right] {$-j2$};

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.1 with {\arrow{>}},%
	mark=at position 0.3 with {\arrow{>}},%
	mark=at position 0.6 with {\arrow{>}},%
	mark=at position 0.9 with {\arrow{>}},%
}]
(-2,0) -- ++(-1,0)
(-0.6,0) -- (-1.5,0)
plot[smooth] coordinates {(-0.4,0.7) (-0.1,0.4) (1,1)}
plot[smooth] coordinates {(-0.4,-0.7) (-0.1,-0.4) (1,-1)}
;

\draw (-0.6,0) node[locuspole=$-3$] {};
\draw (-1.5,0) node[locuszero=$-6$] {};
\draw (-2,0) node[locuspole=$-8$] {};
\draw (-0.4,0.7) node[locuspole] {};
\draw (-0.4,-0.7) node[locuspole] {};
\end{tikzpicture}

Για μερικά \( k \) οι δύο κλάδοι στα δεξιά έχουν σημεία δεξιά του φανταστικού άξονα,
επομένως για αυτά το σύστημα είναι ασταθές. Για να μην ισχύει αυτό προσθέτουμε έναν πόλο ή μηδενικό.
\begin{itemize}
	\item Έστω ότι προσθέτουμε \textbf{πόλο}, π.χ. στη θέση \( p_1 = -7 \). Τότε έχουμε 4 ασυμπτώτους
	με γωνίες \( \pm \ang{45} \) και \( \ang{180} \pm \ang{45} \) και κέντρο
	\(\frac{-2-2-3+6-8-7}{4} = -4\).
	
	\begin{tikzpicture}[xscale=1,scale=1.7]
	\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
	\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};
	
	\def\ang{29}
	\def\dis{2}
	\draw[green!50!black] (-1.2,0) -- ++(\ang:\dis);
	\draw[green!50!black] (-1.2,0) -- ++(\ang:-\dis);
	\draw[green!50!black] (-1.2,0) -- ++(-\ang:\dis);
	\draw[green!50!black] (-1.2,0) -- ++(-\ang:-\dis);
	\draw[green!50!black] (-1.2,0) node[below,scale=.9] {$-4$};
	
	\draw[gray,dashed] (-0.0,0.9) node[right] {$j2$} -| (-0.4,-0.9) -- ++(0.4,0) node[right] {$-j2$};
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.035 with {\arrow{>}},%
		mark=at position 0.07 with {\arrow{<}},%		
		mark=at position 0.15 with {\arrow{>}},%
		mark=at position 0.30 with {\arrow{>}},%
		mark=at position 0.50 with {\arrow{>}},%
		mark=at position 0.70 with {\arrow{<}},%
		mark=at position 0.9 with {\arrow{>}},%
	}]
	(-2.3,0) -- (-1.75,0)
	(-0.6,0) -- (-1.5,0)
	plot[smooth] coordinates {(-0.4,0.9) (-0.1,0.7) (0.5,0.99)}
	plot[smooth] coordinates {(-0.4,-0.9) (-0.1,-0.7) (0.5,-0.99)}
	plot[smooth] coordinates {(-3,0.92) (-2,0) (-3,-0.92)}
	;
	
	\draw (-0.6,0) node[locuspole=$-3$] {};
	\draw (-1.5,0) node[locuszero=$-6$] {};
	\draw (-2.3,0) node[locuspole=$-8$] {};
	\draw (-1.75,0) node[locuspole,label={[above]0:$-7$}] {};
	\draw (-0.4,0.9) node[locuspole] {};
	\draw (-0.4,-0.9) node[locuspole] {};
	\end{tikzpicture}
	
	Το σημείο αναχώρησης των δύο αριστερών κλάδων μπορούμε να το βρούμε από τον αντίστοιχο
	τύπο, αλλά δεν θα χρειαστεί.
	
	Παρατηρούμε ότι η προσθήκη ενός πόλου (σε οποιοδήποτε σημείο) μάς δίνει 4 ασυμπτώτους,
	και ο γεωμετρικός τόπος θα συνεχίσει να έχει σημεία στο δεξί ημιεπίπεδο (\( \implies \)
	αστάθεια). Επομένως η προσθήκη πόλου δεν είναι κατάλληλη.
	
	\item Έστω ότι τοποθετούμε ένα \textbf{μηδενικό} στη θέση:
	\[
	z_1 = -a
	\]
	
	Τότε οι ασύμπτωτοι θα έχουν γωνία \( \pm \ang{90} \). Θέλουμε όμως να βρίσκονται
	αριστερά του φανταστικού άξονα (ώστε να έχουμε ευστάθεια), άρα το κέντρο τους
	να είναι αριστερά του 0, δηλαδή να είναι αρνητικό:
	\[
	\frac{-2-2-3+6-8+a}{2} \leq 0\implies \frac{-9+a}{2} \leq 0 \implies \underline{a \leq 9}
	\]
	
	Άρα κάθε μηδενικό \( z_1 \geq -9 \) ικανοποιεί την παραπάνω συνθήκη.
	
	\begin{itemize}
		\item Έστω ότι \( z_1 = -9 \).
		
		Τότε το κέντρο των ασυμπτώτων είναι
		\( \frac{-2-2-3+6-8+9}{2} = 0 \), δηλαδή οι ασύμπτωτες ταυτίζονται με
		τον φανταστικό άξονα:
		
		\begin{tikzpicture}[xscale=1,scale=1.4]
		\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
		\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};
		
		\draw[green!50!black,xshift=2pt] (0,-1) -- (0,1);
		
		\draw[gray,dashed] (-0.0,0.7) node[right] {$j2$} -| (-0.4,-0.7) -- ++(0.4,0) node[right] {$-j2$};
		
		\draw[locus,ultra thick,postaction={decorate},
		decoration={markings,
			mark=at position 0.07 with {\arrow{>}},%
			mark=at position 0.27 with {\arrow{>}},%
			mark=at position 0.6 with {\arrow{>}},%
			mark=at position 0.9 with {\arrow{>}},%
		}]
		(-2,0) -- ++(-0.4,0)
		(-0.6,0) -- (-1.5,0)
		plot[smooth,tension=.8] coordinates {(-0.4,0.7) (-0.1,0.4) (-0.03,1)}
		plot[smooth,tension=.8] coordinates {(-0.4,-0.7) (-0.1,-0.4) (-0.03,-1)}
		;
		
		\draw (-0.6,0) node[locuspole=$-3$] {};
		\draw (-1.5,0) node[locuszero=$-6$] {};
		\draw (-2,0) node[locuspole=$-8$] {};
		\draw (-2.4,0) node[locuszero=$-9$] {};
		\draw (-0.4,0.7) node[locuspole] {};
		\draw (-0.4,-0.7) node[locuspole] {};
		\end{tikzpicture}
		
		Τότε επιβεβαιώνουμε πως όντως το σύστημα είναι ευσταθές για κάθε κέρδος \( k \).
	\end{itemize}
	
	\subparagraph{}
	Αν μας ζητούνταν ο χρόνος αποκατάστασης να είναι μικρότερος από \( \SI{2}{\second} \),
	τότε θα θέλαμε:
	\[
	t_s = \frac{4}{σ} < 2
	\]
	δηλαδή \( σ > 2 \) (όπου \( p=-σ\pm j\omega_d \), δηλαδή \( σ \) είναι η απόλυτη τιμή
	του πραγματικού μέρους των μιγαδικών πόλων).
	
	Δηλαδή το κέντρο των ασυμπτώτων θα έπρεπε να είναι αριστερά του -2, έτσι ώστε να
	βεβαιωθούμε ότι ο γεωμετρικός τόπος θα είναι πιο δύσκολο να φύγει δεξιά της κατακόρυφης
	ευθείας στο -2:
	\[
	\frac{-4-8-3+6-z}{4-2} < -2 \implies -\frac{11}{2}-\frac{z_x}{2} < -2
	\implies z_x > -5.
	\]
	
	Έτσι, αν για παράδειγμα τοποθετήσουμε το μηδενικό του προηγούμενου ερωτήματος, αντί
	για τη -9, στη θέση:
	\[
	z_x = -2
	\]
	
	Ο γεωμετρικός τόπος ριζών θα γίνει:
	
	\begin{tikzpicture}[xscale=1,scale=1.4]
	\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
	\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};
	
	\def\ang{29}
	\def\dis{2}
	\draw[green!50!black] (-1.1,-1) -- (-1.1,1);
	\draw[green!50!black] (-1.1,0) node[below left,scale=.9] {$-3.5$};
	
	\draw[gray,dashed] (-0.0,0.5) node[right] {$j2$} -- ++(-0.6,0) (-0.6,-0.5) -- ++(0.6,0) node[right] {$-j2$};
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,	
		mark=at position 0.12 with {\arrow{>}},%
		mark=at position 0.30 with {\arrow{>}},%
		mark=at position 0.55 with {\arrow{>}},%
		mark=at position 0.85 with {\arrow{>}},%
	}]
	(-2.5,0) -- (-2,0)
	(-1,0) -- (-0.6,0)
	plot[smooth,tension=.7] coordinates {(-0.6,0.5) (-0.95,0.55) (-1.05,0.98)}
	plot[smooth,tension=.7] coordinates {(-0.6,-0.5) (-0.95,-0.55) (-1.05,-0.98)}
	;
	
	\draw (-0.6,0) node[locuszero=$-2$] {};
	\draw (-1,0) node[locuspole=$-3$] {};
	\draw (-2,0) node[locuszero=$-6$] {};
	\draw (-2.5,0) node[locuspole=$-8$] {};
	\draw (-0.6,0.5) node[locuspole] {};
	\draw (-0.6,-0.5) node[locuspole] {};
	\end{tikzpicture}
	
	Πράγματι, για μεγάλο κέρδος \( k \), ο πόλος που τείνει στο -2 εξουδετερώνεται από
	το μηδενικό εκεί, και παραμένουν οι δύο κυρίαρχοι πόλοι που απομακρύνονται από τον
	οριζόντιο άξονα, και τελικά ισχύει:
	\[
	t_s = \frac{4}{3.5} \simeq 1.14
	\]
	
	Να σημειωθεί βέβαια ότι το μηδενικό που προσθέσαμε στη συνάρτηση ανοιχτού βρόχου ισχύει
	και στην αντίστοιχη του κλειστού, όπως μπορούμε να επιβεβαιώσουμε δεδομένου ότι γνωρίζουμε
	πως υπάρχει μοναδιαία αρνητική ανάδραση.
\end{itemize}

\end{exercise}
\begin{exercise}
Σε ποιά περιοχή τιμών θα επιλέξουμε το \( a \) έτσι ώστε να εξασφαλίζεται ότι για μεγάλα
κέρδη στο σύστημα κλειστού βρόχου (με μοναδιαία αρνητική ανάδραση) θα έχουμε \( t_s <
\SI{0.5}{\second} \), αν η συνάρτηση μεταφοράς είναι:
\[
A(s) = \frac{k(s+a)}{s(s+4)}
\]

\tcblower
Αν το πραγματικό μέρος του κυρίαρχου πόλου είναι \( -σ \), τότε αυτό που θέλουμε είναι \( t_s = \frac{4}{σ} < 0.5
\implies \underline{σ > 8} \).

Άρα θέλουμε να ισχύει \( \underline{a \geq 8} \), και θεωρούμε εδώ ότι \( a=8 \).

Αν και δεν μας ζητείται, σχεδιάζουμε τον γεωμετρικό τόπο ριζών για να βοηθηθούμε στην
επίλυση:

\begin{tikzpicture}[xscale=1,scale=1.4]
\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};

\coordinate (p0) at (0,0);
\coordinate (p1) at (-1,0);
\coordinate (p2) at (-2,0);
\coordinate (p3) at (-3,0);

\fill[fill=magenta!70!green,path fading=west,opacity=.7]
(p2 |- current bounding box.north) rectangle (-3,-1 |- current bounding box.south);

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,	
	mark=at position 0.04 with {\arrow{<}},%
	mark=at position 0.10 with {\arrow{>}},%
	mark=at position 0.16 with {\arrow{>}},%
	mark=at position 0.21 with {\arrow{<}},%
	mark=at position 0.45 with {\arrow{>}},%
	mark=at position 0.83 with {\arrow{<}},%
}]
(p2) -- (current bounding box.west |- 0,0)
(p1) -- (p0)
(-1.5,0) circle (1cm)
;

\draw (p0) node[locuspole] {};
\draw (p1) node[locuspole=$-4$] {};
\draw (p2) node[locuszero=$-8$] {};
\draw (-2.5,0) node[locusbreak] {};
\draw (-0.5,0) node[locusbreak] {};
\end{tikzpicture}

Όντως, για μεγάλα \( k \) οι πόλοι του συστήματος κλειστού βρόχου βρίσκονται αριστερά από το
\( -8 \), και θα έχουμε σωστό χρόνο αποκατάστασης.

\end{exercise}
\begin{exercise}
Δίνεται ο ελεγκτής:
\[
G(s) = \frac{1}{s+2}
\]
σε σύστημα μοναδιαίας αρνητικής ανάδρασης.

Θέλουμε να ικανοποιούνται οι εξής προδιαγραφές:
\begin{itemize}
	\item \( e_{\mathrm{ss}} = 0 \) (σφάλμα σταθερής κατάστασης)
	\item \( t_s < \frac{1}{3} \) (χρόνος αποκατάστασης)
	\item \( M_p = 0 \) (υπερύψωση)
	\item \( g_m = \infty \) (περιθώριο κέρδους)
\end{itemize}

Να σχεδιαστεί ο ελεγκτής σειράς \( H_c \) που να πληροί τις παραπάνω προδιαγραφές.

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum size=9mm]
\draw (1.2,0) node[transfer] (h0) {$H_c$};
\draw (3,0) node[transfer] (h1) {$\displaystyle G(s)$};
\draw (0,0) node[mixer,scale=.7] (mix) {};

\draw[<-] (mix.west) -- ++(-1,0);
\draw[->] (mix.east) -- (h0);
\draw[->] (h0) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1.2) -| (mix.south) node[below right] {$-$};
\draw (mix.south);
\end{tikzpicture}

\tcblower
Αφού θέλουμε μηδενικό σφάλμα, χρειαζόμαστε έναν ολοκληρωτή, έναν πόλο στο 0. Για να μπορέσουμε
να ικανοποιήσουμε και το μικρό χρόνο αποκατάστασης, χρησιμοποιούμε έναν \textbf{ελεγκτή PI}
(μηδενικό + ολοκληρωτής):
\[
H_c = \frac{k_p(s+μ)}{s}
\]
όπου \( k_p \) και \( μ \) σταθερές που πρέπει να προσδιορίσουμε.

Τότε ο γεωμετρικός τόπος ριζών είναι:

\begin{tikzpicture}[xscale=1,scale=1.4]
\draw[->] (-3,0) -- (1,0) node[right] {$\Re$};
\draw[->] (0,-1) -- (0,1) node[left] {$\Im$};

\draw[locus,yscale=1.3,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.03 with {\arrow{>}},%
	mark=at position 0.08 with {\arrow{<}},%
	mark=at position 0.225 with {\arrow{>}},%
	mark=at position 0.245 with {\arrow[thick]{<}},%
	mark=at position 0.45 with {\arrow{>}},%
	mark=at position 0.82 with {\arrow{<}},%
}]
(-1.5,0) -- ++(-1.5,0)
(-0.5,0) -- (0,0)
(-1,0) circle (0.8cm)
;

\draw (0,0) node[locuspole] (p0) {};
\draw (-0.5,0) node[locuspole=$-2$] (p1) {};
\draw (-1.5,0) node[locuszero=$-\mu$] {};
\draw (-1.8,0) node[locusbreak,scale=.7] {};
\draw (-0.2,0) node[locusbreak,scale=.7] {};

\draw[<-,opacity=.6] (p0) to[bend left] ++(-45:0.6) node[below right,scale=.8,align=center] {πόλος\\από PI};
\draw[<-,opacity=.6] (p1) to[bend right] ++(180+45:0.6) node[below,scale=.7,align=center] {πόλος\\από $G(s)$};
\end{tikzpicture}

Παρατηρούμε ότι δεν έχουμε σημεία στα δεξιά, άρα το περιθώριο κέρδους είναι \( \infty \).
Για τις υπόλοιπες δύο προδιαγραφές, θα επιλέξουμε κατάλληλα τις σταθερές \( k \) και
\( μ \).

\begin{itemize}
	\item Για να έχουμε \( t_s < \frac{1}{3} \), θέλουμε για τον κυρίαρχο πόλο (του
	συστήματος κλειστού βρόχου) με πραγματικό
	μέρος \( -σ \) να ισχύει:
	\[
	\frac{4}{σ} < \frac{1}{3} \implies \underline{σ>12}
	\]
	
	Όμως, όπως παρατηρούμε από το γεωμετρικό τόπο που σχεδιάσαμε, ακολουθώντας τα βελάκια
	(δηλαδή για αυξανόμενο \( k \)), καταλήγουμε σε δύο πόλους στο σύστημα
	κλειστού βρόχου: \( -μ \) και \( -\infty \). Επειδή όμως θέλουμε ο κυρίαρχος πόλος
	\( -μ \) να έχει πραγματικό μέρος \( -σ < -12 \), τελικά ισχύει:
	\[
	-μ \leq -12
	\]
	(η ισότητα ισχύει επειδή το \( k \) είναι μεγάλο αλλά όχι άπειρο, επομένως δεν φτάνουμε
	στη συνθήκη \( σ = 12 \), αλλά \( σ>12 \)).
	
	Εδώ αυθαίρετα θεωρούμε ότι \( μ=12 \). 
	
	\item Το σύστημα μεταφοράς κλειστού βρόχου, αν έχει δύο μιγαδικούς πόλους,
	έχει συνάρτηση μεταφοράς:
	\[
	\frac{N}{s^2 + \underbrace{(2+k_p)}_{2ζ\omega_n} s + \underbrace{12k_p}_{\omega_n^2}}
	\]
	
	Για να μην έχουμε \textbf{υπερύψωση}, θα πρέπει \( ζ = 1 \) (ώστε να είναι πραγματικές
	οι ρίζες). Έχουμε:
	\[
		12k_p = \omega_n^2
		\implies \omega_n = \sqrt{12 k_p}
	\]
	και:
	\[
	2+k_p = 2ζ\omega_n
	\]
	άρα για το \( ζ \) ισχύει:
	\[
	ζ = \frac{2+k_p}{2\omega_n} = \frac{2+k_p}{2\sqrt{12k_p}}
	\]
	
	Για να είναι \( ζ>1 \), από την παραπάνω εξίσωση πρέπει:
	\[
	2+k_p > 2\sqrt{12k_p} \implies \underline{k_p^2-44k_p+4 > 0}
	\]
	
	Το παραπάνω πολυώνυμο έχει ρίζες \( k_{p_1} = 0.0911 \) και \( k_{p_2} = 43.909 \),
	επομένως η σχέση ισχύει για \( k < k_{p_1} \) και \( k > k_{p_2} \). (Μάλιστα, τα
	\( k_{p_1} \) και \( k_{p_2} \) είναι οι τιμές όπου \( ζ=1 \), δηλαδή έχουμε \textit{διπλή} πραγματική ρίζα, άρα αντιστοιχούν στα \textit{σημεία θλάσης} του
	γεωμετρικού τόπου ριζών).
	
	\textbf{Εναλλακτικά}, μπορούσαμε να βρούμε τη \textbf{διακρίνουσα} του πολυωνύμου
	του παρονομαστή, και να φροντίσουμε ώστε αυτό να έχει πραγματικές ρίζες (\( Δ\geq0 \)),
	\textit{ή} να βρούμε τα \textbf{σημεία θλάσης} του γεωμετρικού τόπου ριζών από τον
	τύπο \( \od{H(s)}{s} \).
	
	Έτσι, \textbf{επιλέγουμε} \( \underline{k_p = 50} \) για να ικανοποιήσουμε την 4\textsuperscript{η} προδιαγραφή.
\end{itemize}

\hspace{0pt}
\end{exercise}

\begin{exercise}[Παλιό θέμα (2 Ιουνίου 2013)]
Δίνεται το σύστημα:
\[
H_p(s) = \frac{9}{(s+4)(s+6)}
\]

Να σχεδιαστεί σύστημα κλειστού βρόχου με μοναδιαία αρνητική ανάδραση που να πληροί τις προδιαγραφές:
\begin{enumerate}
	\item \( e_{\mathrm{ss}} = 0 \) (σφάλμα θέσης)
    \item \( e_{\mathrm{sv}} < 0.3 \) (σφάλμα ταχύτητας)
    \item \( \omega_b > \SI{5.5}{\radian/\second} \) (εύρος ζώνης)
    \item \( \theta_m > \ang{30} \) (περιθώριο φάσης)
\end{enumerate}

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum size=9mm]
\draw (1.2,0) node[transfer] (h0) {$H_c$};
\draw (3,0) node[transfer] (h1) {$\displaystyle H_p$};
\draw (0,0) node[mixer,scale=.7] (mix) {};

\draw[<-] (mix.west) -- ++(-1,0);
\draw[->] (mix.east) -- (h0);
\draw[->] (h0) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1.2) -| (mix.south) node[below right] {$-$};
\draw (mix.south);
\end{tikzpicture}

\tcblower
\begin{itemize}
	\item
	Για να έχουμε \textit{μηδενικό σφάλμα θέσης}, θέλουμε σύστημα τύπου 1 (μηδενικό σφάλμα θέσης
	και πεπερασμένο σφάλμα ταχύτητας) επομένως θα προσθέσουμε σίγουρα ένα μηδενικό, ή ακόμα
	καλύτερα έναν ελεγκτή PI:
	\[
	H_c(s) = \frac{k_p (s+μ)}{s}
	\]
	
	Τότε, το σφάλμα θέσης στον κλειστό βρόχο είναι μηδενικό, αφού το σύστημα \( H_pH_c \)
	είναι τύπου 1.
	
	Για το σφάλμα ταχύτητας, βρίσκουμε πρώτα την αντίστοιχη σταθερά:
	\begin{align*}
		K_v &= \lim_{s\to 0}sA(s) \\
		&= \lim_{s\to 0} s \frac{k_p(s+μ)}{s(s+4)(s+6)}
		\\ &= \frac{9k_pμ}{24}
	\end{align*}
	άρα για το σφάλμα θέσης:
	\begin{gather*}
		e_{\mathrm{sv}} = \frac{1}{K_v} = \frac{24}{9K_pμ} < 0.3 \\
		\implies \underline{K_p μ > 8.88}
	\end{gather*}
	
	\item Όσον αφορά το εύρος ζώνης, γνωρίζουμε ότι:
	\[
	\omega_b > \omega_c
	\]
	όπου \( 
	\begin{array}{rl}
	\omega_b & \text{ το εύρος ζώνης της συνάρτησης μεταφοράς κλειστού βρόχου (μέχρι τα \( \SI{-3}{\decibel} \))}\\
	\omega_c & \text{ το εύρος ζώνης της συνάρτησης μεταφοράς ανοιχτού βρόχου (μέχρι τα \( \SI{0}{\decibel} \))}
	\end{array}
	\)
	
	Επομένως μπορούμε να μελετήσουμε τη συνάρτηση ανοιχτού βρόχου, και επιλέγουμε να
	ισχύει \( \omega_c = \SI{5.5}{\radian/\second} \). Θυμόμαστε επίσης ότι το εύρος
	ζώνης είναι το εύρος εντός του οποίου το κέρδος της συνάρτησης μειώνεται \textit{το πολύ}
	κατά \( \SI{3}{\decibel} \).
	
	Πρώτα προσεγγίζουμε κατά Bode τη συνάρτηση μεταφοράς ανοιχτού βρόχου:
	\begin{align*}
		A(s) &= \cdots \\
		\implies \left|A\right|_{\mathrm{dB}}
		&= 20\log\left(\frac{9K_pμ}{24}\right)
		- 20\log\omega + 20\log\omega -20\log μ-20\log\omega+20\log 4.
	\end{align*}
	
	Θέλουμε ο παραπάνω όρος να είναι 0 στη συχνότητα \( \omega_c = 5.5 \).
	Πριν το θέσουμε αυτό, \textbf{επιλέγουμε} \( \underline{K_p\cdot μ = 9} \), και έχουμε
	\begin{align*}
		\left|A\right|_{\mathrm{dB}}
		&= 0 \\ \implies
		0 &= 20\log\frac{81}{24} - 20\log μ -20\log 5.5 \\
		\implies 20\log μ &= 7.8 \implies \underline{μ = 2.45}
	\end{align*}
	
	\item Ελέγχουμε και την τελευταία προδιαγραφή \( \theta_m > \ang{30} \). Το περιθώριο
	φάσης ορίζεται:
	\[
	\theta_m = \ang{180} + \measuredangle A(j5.5)
	\]
	όπου:
	\begin{align*}
	\measuredangle A(j5.5)
	&= -\ang{90} + \tan^{-1}\left(\frac{5.5}{2.45}\right)
	- \tan^{-1}\left( \frac{5.5}{4} \right)
	- \tan^{-1}\left( \frac{5.5}{6} \right)
	\\
	&= -\ang{120.49}
	\end{align*}
	άρα τελικά:
	\[
	\theta_m = \ang{180} - \ang{120.49} > \ang{30}
	\]
	δηλαδή ισχύει η ζητούμενη προδιαγραφή.
	
	Σε περίπτωση που παρατηρούσαμε ότι δεν ισχύει, μπορούσαμε να μεταβάλλουμε τις παραμέτρους
	στις προηγούμενες απαντήσεις, μέχρι να φτάσουμε στην επιθυμητή απάντηση.
\end{itemize}

\end{exercise}
\begin{exercise}
Να σχεδιαστεί ο γεωμετρικός τόπος ριζών για την:
\[
A(s) = \frac{k(s+ρ)}{(s+1)(s+3)(s+6)}
\]
με μοναδιαία αρνητική ανάδραση,
\begin{enumgreekpar}
	\item Για το \( k \), δεδομένου ότι \( ρ=10 \)
	\item Για το \( ρ \), δεδομένου ότι \( k=1 \)
\end{enumgreekpar}
\tcblower
\begin{enumgreekpar}
	\item Η συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:\[
	\frac{k(s+10)}{(s+1)(s+3)(s+6)} = L(s)
	\]
	
	Έχουμε δύο ασυμπτώτους στις \( \pm \ang{90} \) με κέντρο \( \frac{-1-3-6+10}{2} = 0 \).
	
    Έχουμε τρεις κλάδους, και το σημείο τομής των δύο από αυτούς υπολογίζεται από τη
    σχέση \( \od{K(s)}{s} = 0 \), όπου:
    \begin{align*}
    	K(s) &= -\frac{1}{L(s)} \\
    	\od{K(s)}{s} &= 0 \implies \boxed{\begin{aligned}
    		s_1 &= -1.93 \\ s_2 &= -4.95 \\ s_3 &= -13.1
    		\end{aligned}}
    \end{align*}
    Τα σημεία \( s_2 \) και \( s_3 \) απορρίπτονται αφού δεν ανήκουν στο γεωμετρικό τόπο.
    
    \begin{tikzpicture}[xscale=1,scale=1.3]
    \draw[->] (-4.5,0) -- (2,0) node[right] {$\Re$};
    \draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    
    \draw[green!50!black,opacity=.4,xshift=2pt] (0,2.2) -- (0,-2.2);
    
    \coordinate (p1) at (-0.7,0);
    \coordinate (p2) at (-1.5,0);
    \coordinate (p3) at (-3,0);
    \coordinate (p4) at (-4,0);
    \coordinate (b1) at (-1,0);
    
    \draw[locus,ultra thick,postaction={decorate},
    decoration={markings,
    	mark=at position 0.10 with {\arrow{<}},%
    	mark=at position 0.22 with {\arrow{>}},%
    	mark=at position 0.265 with {\arrow[very thick]{<}},%
    	mark=at position 0.45 with {\arrow{<}},%
    	mark=at position 0.85 with {\arrow{>}},%
    }]
    (p4) -- (p3)
    (p2) -- (p1)
    plot [smooth,tension=.6] coordinates {(-0.07,2) (-0.2,1) (b1) (-0.2,-1) (-0.07,-2)}
    ;
    
    \draw (p1) node[locuspole=$-1$] {};
    \draw (p2) node[locuspole=$-3$] {};
    \draw (p3) node[locuspole=$-6$] {};
    \draw (p4) node[locuszero=$-10$] {};
    \draw (b1) node[locusbreak,label={[above,scale=.8,fill=white,fill opacity=.5,text opacity=1]90:$1.93$}] {};
    \end{tikzpicture}
    
    \item Ο παρονομαστής/χαρακτηριστική εξίσωση της συνάρτησης μεταφοράς κλειστού βρόχου είναι:
    \[
    1 + \frac{k(s+ρ)}{(s+1)(s+3)(s+6)} = 0
    \]
   Θέλουμε να τη φέρουμε στη μορφή:
   \[
   1 + ρL(s) = 0
   \]
   
   Για να το πετύχουμε αυτό, κάνουμε πράξεις στην παραπάνω εξίσωση:
   \begin{align*}
   	& (s+1)(s+3)(s+6)+k(s+ρ) = 0 \\
   	\implies & (s+1)(s+3)(s+6) + k s + kρ = 0\\
   	\implies & \frac{(s+1)(s+3)(s+6)+ks}{(s+1)(s+3)(s+6)+ks} + \frac{kρ}{(s+1)(s+3)(s+6)+ks} = 0\\
   	\implies & 1+ρ\frac{k}{ks+(s+1)(s+3)(s+6)}
   \end{align*}
   
   Άρα το αντίστοιχο σύστημα γίνεται:
   \[
   \frac{1}{s+(s+1)(s+3)(s+6)}
   = \frac{1}{(s+0.91)(s+3.57)(s+5.51)}
   \]
   
   Έχουμε 3 ασυμπτώτους με κέντρο \( \frac{-0.91-3.57-5.51}{3} = -3.31 \). Το σημείο
   θλάσης είναι:
   \[
   \od{\left(-\frac{1}{L(s)}\right)}{s} = 0 \implies -s^3+10s^2+28s+18
   \implies s = -2 \text{ ή } \cancel{-4.66}
   \]
   
   \begin{tikzpicture}[xscale=0.8,scale=1.4]
   \draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
   \draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};
   
   
   \draw[locus,ultra thick,postaction={decorate},
   decoration={markings,
   	mark=at position 0.06 with {\arrow{>}},%
   	mark=at position 0.15 with {\arrow{>}},%
   	mark=at position 0.217 with {\arrow{<}},%
   	mark=at position 0.45 with {\arrow{<}},%
   	mark=at position 0.8 with {\arrow{<}},%
   }]
   (-4,0) -- +(-1,0)
   (-2,0) -- (-0.7,0)
   plot [smooth,tension=.4] coordinates {(0.75,2.5) (-1,0.4) (-1.2,0)}
   plot [smooth,tension=.4] coordinates {(0.75,-2.5) (-1,-0.4) (-1.2,0)}
   ;
   
   \draw[green!60!black] (-1.4,0) -- ++(50:3);
   \draw[green!60!black] (-1.4,0) -- ++(-50:3);
   
   \draw (-0.7,0) node[locuspole=$-0.91$] {};
   \draw (-2,0) node[locuspole=$-3.57$] {};
   \draw (-4,0) node[locuspole=$-5.51$] {};
   
   \draw (-1.2,0) node[locusbreak] {};
   \end{tikzpicture}
\end{enumgreekpar}
\end{exercise}

\newpage

\section{Ασκήσεις}

\begin{exercise}
Δίνεται ένα σύστημα με συνάρτηση μεταφοράς:
\[
H(s) = \frac{10}{(s+6)(s+7)}
\]

Να σχεδιαστεί ένα σύστημα κλειστού βρόχου με μοναδιαία αρνητική ανάδραση έτσι ώστε να
ισχύουν οι παρακάτω προδιαγραφές:

\begin{itemize}
	\item
	Σφάλμα θέσης \( e_{\mathrm{ss}} < 0.5 \)
	\item
	Υπερύψωση \( M_p < 0.1 \)
	\item
	Χρόνος αποκατάστασης \( t_s < \SI{660}{\milli\second} \)
\end{itemize}

\subparagraph{Σημείωση}\hspace{0pt}

\begin{tcolorbox}
	Αν μας δινόταν σύστημα με ανάδραση \( G \) μη μοναδιαία, μπορούμε να το μετασχηματίσουμε
	σε σύστημα μοναδιαίας αρνητικής ανάδρασης με συνάρτηση ανοιχτού βρόχου \( A \), όπου:
	\[
	H_c = \frac{H}{1+GH} = \frac{A}{1+A}
	\]
	όπως γνωρίζουμε για τις συναρτήσεις μεταφοράς κλειστού βρόχου.
	
	\begin{tikzpicture}
	\tikzstyle{transfer}=[rectangle,draw,minimum size=10mm]
	\draw (1.5,0) node[transfer] (h1) {$H$};
	\draw (0,0) node[mixer,scale=.7] (mix) {};
	\draw (h1.south) ++(0,-1) node[transfer] (h2) {$G$};
	
	\draw[<-] (mix.west) node[above left] {$+$} -- ++(-1,0);
	\draw[->] (mix.east) -- (h1);
	\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
	\draw[->] (fb.center) |- (h2) -| (mix.south);
	\draw (mix.south) node[below right] {$-$};
	
	\begin{scope}[xshift=6cm]
	\tikzstyle{transfer}=[rectangle,draw,minimum width=12mm]
	
	\draw (1.5,0) node[transfer] (h1) {$A(s)$};
	\draw (0,0) node[mixer,scale=.7] (mix) {};
	
	\draw[<-] (mix.west) node[above left] {$+$} -- ++(-1,0);
	\draw[->] (mix.east) -- (h1);
	\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
	\draw[->] (fb.center) -- (fb.center |- h2)  -| (mix.south);
	\draw (mix.south) node[below right] {$-$};
	\end{scope}
	\end{tikzpicture}
	
	Η παραπάνω σχέση λύνεται ως προς \( A \):
	\[
	A = (1+A)H_c \implies A(1-H_c)=H_c \implies \boxed{A = \frac{H_c}{1-H_c}}
	\]
\end{tcolorbox}

\tcblower
Θα θεωρήσουμε για αρχή ότι το σύστημα είναι τέτοιο ώστε να έχει υπερύψωση, την οποία
θέλουμε να περιορίσουμε.

Το σύστημα μπορεί να είναι τύπου 0, αφού το σφάλμα θέσης είναι πεπερασμένο και δεν έχουμε
κάποιον επιπλέον περιορισμό για τα σφάλματα. Τότε για το σφάλμα θέσης ισχύει:
\begin{align*}
	e_{\mathrm{ss}} &= \frac{1}{1+K_p}
	\intertext{όπου}
	K_p &= \lim_{s\to 0} H(s)
\end{align*}

Αν θεωρήσουμε ότι \textbf{εισάγουμε έναν απλό ελεγκτή κέρδους \( k \)}, τότε \( K_p = \frac{10k}{42} \), και το σφάλμα είναι:
\[
e_{\mathrm{ss}} = \frac{42}{42+10k} < 0.5 \implies \underline{k > 4.2}
\]

\subparagraph{}
Όσον αφορά την υπερύψωση, αυτή δίνεται από τον τύπο:
\[
M_p = e^{\frac{-ζπ}{\sqrt{1-ζ^2}}}
\]

Για να βρούμε το \( ζ \) χρειάζεται πρώτα να υπολογίσουμε την έκφραση του \textbf{συστήματος
	κλειστού βρόχου} ώστε να βρούμε τη \textbf{χαρακτηριστική του εξίσωση}:
\[
H_c = \frac{\frac{10k}{(s+6)(s+7)}}{1+\frac{10}{(s+6)(s+7)}}
= \frac{10k}{(s+6)(s+7)+10k}
\]

Η χαρακτηριστική εξίσωση που προκύπτει από τον παρονομαστή αυτού του κλάσματος είναι:
\[
s^2+13s+42+10k = 0
\]

Μπορούμε να λάβουμε περιπτώσεις για \( ζ<1 \) και \( ζ>1 \). Όταν \( ζ>1 \) δεν υπάρχει
καθόλου υπερύψωση. Σε αυτήν τη λύση θα μελετήσουμε μόνο τη \( ζ<1 \):
	\begin{align*}
	ζ\omega_ n &= 13 \\
	t_s &= \frac{4.16}{ζ\omega_n} = \frac{2\cdot 4.16}{13}
	= \SI{0.64}{\second}
	\end{align*}
άρα ικανοποιείται η τελευταία συνθήκη.

Για την υπερύψωση υπολογίζουμε:
\begin{align*}
	M_p &= e^{\frac{-ζπ}{\sqrt{1-ζ^2}}}
	\implies \\
	0.1 &> e^{\frac{-ζπ}{\sqrt{1-ζ^2}}}
	\implies \\
	-2.3 &> \frac{-ζπ}{\sqrt{1-ζ^2}}
	\implies \\
	ζ^2 &> \frac{1}{2.85} \implies \\
	ζ &> 0.59 \implies \underline{0.59 < ζ < 1}
\end{align*}

Από το \( ζ \) πρέπει να υπολογίσουμε και τις επιθυμητές τιμές του \( k \):
\begin{align*}
	\omega_n^2 &= 42+10k \\
	2ζ\omega_n &= 13 \implies \omega_n = 10.83
\end{align*}
Επίσης επιλέγουμε αυθαίρετα \( \underline{ζ=0.6} \).

Τότε \( \omega_n^2 = 117 = 10k+42 \implies \underline{k=7.53} \).

Σε μία πιο αναλυτική λύση θα σχηματίζαμε μια ανισότητα για το \( k \) με βάση τους περιορισμούς του \( ζ \). Εφ' όσον αυτό δεν ζητείται από την άσκηση, μπορούμε να επιλέξουμε
μια τυχαία τιμή που να πληροί τις προδιαγραφές.

\end{exercise}

\begin{exercise}
Δίνεται το σύστημα
\[
H_p(s) = \frac{2}{(s+1)(s+4)}
\]

Να σχεδιαστεί σύστημα ελέγχου κλειστού βρόχου με μοναδιαία αρνητική ανάδραση έτσι ώστε:
\begin{itemize}
	\item \( t_s \) ο ελάχιστος δυνατός αφού ικανοποιηθούν όλες οι συνθήκες.
	\item Σφάλμα θέσης \( e_{\mathrm{ss}} < 0.1 \)
	\item Περιθώριο φάσης \( \theta_m > \ang{30} \)
	\item Περιθώριο κέρδους \( g_m = \infty \)
	\item Απόσβεση θορύβου τουλάχιστον \( \SI{20}{\decibel} \) για \( \omega = \SI{100}{\radian/\second} \)
	\item Απόρριψη διαταραχών τουλάχιστον \( \SI{20}{\decibel} \) για \( \omega = \SI{0}{\radian/\second} \)
\end{itemize}

\tcblower
Αρχικά, θεωρούμε ότι ο ελεγκτής που προσθέτουμε θα είναι ένας απλός πολλαπλασιαστής \( k \).

Το σφάλμα θέσης είναι:
\[
e_{\mathrm{ss}} = \frac{1}{1+ \lim_{s\to 0} A(s)}
= \frac{1}{1+\frac{2k}{4}} < 0.1 \implies \underline{k > 18}
\]

Σχεδιάζουμε γρήγορα το γεωμετρικό τόπο ριζών:

\begin{tikzpicture}[xscale=1,scale=1.3]
\draw[->] (-2,0) -- (1,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\coordinate (p1) at (-0.5,0);
\coordinate (p2) at (-1.5,0);
\coordinate (b1) at (-1,0);

\draw[locus,ultra thick,postaction={decorate},
decoration={markings,
	mark=at position 0.08 with {\arrow{>}},%
	mark=at position 0.20 with {\arrow{<}},%
	mark=at position 0.45 with {\arrow{>}},%
	mark=at position 0.85 with {\arrow{>}},%
}]
(p1) -- (p2)
(b1) -- ++(0,1.5)
(b1) -- ++(0,-1.5)
;

\draw (p1) node[locuspole=$-1$] {};
\draw (p2) node[locuspole=$-4$] {};
\draw (b1) node[locusbreak] {};
\end{tikzpicture}

Για να έχουμε τον ταχύτερο δυνατό χρόνο αποκατάστασης, θέλουμε οι πόλοι μας να βρίσκονται
επάνω στην κατακόρυφη ευθεία, διότι σε εκείνο το σημείο ο πιο αργός πόλος αποκτά την
πιο αρνητική τιμή (προσέγγιση κυρίαρχου πόλου). Επομένως, θέλουμε οι πόλοι να είναι μιγαδικοί.

Για να υπολογίσουμε ακριβώς το χρόνο αποκατάστασης, βρίσκουμε τη χαρακτηριστική εξίσωση
του συστήματος κλειστού βρόχου:
\[
H_\kappa(s) = \frac{A(s)}{1+A(s)} = \frac{2k}{s^2+5s+4+2k}
\]

Οι πόλοι υπολογίζονται \( \frac{-5\pm\sqrt{9-8k}}{2} \), και ισχύει (αν θεωρήσουμε ότι
οι πόλοι είναι \textbf{συζυγείς μιγαδικοί} όπως διαπιστώσαμε από το γεωμετρικό τόπο
ριζών, άρα \( ζ < 1 \)):
\begin{align*}
	2ζ\omega_ n &= 5 \implies ζ\omega_n = 2.5 \\
	\omega_n^2 &= 4+2k
\end{align*}

Τότε ο χρόνος αποκατάστασης είναι:
\[
t_s = \frac{4.16}{ζ\omega_n} = \SI{1.66}{\second}
\]

Για να ισχύει \( ζ<1 \) όπως απαιτήσαμε παραπάνω, πρέπει ισοδύναμα \( 9-8k < 0
\implies \underline{k>\frac{9}{8}} \).

Όσον αφορά την απόρριψη θορύβου, θυμόμαστε ότι ο θόρυβος εισέρχεται στην είσοδο ενός
συστήματος, και απαιτούμε το μέτρο της συνάρτησης μεταφοράς κλειστού βρόχου να είναι
μικρότερο από \( -\SI{20}{\decibel} \) (δηλαδή 0.1) για \( \omega = \SI{100}{\radian/\second} \):
\[
\left|\frac{A}{1+A}\right| < 0.1
\]

Εδώ \textbf{προσεγγίζουμε} ότι \( 1+A \simeq 1 \) επειδή θεωρούμε πως το \( A \) είναι πολύ
μικρό. Άρα θέλουμε:
\[
|A| < 0.1 \iff \frac{2k}{1\cdot 4 \left(\frac{s}{1}+1\right)\left(\frac{s}{4}+1\right)}
\]
Μπορούμε να \textbf{προσεγγίσουμε} την παραπάνω ποσότητα αφαιρώντας τις μονάδες, αφού το
\( s \) είναι κοντά στο 100:
\[
\frac{2k}{4\left(\frac{s}{1}\right)\left(\frac{s}{4}\right)}
< 0.1
\iff \frac{2k}{100\cdot 100} < 0.1
\iff \underline{k < 500}
\]

Για την απόρριψη των διαταραχών, η συνάρτηση μεταφοράς της διαταραχής είναι διαφορετική,
επειδή αυτή εισέρχεται στο τέλος του συστήματος:
\[
H_{yd} = \frac{1}{1+A}
\]

τότε για \( \omega = 0 \) θέλουμε:
\[
\left|\frac{1}{1+A}\right| < 0.1
\]

Υποθέτουμε ότι το \( A \) είναι αρκετά μεγάλο για να είναι μικρό το κλάσμα, επομένως
\textbf{προσεγγίζουμε} ότι \( 1+A \simeq A \), και έχουμε:
\[
\left|\frac{1}{1+A}\right| \simeq \left|\frac{1}{A}\right| < 0.1
\implies \left|A\right| > 10
\]

Έχουμε ότι \( \left|A\right| = \frac{2k}{1\cdot4 \left(\frac{s}{10+1}\right)\left(\frac{s}{4}+1\right)} = \frac{2k}{4}\) για \( \omega = 0 \).

Επομένως τελικά:
\[
\frac{2k}{4} > 10 \implies \underline{k > 20}
\]

Για τον υπολογισμό περιθωρίου φάσης και κέρδους, μπορούμε να σχεδιάσουμε πρόχειρα ένα
διάγραμμα Bode:

\begin{tikzpicture}[scale=1,xscale=2]
\pgfplotsset{
	/pgf/number format/freq/.style={fixed},
}
\def\phasedown{-4}
\def\phaseextra{-2}

%\draw (-1,1) node[orange!90!blue!80!black] {$\displaystyle \left|H_p\cdot H_c\right|_{\si{\decibel}}$};

\draw[->] (-0.3,\phasedown+\phaseextra) -- (-0.3,3);
\draw[->] (-0.3,0) -- (3.5,0) node[above] {$\si{\radian/\second}$};

\foreach \x in {1,1.6021} {
	\draw[densely dotted] (\x,\phasedown) -- (\x,0);
}

\def\at{40}
\draw[ultra thick,orange!90!blue!80!black]
(-0.3,2.5)
-- ++(1.3,0) node (c1) {}
-- ++(-1*\at:{0.6021/cos(1*\at)}) node(c2) {} node[above right] {-20 dB/dec}
-- ++(-1.8*\at:{1/cos(1.8*\at)}) node(c3) {} node[above right,midway] {-40 dB/dec}
;

\foreach \p in {c1,c2} {
	\draw[densely dashed] (\p.center) -- (\p.center |- 0,0);
}


\foreach \x in {1,1.6021} {
	\pgfmathsetmacro\result{10^\x/10}
	\draw (\x,-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}
\foreach \x in {0,0.6021,1,1.6021,2,2.6021} {
	\pgfmathsetmacro\result{10^\x/10}
	\draw (\x,\phasedown-0.1) node[below,fill=white,fill opacity=.8,text opacity=1,scale=.75] {$\pgfmathprintnumber[freq]\result$} -- ++(0,0.2);
	%\draw[dashed] (\x,0) |- (0,\x*3/4);
}

\begin{scope}[yshift=\phasedown cm]
%\draw (-1,-1) node[magenta,left] {$\phi$};
\draw[->] (-0.3,0) -- (3.5,0);
\def\at{30}

\draw[ultra thick,magenta]
(-0.3,2.5) -- ++ (0.3,0) node(c1) {}
-- ++(-1*\at:{0.6021/cos(1*\at)}) node(c2) {} node[above right,midway,scale=.9] {$\ang{-45}$/dec}
-- ++(-2*\at:{(2-0.6021)/cos(2*\at)}) node(c3) {} node[above right,midway,scale=.9] {$\ang{-90}$/dec}
-- ++(-1*\at:{0.6021/cos(1*\at)}) node(c4) {} node[below,midway,scale=.9] {$\ang{-45}$/dec}
-- ++(0.7,0)
;

\foreach \p in {c1,c2,c3,c4} {
	\draw[dashed,gray] (\p.center) -- (\p.center |- 0,0);
}

\draw (c1 -| -0.3,0) node[left] {$\ang{0}$};
\draw[dashed] (c4) -- (c4 -| -0.3,0) node[left] {$\ang{-180}$};
\end{scope}

\end{tikzpicture}

Η συνάρτηση μεταφοράς τείνει ασυμπτωτικά στις \( \ang{180} \) για \( \omega \to \infty \), αλλά δεν φτάνει ποτέ εκεί, επομένως πάντα το περιθώριο κέρδους είναι \( \infty \).

Για την επιλογή του περιθωρίου φάσης, ψάχνουμε το σημείο τομής της καμπύλης του πλάτους
με τη μονάδα. Όσο μικρότερο είναι το κέρδος, τόσο μεγαλύτερο είναι και το περιθώριο
φάσης. Επομένως, \textbf{επιλέγουμε} το μικρότερο \( k \) που να βρίσκεται εντός
του εύρους των συνθηκών \( k=20 \), και χρειάζεται μετά μόνο να \textbf{επαληθεύσουμε} πως το περιθώριο
φάσης τότε θα είναι όντως μεγαλύτερο των \( \ang{30} \).

Αφού κάνουμε τις αντίστοιχες πράξεις, προκύπτει (για \( k=20 \)) \( \phi_m \simeq \ang{45} > \ang{30}\),
που είναι εντός των προδιαγραφών.

\end{exercise}
\begin{exercise}
Δίνεται η συνάρτηση μεταφοράς:
\[
H_p(s) = \frac{40(s+2)}{(s+8)(s+10)}
\]

Να σχεδιαστεί σύστημα μοναδιαίας αρνητικής ανάδρασης που να ικανοποιεί τις προδιαγραφές:
\begin{itemize}
	\item Σφάλμα ταχύτητας \( e_{\mathrm{sr}} < 0.1 \)
	\item Απόρριψη θορύβου τουλάχιστον \( \SI{20}{\decibel} \) για \( \omega = \SI{200}{\radian/\second} \)
	\item Απόρριψη διαταραχών τουλάχιστον \( \SI{20}{\decibel} \) για \( \omega = \SI{1}{\radian/\second} \)
\end{itemize}

\tcblower
Στη συγκεκριμένη άσκηση θέλουμε να έχουμε πεπερασμένο σφάλμα ταχύτητας, άρα σύστημα τύπου 1,
δηλαδή με έναν ολοκληρωτή. Επομένως, θα εισαγουμε έναν \textbf{ελεγκτή PI}, ή έναν
\textbf{ελεγκτη PI με ένα μηδενικό} στη θέση \( -μ \). Το μηδενικό βοηθάει έτσι ώστε να
μετακινηθεί ο γεωμετρικός τόπος ριζών στα αριστερά και να μην έχουμε προβλήματα αστάθειας.

Επομένως, ο ελεγκτής που εισάγουμε είναι:
\[
\frac{K_p(s+μ)}{s}
\]
και η συνάρτηση μεταφοράς του ανοιχτού βρόχου είναι:
\[
A(s) = \frac{40K_p(s+2)(s+μ)}{s(s+8)(s+10)}
\]

Για τον υπολογισμό του \textit{σφάλματος ταχύτητας}, έχουμε:
\begin{align*}
	K_v &= \frac{1}{\frac{40K_p\cdot 2\cdot μ}{80}} = K_p μ\\
	e_{\mathrm{sv}} &= \frac{1}{K_v} = \frac{1}{K_p μ} < 0.1 \implies
	\underline{K_p μ > 10}.
\end{align*}

Για τον υπολογισμό της \textit{απόρριψης θορύβου}, πρώτα υπολογίζουμε τη συνάρτηση μεταφοράς
του θορύβου:
\[
H_{yn} = \frac{A}{1+A}
\]
η οποία πρέπει να είναι μικρότερη των \( \SI{-20}{\decibel} \), δηλαδή μικρότερη από \( 0.1 \): \( \left|H_{yn}\right|_{\omega=200} < 0.1 \)
Αυτό θα σημαίνει ότι ο αριθμητής είναι πολύ μικρός σε σχέση με τον παρονομαστή, δηλαδή το
\( |A| \) είναι πολύ μικρό, άρα προσεγγίζουμε ότι \( \left|H_{yn}\right| \simeq |A| < 0.1 \).

Για να υπολογίσουμε το \( \left|A\right| \), πρώτα φέρνουμε το \( A(s) \) σε διαφορετική
μορφή:
\[
A(s) = \frac{2\cdot 40 \cdot μ \cdot K_p \cdot \left(\frac{s}{2}+1\right)\left(
	\frac{s}{μ}+1
	\right)}{10\cdot 8\cdot s \cdot \left( \frac{s}{8}+1 \right)\left(\frac{s}{10}+1\right)}
\]
Αφού \( s = j200 \) που είναι μια πολύ μεγάλη τιμή, μπορούμε να προσεγγίσουμε ότι
\( \frac{s}{\triangle} + 1 \approx \frac{s}{\triangle} \). Επομένως το παραπάνω κλάσμα μπορεί
να γίνει:
\[
\frac{40μK_p\cdot \frac{200}{2}\left(\frac{200}{μ}+1\right)}{10\cdot 8 \cdot 200 \cdot\frac{200}{8}\cdot\frac{200}{10}}
\approx \frac{40K_p}{200}
\]

Επομένως, επειδή \( |A| < 0.1 \), έχουμε (αποφεύγουμε την προσέγγιση για τον όρο
\( \left(\frac{200}{μ}+1\right) \) επειδή δεν γνωρίζουμε το μέγεθος του \( μ \)):
\begin{align*}
	\left|
	\frac{40K_p\sqrt{μ^2+40000}\cdot 200}{200^3}
	\right| &< 0.1 \implies \\
	K_p \sqrt{μ^2 + 40000} &\leq 100 \implies \\
	\underline{K_p^2μ^2+K_p^2\cdot 40000}& \underline{\leq 10000}
\end{align*}

Για την \textit{απόρριψη διαταραχών}, η συνάρτηση μεταφοράς τους είναι:
\[
H_{yd} = \frac{1}{1+A}
\]

Έχουμε και λαμβάνουμε την προσέγγιση:
\[
\left|\frac{1}{1+A}\right|_{\omega = 1} \leq 0.1
\implies |A(j\omega )|_{\omega =1} \geq 10
\]

Το μέτρο του \( A(s) \) είναι:
\[
\left|A(s)\right|
= \frac{40K_p \sqrt{μ^2+1}\sqrt{2^2+1}}{\sqrt{8^2+1}\sqrt{10^2+1}}
\]

Αν λύσουμε την ανισότητα \( |A|\geq 10 \), θα βρούμε \( \underline{K_p\sqrt{μ^2+1} \geq 9} \).
Αν λαμβάναμε προσέγγιση όπως και στην προηγούμενη άσκηση, θα βρίσκαμε \( K_p\sqrt{μ^2+1} \geq 10 \). Ίσως αυτή δεν είναι μια τόσο εύστοχη
προσέγγιση, αφού το 1 είναι πολύ κοντά στο 2 σε ένα από τα μηδενικά.

Τελικά έχουμε καταλήξει με τρεις ανισότητες που πρέπει να φροντίσουμε να ικανοποιούνται.

Από την \( K_p μ > 10 \), επιλέγουμε αυθαίρετα ότι \( K_pμ = 15 \). Τότε η δεύτερη
ανισότητα παίρνει τη μορφή:
\[
225 + K_p^2\cdot 40000 \leq 10000
\implies K_p^2 \implies \underline{K_p \leq 0.49}
\]
Αν αυθαίρετα επιλέξουμε \( K_p = 0.4 \), τότε από το \( K_p μ=15 \) έχουμε \( μ=37.5 \).

Τέλος, επαληθεύουμε την ανισότητα \( K_p\sqrt{μ^2+1} \geq 10 \):
\[
K_p\sqrt{μ^2+1}
= 0.4\cdot \sqrt{37.5^2 + 1} \approx 15.005 \geq 10.
\]

\end{exercise}
\begin{exercise}
Δίνεται το σύστημα κλειστού βρόχου με μοναδιαία αρνητική ανάδραση:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum width=12mm]

\draw (1.5,0) node[transfer] (h1) {$H_c(s)$};
\draw (3.5,0) node[transfer] (h2) {$H_p(s)$};
\draw (0,0) node[mixer,scale=.7] (mix) {};

\draw[<-] (mix.west) node[above left] {$+$} -- ++(-1.5,0) node[near end,above] {$v$};
\draw[->] (mix.east) -- (h1);
\draw[->] (h1) -- (h2);
\draw[->] (h2.east) -- +(1,0) node[midway] (fb) {} node[below right] {$y$};
\draw[->] (fb.center) -- ++(0,-1.3)  -| (mix.south);
\draw (mix.south) node[below right] {$-$};
\end{tikzpicture}

όπου:
\[
H_p(s) = \frac{3}{s^2-9}
\]

\begin{enumgreekparen}
	\item Αρχικά εισάγουμε έναν αναλογικό ελεγκτή \( H_c(s) = K_p \).
	
	Για ποιές τιμές του \( K_p \) το σύστημα γίνεται οριακά ευσταθές;
	
	\item Να σχεδιαστεί ελεγκτής \( H_c(s) \) τέτοιος ώστε να έχουμε ευστάθεια και χρόνο
	αποκατάστασης \( t_s < \SI{1}{\second} \).
	
	\item Για τον ελεγκτή του προηγούμενου ερωτήματος να βρείτε το σφάλμα θέσης στη μόνιμη
	κατάσταση και να σχολιάσετε το αποτέλεσμα.
	
	\item Προτείνετε επιπλέον όρους που θα πρέπει να εισαχθούν στον ελεγκτή ώστε να
	μηδενιστεί το σφάλμα θέσης, και να διατηρηθούν οι υπόλοιπες προδιαγραφές.
	Σχεδιάστε το γεωμετρικό τόπο ριζών, δικαιολογήστε την επιλογή σας, και υπολογίστε το
	σφάλμα μόνιμης κατάστασης για βηματική είσοδο.
\end{enumgreekparen}

\tcblower
\begin{enumgreekparen}
	\item Η συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:\[
	A(s) = \frac{K_p\cdot 3}{s^2-9}
	\]
	
	Σχεδιάζουμε τον γεωμετρικό τόπο ριζών, δεδομένου ότι έχουμε 2 ασυμπτώτους, κέντρο
	ασυμπτώτων \( \frac{\sum p -\sum z}{\text{Αρ. Ασ.}} = 0 \) με γωνίες \( \pm \ang{90} \).
	
	\begin{tikzpicture}[xscale=1,scale=1.3]
	\draw[->] (-1.5,0) -- (1.5,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
	
	\coordinate (p1) at (-1,0);
	\coordinate (p2) at (+1,0);
	\coordinate (b1) at (0,0);
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.10 with {\arrow{>}},%
		mark=at position 0.32 with {\arrow{<}},%
		mark=at position 0.55 with {\arrow{>}},%
		mark=at position 0.90 with {\arrow{>}},%
	}]
	(p1) -- (p2)
	(b1) -- ++(0,1.5) node (pf1) {}
	(b1) -- ++(0,-1.5) node (pf2) {}
	;
	
	\draw[locus,ultra thick,path fading=north] (pf1.center) -- ++(0,0.5);
	\draw[locus,ultra thick,path fading=south] (pf2.center) -- ++(0,-0.5);
	
	\draw (p1) node[locuspole=$-3$] {};
	\draw (p2) node[locuspole=$+3$] {};
	\draw (b1) node[locusbreak] {};
	\end{tikzpicture}
	
	\textbf{Οριακή ευστάθεια} έχουμε όταν οι πόλοι βρίσκονται \textit{επάνω} στον φανταστικό άξονα.
	Για να βρούμε τα \( K_p \) για τα οποία οι πόλοι βρίσκονται σε αυτή τη θέση, θα μπορούσαμε
	πρώτα να βρούμε το \( K_p \) όπου οι πόλοι είναι 0, και όλα τα \( K_p \) μεγαλύτερα
	από αυτό ικανοποιούν τη ζητούμενη συνθήκη, όπως φαίνεται από την κατεύθυνση των βελών
	στο γεωμετρικό τόπο.
	
	Εναλλακτικά, μπορούμε να λύσουμε τη χαρακτηριστική εξίσωση του συστήματος κλειστού
	βρόχου, έτσι ώστε να έχει δύο συζυγείς ρίζες:
	\[
	G_κ(s) = \frac{3K_p}{s^2-9+3K_p}
	\]
	
	Η χαρακτηριστική εξίσωση είναι \( s^2\underbrace{-9+3K_p} = 0 \). Για να έχουμε δύο
	συζυγείς ρίζες, πρέπει ο όρος \( -9+3K_p \) να είναι θετικός (για να έχουμε μια
	μορφή \( s^2+a^2 > 0 \) που έχει μόνο φανταστικές ρίζες).
	
	Επομένως:
	\[
	-9+3K_p > 0 \implies \underline{K_p > 3}.
	\]
	
	\item Επιλέγουμε να τοποθετήσουμε ένα μηδενικό, έτσι ώστε να μετακινήσουμε το γεωμετρικό
	τόπο ριζών προς τα αριστερά:
	\[
	H_c(s) = k(s+z)
	\]
	
	Τότε η συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:
	\[
	A(s) = \frac{k(s+z)3}{s^2-9}
	\]
	
	Μπορούμε να τοποθετήσουμε ένα μηδενικό στη θέση -4:
	
	    \begin{tikzpicture}[xscale=1,scale=1.2]
	\draw[->] (-4.5,0) -- (2,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
	
	\coordinate (p1) at (1,0);
	\coordinate (p2) at (-1,0);
	\coordinate (p3) at (-2,0);
	\coordinate (b1) at (0.3,0);
	\coordinate (b2) at (-3,0);
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.04 with {\arrow{<}},%
		mark=at position 0.10 with {\arrow{>}},%
		mark=at position 0.195 with {\arrow{>}},%
		mark=at position 0.265 with {\arrow{<}},%
		mark=at position 0.50 with {\arrow{>}},%
		mark=at position 0.85 with {\arrow{<}},%
	}]
	(p3) -- (current bounding box.west |- 0,0)
	(p1) -- (p2)
	($(b2)!0.5!(b1)$) circle (1.65cm)
	;
	
	\draw (p1) node[locuspole=$3$] {};
	\draw (p2) node[locuspole=$-3$] {};
	\draw (p3) node[locuszero=$-4$] {};
	\draw (b1) node[locusbreak] {};
	\draw (b2) node[locusbreak] {};
	\end{tikzpicture}
	
	Για \( z=4 \), η αντίστοιχη του κλειστού είναι:
	\[
	G_κ = \frac{3k(s+4)}{3k(s+4)+s^2-9}
	\]
	με χαρακτηριστική εξίσωση \( s^2-9+3k(s+4) = 0 \iff s^2+3ks -9 + 12k = 0 \), η οποία
	έχει \( ζ\omega_n = \frac{3k}{2} \).
	
	Θέλουμε \( t_s < 1 \), άρα \( ζ\omega_n > 4 \implies \frac{3k}{2}>4 \implies
	\underline{k > \frac{8}{3}} \).
	
	\item
	Το σύστημα είναι τύπου 0, με:
	\begin{align*}
		e_{\mathrm{ss}} &= \frac{1}{1+K_p} \\
		K_p &= \lim_{s\to 0} A(s) = -4.66 \\
		e_{ss} &= -0.27
	\end{align*}
	
	Το σφάλμα \( e_{ss} \) είναι αρνητικό, άρα η έξοδος \( y = -e + r \) (όπου \( e \) το
	σφάλμα και \( r \) η είσοδος) θα είναι μεγαλύτερη από την επιθυμητή είσοδο.
	
	Τώρα πρέπει να βρούμε και το σφάλμα λόγω της διαταραχής.
	
	Η συνάρτηση μεταφοράς της διαταραχής είναι:
	\[
	\frac{y}{d} = \frac{H_p}{1+H_cH_p} = \frac{\frac{3}{s^2+9}}{1+\frac{9(s+4)}{s^2-9}}
	= \frac{3}{s^2-9+9(s+4)}
	\]
	
	Στη μόνιμη κατάσταση, αν έχουμε μια βηματική διαταραχή και μηδενική είσοδο, η έξοδος
	θα είναι:
	\[
	y = \lim_{s\to 0}s\frac{y}{d}\frac{1}{s} = \left.\frac{y}{d}\right|_{s=0}
	\simeq \underline{0.09}
	\]
	
	Επιπλέον, αν έχουμε μηδενική διαταραχή και βηματική είσοδο, μπορούμε να βρούμε την
	έξοδο στη μόνιμη κατάσταση, αξιοποιώντας το σφάλμα που βρήκαμε παραπάνω:
	\[
	e=v-y \implies y=v-e \implies \underline{y_{ss}= 1.27}
	\]
	
	Η συνολική έξοδος θα είναι, σύμφωνα με την αρχή της επαλληλίας:
	\[
	y=y_r + y_d = 1.27+0.09 \simeq 1.36
	\]
	άρα και το συνολικό σφάλμα:
	\[
	e_{\mathrm{ss}} = 1-1.36 = \underline{-0.36}
	\]
	\item Θέλουμε το σφάλμα μόνιμης κατάστασης να γίνει 0, άρα θα χρησιμοποιήσουμε έναν
	ελεγκτή PI, δηλαδή της μορφής \( \frac{k(s+z)}{s} \), δηλαδή ο ελεγκτής θα γίνει:
	\[
	H_c = \frac{k(s+z)}{s}(s+4)
	\]
	
	Τοποθετώ το μηδενικό πιο αριστερά από το -4 έτσι ώστε στο γεωμετρικό τόπο να ανήκουν
	κομμάτια με πραγματικό μέρος πριν το -4. Ο γεωμετρικός τόπος θα γίνει:
	
	\begin{tikzpicture}
	\draw[->] (-4.7,0) -- (2,0) node[right] {$\Re$};
	\draw[->] (0,-2.5) -- (0,2.5) node[left] {$\Im$};
	
	\coordinate (p0) at (0,0);
	\coordinate (p1) at (+1.2,0);
	\coordinate (p2) at (-1,0);
	\coordinate (p3) at (-1.9,0);
	\coordinate (p4) at (-3,0);
	\coordinate (b1) at (0.5,0);
	\coordinate (b2) at (-4,0);
	
	\fill[fill=magenta!70!green,path fading=west,opacity=.7]
	(p3 |- current bounding box.north) rectangle (-4.7,-1 |- current bounding box.south);
	
	\begin{scope}[locus,ultra thick]
	\draw[postaction={decorate},
	decoration={markings,
		mark=at position 0.25 with {\arrow{>}},%
		mark=at position 0.75 with {\arrow{<}},%
	}]
	let \p1=($(b1)$) in (\x1,0)
	let \p2=($(b2)$) in (\x2,0)
	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
	;
	
	\draw[postaction={decorate},
	decoration={markings,
		mark=at position 0.30 with {\arrow{>}},%
		mark=at position 0.75 with {\arrow{<}},%
	}]
	(p0) -- (p1)
	;
	
	\draw[postaction={decorate},
	decoration={markings,
		mark=at position 0.50 with {\arrow{>}},%
	}]
	(p2) -- (p3)
	;
	
	\draw[postaction={decorate},
	decoration={markings,
		mark=at position 0.30 with {\arrow{<}},%
		mark=at position 0.90 with {\arrow{>}},%
	}]
	(p4) -- (current bounding box.west |- 0,0)
	;
	\end{scope}
	
	\draw (p0) node[locuspole,label={[below right]-45:$0$}] {};
	\draw (p1) node[locuspole=$+3$] {};
	\draw (p2) node[locuspole=$-3$] {};
	\draw (p3) node[locuszero=$-4$] {};
	\draw (p4) node[locuszero] {};
	\draw (b1) node[locusbreak] {};
	\draw (b2) node[locusbreak] {};
	\end{tikzpicture}
	
	Επιβεβαιώνουμε με τη συνάρτηση μεταφοράς ανοιχτού και κλειστού βρόχου:
	\begin{align*}
		A &= \frac{k(s+z)(s+4)\cdot 3}{s(s^2-9)}\\
		H_{\text{κ}} &= \frac{3k(s+z)(s+4)}{s(s^2-9)+3k(s+z)(s+4)}
	\end{align*}
	
	Από τη χαρακτηριστική εξίσωση (παρονομαστής του \( H_{\text{κ}} \))
	παρατηρούμε ότι οι πόλοι του συστήματος κλειστού βρόχου (οι λύσεις της )είναι της μορφής:
	\[
	(s+4+ε)\ (s+z+d)\ (s+\cdots)
	\]
	όπου \( ε\ll 4 \) και \( δ\ll z \). Ο πόλος στο \( 4+ε \) εξουδετερώνεται από το μηδενικό
	\( (s+4) \), επομένως δεν τον λαμβάνουμε υπ' όψιν ως κυρίαρχο πόλο.
\end{enumgreekparen}

\end{exercise}
\begin{exercise}[Θέμα Εξετάσεων]
Δίνεται το εξής σύστημα:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum height=9mm]
\draw (1.5,0) node[transfer] (h1) {$\displaystyle G(s)$};
\draw (0,0) node[circle,draw,minimum size=5mm] (mix) {};
\draw (h1.south) ++(0,-1) node[transfer] (h2) {$\displaystyle H(s)$};

\draw[<-] (mix) -- ++(-1,0);
\draw[->] (mix) -- (h1);
\draw[->] (h1.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) |- (h2) -| (mix);
\draw (mix.south);
\end{tikzpicture}

όπου \[
G(s) = \frac{2(s+8)}{s(s+4)(s+6)}
\]

\begin{enumgreekparen}
	\item Για τον ελεγκτή \( H(s) = k \) (\( k>0 \)), να σχεδιαστεί ο γεωμετρικός τόπος
	ριζών και να βρεθεί ο χρόνος αποκατάστασης \( t_s \) για μεγάλο \( k \).
	\item Για τον ελεγκτή \( H(s) = k(s+z) \) να τοποθετήσετε το μηδενικό και να σχεδιάσετε
	το γεωμετρικό τόπο ριζών έτσι ώστε \( t_s < \SI{0.5}{\second} \) για κατάλληλα \( k \).
\end{enumgreekparen}

\tcblower
\begin{enumgreekparen}
	\item Για το σχεδιασμό του γεωμετρικού τόπου ριζών έχουμε τη χαρακτηριστική εξίσωση
	όπως γνωρίζουμε από τη θεωρία:
	\[
	1+2k\frac{s+8}{s(s+4)(s+6)}
	\]
	
	
	Έχουμε 3 μηδενικά και 1 πόλο, άρα 3 κλάδους (από τους οποίους 2 καταλήγουν στο \( \infty \)). Το σημείο τομής των ασυμπτώτων προκύπτει -1, και οι γωνίες \( \pm \ang{90} \).
	
	Λύνοντας την εξίσωση \( \od{G(s)}{s} \) μπορούμε να βρούμε το σημείο απόσχισης στη
	θέση \( \approx -1.84 \).
	
	\begin{tikzpicture}[xscale=1,scale=1.2]
	\draw[->] (-4.5,0) -- (2,0) node[right] {$\Re$};
	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
	
	\coordinate (p0) at (0,0);
	\coordinate (p1) at (-1,0);
	\coordinate (p2) at (-2,0);
	\coordinate (p3) at (-3,0);
	\coordinate (b1) at (-0.7,0);
	
	\draw[green!50!black] (-0.5,-2) -- (-0.5,2) node[midway,below right,scale=.8] {$-1$};
	
	\draw[locus,ultra thick,postaction={decorate},
	decoration={markings,
		mark=at position 0.10 with {\arrow{<}},%
		mark=at position 0.205 with {\arrow[very thick]{>}},%
		mark=at position 0.275 with {\arrow{<}},%
		mark=at position 0.50 with {\arrow{<}},%
		mark=at position 0.85 with {\arrow{>}},%
	}]
	(p3) -- (p2)
	(p1) -- (p0)
	plot [smooth,tension=.6] coordinates {(-0.55,2) (-0.60,0.7) (b1) (-0.60,-0.7) (-0.55,-2)}
	;
	
	\draw (p0) node[locuspole] {};
	\draw (p1) node[locuspole=$-4$] {};
	\draw (p2) node[locuspole=$-6$] {};
	\draw (p3) node[locuszero=$-8$] {};
	\draw (b1) node[locusbreak,label={[above]90:$-1.84$},scale=.9] {};
	\end{tikzpicture}
	
	Αφού για \( k\to \infty \) οι κυρίαρχοι πόλοι στα δεξιά τείνουν σε πραγματικό μέρος
	-1. Επομένως ο χρόνος αποκατάστασης είναι \( t_s \approx\frac{4}{p}=\SI{4}{\second} \).
	
	\item Για την τοποθέτηση του μηδενικού μπορούμε να εκμεταλλευτούμε το γεωμετρικό τόπο
	ριζών που έχουμε ήδη σχεδιάσει. Αυτό που επιθυμούμε είναι \( \frac{4}{p} \approx t_s <
	 \SI{0.5}{\second} \), άρα πρέπει να βρούμε έναν κυρίαρχο πόλο τέτοιο ώστε \( -p < -8 \).
	 
	Υπολογίζουμε τη συνάρτηση μεταφοράς κλειστού βρόχου:
	\[
	T(s) = \frac{2(s+8)}{s(s+4)(s+6)+2k(s+z)(s+8)}
	\]
	 
    Για την επιλογή του μηδενικού μπορούμε να δοκιμάζουμε τιμές για αυτό μέχρι να βρούμε
    κάποια κατάλληλη, σχεδιάζοντας το γεωμετρικό τόπο
    (αφού πραγματοποιήσουμε την ανάλυση όπως γνωρίζουμε). Ενδεικτικά:
    \begin{itemize}
    	\item \textbf{Για} \( z=10 \):
    	
    	\begin{tikzpicture}[xscale=1,scale=1]
    	\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
    	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    	
    	\coordinate (p0) at (0,0);
    	\coordinate (p1) at (-1,0);
    	\coordinate (p2) at (-2,0);
    	\coordinate (p3) at (-3,0);
    	\coordinate (p4) at (-4,0);
    	\coordinate (b1) at (-0.5,0);
    	\coordinate (b2) at (-4.5,0);
    	
    	\begin{scope}[locus,ultra thick]
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.25 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	let \p1=($(b1)$) in (\x1,0)
    	let \p2=($(b2)$) in (\x2,0)
    	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	(p0) -- (p1)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.50 with {\arrow{>}},%
    	}]
    	(p2) -- (p3)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{<}},%
    		mark=at position 0.80 with {\arrow{>}},%
    	}]
    	(p4) -- (current bounding box.west |- 0,0)
    	;
    	\end{scope}
    	
    	\draw (p0) node[locuspole,label={[below right]0:$0$}] {};
    	\draw (p1) node[locuspole=$-4$] {};
    	\draw (p2) node[locuspole=$-6$] {};
    	\draw (p3) node[locuszero=$-8$] {};
    	\draw (p4) node[locuszero=$-10$] {};
    	\draw (b1) node[locusbreak] {};
    	\draw (b2) node[locusbreak] {};
    	\end{tikzpicture}
    	
    	Εδώ θα κυριαρχήσει ο κοντινότερος στον φανταστικό άξονα πόλος. Οι πόλοι που
    	βρίσκονται στον κλάδο μεταξύ \( -8 \) και \( -6 \) οδηγούν σε αργή απόκριση επειδή
    	κυριαρχούν για οποιοδήποτε \( k \), και όχι σε κατάλληλο χρόνο αποκατάστασης.
    	\item \textbf{Για} \( z=7 \):
    	
    	\begin{tikzpicture}[xscale=1,scale=1]
    	\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
    	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    	
    	\coordinate (p0) at (0,0);
    	\coordinate (p1) at (-1,0);
    	\coordinate (p2) at (-2,0);
    	\coordinate (p3) at (-3,0);
    	\coordinate (p4) at (-2.5,0);
    	\coordinate (b1) at (-0.5,0);
    	\coordinate (b2) at (-4,0);
    	
    	\begin{scope}[locus,ultra thick]
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.25 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	let \p1=($(b1)$) in (\x1,0)
    	let \p2=($(b2)$) in (\x2,0)
    	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	(p0) -- (p1)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.65 with {\arrow[very thick]{>}},%
    	}]
    	(p2) -- (p4)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{<}},%
    		mark=at position 0.80 with {\arrow{>}},%
    	}]
    	(p3) -- (current bounding box.west |- 0,0)
    	;
    	\end{scope}
    	
    	\draw (p0) node[locuspole,label={[below right]0:$0$}] {};
    	\draw (p1) node[locuspole=$-4$] {};
    	\draw (p2) node[locuspole=$-6$] {};
    	\draw (p3) node[locuszero=$-8$] {};
    	\draw (p4) node[locuszero=$-7$] {};
    	\draw (b1) node[locusbreak] {};
    	\draw (b2) node[locusbreak] {};
    	\end{tikzpicture}
    	
    	Εδώ ο κυρίαρχος πόλος θα είναι \(-7\) για μεγάλα \( k \), άρα η λύση είναι μη
    	αποδεκτή.
    	
    	\item \textbf{Για} \( z=5 \):
    	
    	\begin{tikzpicture}[xscale=1,scale=1]
    	\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
    	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    	
    	\coordinate (p0) at (0,0);
    	\coordinate (p1) at (-1,0);
    	\coordinate (p2) at (-2,0);
    	\coordinate (p3) at (-3,0);
    	\coordinate (p4) at (-1.5,0);
    	\coordinate (b1) at (-0.5,0);
    	\coordinate (b2) at (-4,0);
    	
    	\begin{scope}[locus,ultra thick]
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.25 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	let \p1=($(b1)$) in (\x1,0)
    	let \p2=($(b2)$) in (\x2,0)
    	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	(p0) -- (p1)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.65 with {\arrow[very thick]{>}},%
    	}]
    	(p2) -- (p4)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{<}},%
    		mark=at position 0.80 with {\arrow{>}},%
    	}]
    	(p3) -- (current bounding box.west |- 0,0)
    	;
    	\end{scope}
    	
    	\draw (p0) node[locuspole,label={[below right]0:$0$}] {};
    	\draw (p1) node[locuspole=$-4$] {};
    	\draw (p2) node[locuspole=$-6$] {};
    	\draw (p3) node[locuszero=$-8$] {};
    	\draw (p4) node[locuszero=$-5$] {};
    	\draw (b1) node[locusbreak] {};
    	\draw (b2) node[locusbreak] {};
    	\end{tikzpicture}
    	
    	Ο κυρίαρχος πόλος \( -5 \) συνεχίζει να οδηγεί σε μη αποδεκτή λύση.
    	
    	\item \textbf{Για} \( z=4 \):
    	
    	\begin{tikzpicture}[xscale=1,scale=1]
    	\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
    	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    	
    	\coordinate (p0) at (0,0);
    	\coordinate (p1) at (-1,0);
    	\coordinate (p2) at (-2,0);
    	\coordinate (p3) at (-3,0);
    	\coordinate (p4) at (p1);
    	\coordinate (b1) at (-0.5,0);
    	\coordinate (b2) at (-4,0);
    	
    	\begin{scope}[locus,ultra thick]
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.25 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	let \p1=($(b1)$) in (\x1,0)
    	let \p2=($(b2)$) in (\x2,0)
    	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
    	($(b2)!0.5!(b1)$) ++(140:\x1/2-\x2/2) node[circle,top color=magenta,draw=orange!30!black,inner sep=2.5pt,thick,bottom color=blue,fill opacity=.6] (a1) {}
    	($(b2)!0.5!(b1)$) ++(-140:\x1/2-\x2/2) node[circle,top color=magenta,draw=orange!30!black,inner sep=2.5pt,thick,bottom color=blue,fill opacity=.6] (a2) {}
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.15 with {\arrow{>}},%
    		mark=at position 0.40 with {\arrow[ultra thick]{<}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	(p0) -- (p2)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{<}},%
    		mark=at position 0.80 with {\arrow{>}},%
    	}]
    	(p3) -- (current bounding box.west |- 0,0)
    	;
    	\end{scope}
    	
    	\draw (p0) node[locuspole,label={[below right]0:$0$}] {};
    	\draw (p1) node[locuspole=$-4$] {};
    	\draw (p2) node[locuspole=$-6$] {};
    	\draw (p3) node[locuszero=$-8$] {};
    	\draw (p4) node[locuszero,fill opacity=.4] {};
    	\draw (b1) node[locusbreak] {};
    	\draw (b2) node[locusbreak] {};
    	
    	\draw[magenta!50!blue] (a1.north) node[above] {$p_1$};
    	\draw[magenta!50!blue] (a2.south) node[below] {$p_2$};
    	\end{tikzpicture}
    	
    	Εδώ ο γεωμετρικός τόπος φαίνεται ότι ικανοποιεί τα κριτήρια και μπορούμε να βρούμε
    	δύο πόλους που να έχουν τον επιθυμητό χρόνο απόκρισης (όπως οι \( p_1 \) και
    	\( p_2 \) στο σχήμα).
    	Παρ' όλα αυτά, αν θεωρήσουμε τη χαρακτηριστική συνάρτηση του κλειστού βρόχου που
    	είναι ο παρονομαστής της συνάρτησης μεταφοράς:
    	\[
    	\frac{2(s+8)}{s(s+4)(s+6)+2k(s+4)(s+8)}
    	= \frac{2(s+8)}{(s+4)\left[
    	s(s+6)+2k(s+8)
    	\right]}
    	\]
    	Δηλαδή ο πόλος στο \( s+4 \) \textbf{παραμένει και δεν απαλείφεται} από τη συνάρτηση
    	μεταφοράς, αν και δε φαίνεται στο γεωμετρικό τόπο ριζών!
    	
    	Επομένως η λύση αυτή δεν είναι αποδεκτή.
    	
    	\item \textbf{Για} \( z=8 \): 
    	
    	\begin{tikzpicture}[xscale=1,scale=1]
    	\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
    	\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};
    	
    	\coordinate (p0) at (0,0);
    	\coordinate (p1) at (-1,0);
    	\coordinate (p2) at (-2,0);
    	\coordinate (p3) at (-3,0);
    	\coordinate (p4) at (-1.5,0);
    	\coordinate (b1) at (-0.5,0);
    	\coordinate (b2) at (-4,0);
    	
    	\begin{scope}[locus,ultra thick]
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.25 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	let \p1=($(b1)$) in (\x1,0)
    	let \p2=($(b2)$) in (\x2,0)
    	($(b2)!0.5!(b1)$) circle (\x1/2-\x2/2)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{>}},%
    		mark=at position 0.75 with {\arrow{<}},%
    	}]
    	(p0) -- (p1)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.50 with {\arrow{>}},%
    	}]
    	(p2) -- (p3)
    	;
    	
    	\draw[postaction={decorate},
    	decoration={markings,
    		mark=at position 0.30 with {\arrow{<}},%
    		mark=at position 0.80 with {\arrow{>}},%
    	}]
    	(p3) -- (current bounding box.west |- 0,0)
    	;
    	\end{scope}
    	
    	\draw (p0) node[locuspole,label={[below right]0:$0$}] {};
    	\draw (p1) node[locuspole=$-4$] {};
    	\draw (p2) node[locuspole=$-6$] {};
    	\draw (p3) node[locuszero,scale=1.6] {};
    	\draw (p3) node[locuszero=$-8$] {};
    	\draw (b1) node[locusbreak] {};
    	\draw (b2) node[locusbreak] {};
    	\end{tikzpicture}
    	
    	Η συνάρτηση μεταφοράς κλειστού βρόχου γίνεται:
    	\[
    	\frac{2(s+8)}{s(s+4)(s+6)+2k(s+8)^2}
    	\]
    	
 	    Σε αυτήν τη συνάρτηση, για αρκετά μεγάλα \( k \), το μηδενικό στο \( -8 \) εξουδετερώνεται
 	    από τον πόλο στο \( -8 \), αφού ο όρος \( s(s+4)(s+6) \) γίνεται αμελητέος. Επομένως
 	    παραμένουν πόλοι στη συνάρτηση κλειστού βρόχου μόνο αριστερά του \( -8 \), και προκύπτει
 	    το επιθυμητό αποτέλεσμα.
    \end{itemize}
\end{enumgreekparen}

\hspace{0pt}

\end{exercise}
\begin{exercise}[Θέμα Εξετάσεων]
Έστω το σύστημα ελέγχου:

\begin{tikzpicture}
\tikzstyle{transfer}=[rectangle,draw,minimum width=12mm,minimum height=9mm]

\draw (1.5,0) node[transfer] (h1) {$G_c(s)$};
\draw (4,0) node[transfer] (h2) {$\displaystyle \frac{s+2}{s^2+6s+25}$};
\draw (0,0) node[mixer,scale=.7] (mix) {};

\draw[<-] (mix.west) node[above left] {$+$} -- ++(-1.5,0);
\draw[->] (mix.east) -- (h1);
\draw[->] (h1) -- (h2);
\draw[->] (h2.east) -- +(1,0) node[midway] (fb) {};
\draw[->] (fb.center) -- ++(0,-1.6)  -| (mix.south);
\draw (mix.south) node[below right] {$-$};
\end{tikzpicture}

\begin{enumlatin}
	\item Για \( G_c(s) = k \) σχεδιάστε το γεωμετρικό τόπο ριζών. Τοποθετήστε τους πόλους
	για το σύστημα κλειστού βρόχου υπολογίζοντας την τιμή \( k \) έτσι ώστε να έχουμε
	τον μικρότερο χρόνο αποκατάστασης \( t_s = t_{s_{\min}} \), έχοντας ως περιορισμό
	ότι \( k \leq 15 \).
	\item Χρησιμοποιώντας ελεγκτή της μορφής:
	\[
	G_c(s) = k\frac{s+z}{s+p}
	\]
	βελτιώστε το χρόνο αποκατάστασης έτσι ώστε να είναι μικρότερος από \( t_s < \SI{0.5}{\second} \).
	
	Δεδομένου ότι πρέπει \( k \leq 15 \), βρείτε τις τιμές \( k,z,p  \) σχεδιάζοντας το
	γεωμετρικό τόπο ριζών, και υπολογίστε προσεγγιστικά το νέο χρόνο αποκατάστασης.
\end{enumlatin}

\tcblower
\begin{enumlatin}
	\item
Οι πόλοι του συστήματος προκύπτουν από τη λύση της χαρακτηριστικής εξίσωσης \( s^2+6s+25 \)
και είναι οι:
\[
-3\pm j4
\]

Σχεδιάζουμε το γεωμετρικό τόπο ριζών:

\begin{tikzpicture}
\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\coordinate (p1) at (-0.5,0);
\coordinate (p2) at (-1,1.5);
\coordinate (p3) at (-1,-1.5);
\coordinate (b1) at (-3,0);

\draw[gray,dashed] (p2 -| 0,0) node[right] {$j4$} -- (p2) -- (p3) node[midway,above] {$-3$} -- (p3 -| 0,0) node[right] {$-j4$};

\begin{scope}[locus,ultra thick]
\draw[postaction={decorate},
decoration={markings,
	mark=at position 0.25 with {\arrow{>}},%
	mark=at position 0.75 with {\arrow{<}},%
}]
plot [smooth,tension=.9] coordinates {(p2) (b1) (p3)}
;

\draw[postaction={decorate},
decoration={markings,
	mark=at position 0.30 with {\arrow{<}},%
	mark=at position 0.80 with {\arrow{>}},%
}]
(p1) -- (current bounding box.west |- 0,0)
;
\end{scope}

\draw (p1) node[locuszero=$-2$] {};
\draw (p2) node[locuspole] {};
\draw (p3) node[locuspole] {};
\draw (b1) node[locusbreak] {};
\end{tikzpicture}

Για να βρούμε τα σημεία θλάσης, βρίσκουμε την \( A(s) = \frac{k(s+2)}{s^2+6s+25} \)
(συνάρτηση μεταφοράς ανοιχτού βρόχου), και υπολογίζουμε τις λύσεις της εξίσωσης
\( \displaystyle \od{L(s)}{s} \), όπου \( L(s) = \frac{s+2}{s^2+6s+25} \):
\[
\od{L(s)}{s} = 0 \iff
\frac{(s^2+6s+25) - (2s+6)(s+2)}{(\cdots)^2} = 0
\iff -s^2-4s+13 = 0
\iff s= -6.12 \text{ ή } \cancel{2.12}
\]
αφού απορρίψαμε τη λύση \( 2.12 \) που βρίσκεται εκτός του γεωμετρικού τόπου.

Για να έχουμε ελάχιστο χρόνο αποκατάστασης, το ιδανικό θα ήταν να φτάσει ένας πόλος στο
\( -2 \), έτσι ώστε να εξουδετερωθεί με το μηδενικό. Όπως παρατηρούμε από το γεωμετρικό
τόπο ριζών, αυτό γίνεται για μεγάλα \( k \). Όμως από την εκφώνηση έχουμε έναν περιορισμό
για τα \( k \), για τα οποία πρέπει \( k\leq 15 \), επομένως δεν μπορούν να είναι αυθαίρετα
μεγάλα.

Πράγματι, για \( k=15 \), η χαρακτηριστική εξίσωση του συστήματος είναι \( s^2+21s+55 = 0 \)
με ρίζες \( -17.93 \) και \( -3.66 \), από τις οποίες καμία δεν είναι κοντά στο \( -2 \).

Επομένως θα πρέπει να τοποθετήσουμε τους πόλους στο σημείο θλάσης, όπου ο κυρίαρχος
πόλος έχει τη μικρότερη τιμή, άρα έχουμε το μικρότερο χρόνο αποκατάστασης.
Για να βρούμε το \( k \) σε εκείνη τη θέση, λύνουμε
την εξίσωση \( 1+kL(s) = 0 \iff k(s) = -\frac{1}{L(s)} \):
\[
k'=\left. - \frac{1}{L(s)}\right|_{s=-6.12}
= \left. -\frac{s^2+6s+25}{s+2}\right|_{s=-6.12}
= \underline{6.24}.
\]

\item Θυμόμαστε ότι \( t_s = \frac{4}{σ} \), όπου ο κυρίαρχος πόλος του
συστήματος κλειστού βρόχου είναι \( -σ-j\omega  \), δηλαδή:
\[
t_s < 0.5 \implies \frac{4}{σ} < 0.5 \implies \underline{σ > 8}.
\]

Έχουμε ήδη μηδενικό στο -2, οπότε σκεφτόμαστε να τοποθετήσουμε έναν πόλο στην ίδια θέση
ώστε να εξουδετερωθούν και να μην επηρεάζουν το χρόνο αποκατάστασης.
Υπολογίζουμε τη συνάρτηση μεταφοράς κλειστού βρόχου για να το επιβεβαιώσουμε αυτό, δεδομένης
της συνάρτησης μεταφοράς ανοιχτού βρόχου \( k\frac{s+z}{s+p} \frac{s+2}{s^2+6s+25} \):
\begin{align*}
H_{\text{κ}}
&= \frac{k(s+z)(s+2)}{(s+p)(s^2+6s+25)+k(s+2)(s+z)}
\intertext{Αν θέσω \( p=2 \):}
&= \frac{k(s+z)(s+2)}{(s+2)\left[ (s^2+6s+25)+k(s+z) \right]}
\end{align*}
Οπότε όντως το \( (s+2) \) του αριθμητή εξουδετερώνεται με το \( (s+2) \)
του παρονομαστή.

Επομένως θέτουμε:
\(
\boxed{\begin{aligned}
	z&=8\\p&=2
	\end{aligned}}
\)
και ο γεωμετρικός τόπος ριζών γίνεται:

\begin{tikzpicture}
\draw[->] (-5,0) -- (2,0) node[right] {$\Re$};
\draw[->] (0,-2) -- (0,2) node[left] {$\Im$};

\coordinate (p1) at (-0.5,0);
\coordinate (p2) at (-1,1.5);
\coordinate (p3) at (-1,-1.5);
\coordinate (p4) at (-2.5,0);
\coordinate (b1) at (-3.5,0);

\draw[gray,dashed] (p2 -| 0,0) node[right] {$j4$} -- (p2) -- (p3) node[midway,above] {$-3$} -- (p3 -| 0,0) node[right] {$-j4$};

\draw[magenta!50!red,densely dashed] (p4 |- 0,-1.5) -- (p4 |- 0,1.5);

\begin{scope}[locus,ultra thick]
\draw[postaction={decorate},
decoration={markings,
	mark=at position 0.15 with {\arrow{>}},%
	mark=at position 0.85 with {\arrow{<}},%
}]
plot [smooth,tension=.9] coordinates {(p2) (-1.8,2) (b1) (-1.8,-2) (p3)}
;

\draw[postaction={decorate},
decoration={markings,
	mark=at position 0.20 with {\arrow{<}},%
	mark=at position 0.70 with {\arrow{>}},%
}]
(p4) -- (current bounding box.west |- 0,0)
;
\end{scope}

\begin{scope}[ultra thick,blue!50!magenta]
\clip (p4 |- 0,-1.5) ++ (-0.6,0) rectangle (p4 |- 0,1.5);
\draw[postaction={decorate},
decoration={markings,
	mark=at position 0.32 with {\arrow{>}},%
	mark=at position 0.70 with {\arrow{<}},%
}]
plot [smooth,tension=.9] coordinates {(p2) (-1.8,2) (b1) (-1.8,-2) (p3)}
;
\end{scope}

\draw (p1) node[locuspole] {};
\draw (p1) node[locuszero=$-2$,fill opacity=.4] {};
\draw (p2) node[locuspole] {};
\draw (p3) node[locuspole] {};
\draw (p4) node[locuszero=$-8$] {};
\draw (b1) node[locusbreak] {};
\end{tikzpicture}

Παρατηρούμε βέβαια ότι λόγω του περιορισμού \( k \leq 15 \) υπάρχει ένα όριο στις
τιμές που μπορούμε να επιλέξουμε. Λύνουμε τη χαρακτηριστική εξίσωση:
\[
s^2 + \underbrace{(6+k)}_{2ζ\omega_n}s+25+8k = 0
\]

Πρέπει:
\[
\frac{4}{ζ\omega_n} < 0.5 \implies ζ\omega_n > 8
\implies \frac{6+k}{2} > 8 \implies \underline{k > 10}
\]

Αυθαίρετα θεωρούμε ότι \( \underline{k=14} \). Τότε όντως \( 2ζ\omega_n = 2+k=20 \implies
ζ\omega_n = 10 \), άρα τελικά:
\[
t_s = \frac{4}{10} = \underline{\SI{0.4}{\second}}.
\]

\end{enumlatin}

\hspace{0pt}

\end{exercise}

\begin{exercise}[Θέμα Εξετάσεων]
Ένας ελεγκτής προπόρευσης φάσης έχει συνάρτηση μεταφοράς:
\[
G_c(s) = KG_1(s)
\]
όπου:
\[
G_1(s) = \frac{τs+1}{aτs+1},\quad \text{με } 0<a<1
\]

\begin{enumgreekparen}
	\item Για \( a = 0.1 \), σχεδιάστε προσεγγιστικά τα διαγράμματα Bode πλάτους και φάσης
	για τον \( G_1 \).
	\item Είναι γνωστό ότι ο ελεγκτής αυτός προσθέτει φάση:
	\[
	\bar\phi \rightarrow \sin\bar\phi = \frac{1-a}{1+a}
	\]
	για \( \bar\omega = \frac{1}{τ\sqrt{a}} \).
	
	Βρείτε προσεγγιστικά το κέρδος στη συχνότητα \( \bar\omega = \frac{1}{τ\sqrt{a}} \) για
	\( a=0.1 \).
	\item Έστω το σύστημα:
	\[
	G(s) = \frac{4}{s(s+2)}
	\]
	
	\begin{tikzpicture}
	\tikzstyle{transfer}=[rectangle,draw,minimum width=12mm,minimum height=9mm]
	
	\draw (1.5,0) node[transfer] (h1) {$G_c(s)$};
	\draw (4,0) node[transfer] (h2) {$G(s)$};
	\draw (0,0) node[mixer,scale=.7] (mix) {};
	
	\draw[<-] (mix.west) node[above left] {$+$} -- ++(-1.5,0);
	\draw[->] (mix.east) -- (h1);
	\draw[->] (h1) -- (h2);
	\draw[->] (h2.east) -- +(1,0) node[midway] (fb) {};
	\draw[->] (fb.center) -- ++(0,-1.4)  -| (mix.south);
	\draw (mix.south) node[below right] {$-$};
	\end{tikzpicture}
	
	Προσδιορίστε το \( K \) έτσι ώστε η σταθερά σφάλματος ταχύτητας να είναι
	\( K_v = \SI{20}{\second^{-1}} \).
	\item Να σχεδιάσετε προσεγγιστικά το διάγραμμα Bode για τη συνάρτηση
	\( \displaystyle G(s) \), και βρείτε το περιθώριο φάσης της, \( \phi_M \).
	\item Να βρείτε τον ελεγκτή \( G_c \) που να μεταβάλλει τη φάση έτσι ώστε να έχουμε περιθώριο φάσης \( \bar{\phi_M} > \ang{50} \), και επιλέξτε τη συχνότητα
	\( \bar\omega  \) στην οποία πρέπει να τοποθετηθεί.
\end{enumgreekparen}

\tcblower
\begin{enumgreekparen}
	\item Η συνάρτηση μεταφοράς γίνεται:
	\[
	\frac{τs+1}{\frac{τ}{10}s+1}
	\]
	
	Σε αυτήν τη μορφή μπορούμε να σχεδιάσουμε το διάγραμμα Bode:
	
	\begin{tikzpicture}[scale=1,xscale=1.5]
	\pgfplotsset{
		/pgf/number format/freq/.style={fixed},
	}
	\def\phasedown{-4}
	\def\phaseextra{-2}
	
	%\draw (-1,1) node[orange!90!blue!80!black] {$\displaystyle \left|H_p\cdot H_c\right|_{\si{\decibel}}$};
	
	\draw[->] (-0.3,\phasedown+\phaseextra) -- (-0.3,3);
	\draw[->] (-0.3,0) -- (3.5,0) node[above] {$\omega$};
	
	\foreach \x in {0,1,2} {
		\draw[densely dotted] (\x,\phasedown) -- (\x,0);
	}
	
	\def\at{60}
	\draw[ultra thick,orange!90!blue!80!black]
	(-0.3,0) -- (1,0) node(c1) {}
	-- ++(1*\at:{1/cos(1*\at)}) node(c2) {} node[midway,above left] {+20 dB/dec}
	-- ++(1.5,0)
	;
	
	\foreach \p in {c1,c2} {
		\draw[densely dashed] (\p.center) -- (\p.center |- 0,0);
	}
	
	
	\foreach \x in {1,2} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$
			\sfrac{\pgfmathprintnumber[freq]\result}{\tau}%
			$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	\foreach \x in {0,1,2,3} {
		\pgfmathsetmacro\result{10^\x/10}
		\draw (\x,\phasedown-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$
			\sfrac{\pgfmathprintnumber[freq]\result}{\tau}%
			$} -- ++(0,0.2);
		%\draw[dashed] (\x,0) |- (0,\x*3/4);
	}
	
	\begin{scope}[yshift=\phasedown cm]
	%\draw (-1,-1) node[magenta,left] {$\phi$};
	\draw[->] (-0.3,0) -- (4.5,0);
	\def\at{30}
	
	\draw[thick,magenta,opacity=.2]
	(-0.3,0) -- ++ (0.3,0)
	-- ++(1*\at:{2/cos(1*\at)})
	-- ++(2,0)
	;
	
	\draw[ultra thick,magenta]
	(-0.3,0) -- ++ (0.3,0) node(c1) {}
	-- ++(1*\at:{1/cos(1*\at)}) node(c2) {} node[above,sloped,midway,scale=.9] {$\ang{45}$/dec}
	-- ++(1,0) node(c3) {}
	-- ++(-1*\at:{1/cos(1*\at)}) node(c4) {} node[sloped,rotate=9,above,midway,scale=.9] {$\ang{-45}$/dec}
	-- ++(1,0)
	;
	
	\foreach \p in {c1,c2,c3,c4} {
		\draw[dashed,gray] (\p.center) -- (\p.center |- 0,0);
	}
	
	\draw (c1 -| -0.3,0) node[left] {$\ang{0}$};
	\draw[dashed] (c2) -- (c2 -| -0.3,0) node[left] {$\ang{45}$};
	\end{scope}
	
	\end{tikzpicture}
	
	\item Έχουμε:
	\[
	\omega = \frac{1}{τ\sqrt{0.1}} = 3.16\frac{1}{τ} < 10\frac{1}{τ}
	\]
	Επομένως είμαστε ενδιάμεσα στις συχνότητες \( \sfrac{1}{τ} \) και \( \sfrac{10}{τ} \).
	
	Για να βρούμε το κέρδος, έχουμε:
	\[
	\left|G_1(s) \right|_{\omega = 3.16\frac{1}{τ}}
	\simeq \left| 3.16 \frac{1}{τ}τj + 1 \right| \approx 3.31
	\text{ ή } \SI{10.40}{\decibel}
	\]
	αφού στη θέση \( \frac{3.16}{τ} \) επιδρά μόνο το μηδενικό και όχι ο πόλος.
	\item
	Η συνάρτηση μεταφοράς ανοιχτού βρόχου είναι:
	\[
	A(s) = GG_c = K\frac{τs+1}{ατs+1}\frac{4}{s(s+2)}
	\]
	
	Έχουμε:
	\[
	K_v = \lim_{s\to 0} sA(s) = \frac{4K}{2} = 20
	\]
	Άρα \( \underline{K=10} \).
	\item
	Φέρνουμε τη συνάρτηση μεταφοράς στη μορφή:
	\[
	\frac{40}{2}\frac{1}{s\left( \frac{s}{2}+1 \right)}
	\]
	
	Το μόνιμο κέρδος σε \( \si{\decibel} \) είναι \( 20\log\frac{40}{2} \), και λόγω
	του ολοκληρωτή γίνεται \( 20\log20 - 20\log\omega \). Δηλαδή λόγω του μηδενικού
	το πλάτος μειώνεται ήδη από τη μηδενική συχνότητα. Αφού γνωρίζουμε ότι η επίδραση των
	υπόλοιπων πόλων ξεκινά από το \( 0.2 \), αυθαίρετα αποφασίζουμε να ξεκινήσουμε το
	διάγραμμα από τη συχνότητα \( 0.02 \), όπου το κέρδος είναι \( 20\log20-20\log0.02
	= \SI{60}{\decibel} \).
	
	Το διάγραμμα Bode είναι:
	
	\begin{tikzpicture}[scale=1,xscale=1.5]
	\pgfplotsset{
		/pgf/number format/freq/.style={fixed},
	}
	\def\phasedown{-3}
	\def\phaseextra{-3}
	\def\xshift{0}
	
	%\draw (-1,1) node[orange!90!blue!80!black] {$\displaystyle \left|H_p\cdot H_c\right|_{\si{\decibel}}$};
	
	\draw[->] (\xshift,\phasedown+\phaseextra) -- (\xshift,3);
	\draw[->,name path=xa] (\xshift,0) -- (4.5,0) node[above] {$\omega$};
	
	\foreach \x in {1,2,3} {
		\draw[densely dotted] (\x,\phasedown) -- (\x,0);
	}
	
	\def\at{32}
	\draw[ultra thick,orange!90!blue!80!black,name path=g]
	(0,2.5)
	-- ++(-1*\at:{2/cos(1*\at)}) node(c1) {} node[midway,above right] {-20 dB/dec} node[midway] (c0) {}
	-- ++(-2*\at:{1.8/cos(2*\at)}) node[near end,above right] {-40 dB/dec}
	;
	
	\draw (0,2.5) node[left] {$20\log20-20\log0,02$};
	\draw[dashed] (c0.center) -- (c0.center -| 0,0) node[left] {$\SI{40}{\decibel}$};
	\draw[dashed] (c1.center) -- (c1.center -| 0,0) node[left] {$\SI{20}{\decibel}$};
	
	\draw[name intersections={of=g and xa}]
	(intersection-1) node[circle,draw,fill=gray,inner sep=2pt,fill opacity=.5] (wc) {}
	(wc) node[above right] {$\omega_c$};
	
	\foreach \p in {c0,c1} {
		\draw[densely dashed] (\p.center) -- (\p.center |- 0,0);
	}
	
	
	\foreach \x in {0,1,2} {
		\pgfmathsetmacro\result{2*10^\x/100}
		\draw (\x,-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$
			\pgfmathprintnumber[freq]\result
			$} -- ++(0,0.2);
	}
	\foreach \x in {0,1,2,3} {
		\pgfmathsetmacro\result{2*10^\x/100}
		\draw (\x,\phasedown-0.1) node[below,fill=white,fill opacity=.75,text opacity=1] {$
			\pgfmathprintnumber[freq]\result
			$} -- ++(0,0.2);
	}
	
	\begin{scope}[yshift=\phasedown cm]
	%\draw (-1,-1) node[magenta,left] {$\phi$};
	\draw[->] (\xshift,0) -- (4.5,0);
	\def\at{40}
	
	\draw[ultra thick,magenta]
	(0,0) -- (1,0) node(c1) {}
	-- ++(-1*\at:{2/cos(1*\at)}) node(c3) {} node[above right,pos=.56,yshift=-4pt,scale=.9] {$\ang{-45}$/dec} node[midway] (c2) {}
	-- ++(1.5,0)
	;
	
	\foreach \p in {c1,c2,c3} {
		\draw[dashed,gray] (\p.center) -- (\p.center |- 0,0);
	}
	
	\draw (c1 -| -0.3,0);
	\draw[dashed] (c2) -- (c2 -| -0.3,0) node[left] {$\ang{-135}$};
	\draw[dashed] (c3) -- (c3 -| -0.3,0) node[left] {$\ang{-180}$};
	\end{scope}
	
	\end{tikzpicture}
	
	Παρατηρούμε ότι το \( \omega_c \) (συχνότητα όπου το κέρδος είναι \( \SI{0}{\decibel} \))
	βρίσκεται μεταξύ \( \SI{2}{\radian/\second} \) και \( \SI{20}{\radian/\second} \).
	
	Για να το υπολογίσουμε έχουμε:
	\[
	20\log20 - 20\log\omega_c - 20\log\frac{\omega}{2} = 0
	\iff \underline{\omega_c = \SI{6.48}{\radian/\second}}
	\]
	
	Άρα η φάση σε εκείνο το σημείο είναι:
	\begin{align*}
	\left.\phi\right|_{\omega=\omega_c} &= -\measuredangle (j\omega )
	-\measuredangle\left(\frac{j\omega }{2}+1\right)\\
	&= -\ang{90} - \tan^{-1}\left(\frac{6.48}{2}\right)
	= \ang{-162.8476}
	\end{align*}
	άρα τελικά:
	\[
	\underline{\theta_M = \ang{17.15}}
	\]
	
	\item Για τον ελεγκτή ισχύει:
	\[
	\left|G_c\right|_{\omega=\bar\omega} = \sqrt{\frac{1}{a} + 1}
	\]
	όπου για \( a=0.1 \), \( G_c = \sqrt{10} \).
	
	Με την αλλαγή των παραμέτρων του ελεγκτή, μεταβάλλεται και η συχνότητα \( \omega_c \)
	όπου το κέρδος της συνάρτησης είναι \( \SI{0}{\decibel} \). Αποφασίζουμε να τοποθετήσουμε
	τη συχνότητα \( \bar\omega \) του ελεγκτή στην \( \omega_c \).
	
	Γνωρίζουμε ότι \( \bar\omega = \frac{1}{τ\sqrt{a}} \). Από τη συνάρτηση μεταφοράς
	\( A(s) \), βρίσκουμε το σημείο στο οποίο το κέρδος είναι \( \SI{0}{\decibel} = 1 \)
	(για \( a=0.1 \)):
	\begin{align*}
	\left|A(s)\right|_{\omega=\omega_c} &= 1 \iff \\
		\left| 40\frac{τs+1}{0.1τs+1}\frac{1}{s(s+2)}\right|_{\omega=\omega_c=\bar\omega} &= 1\\
		\sqrt{10}\frac{40}{\sqrt{\omega^4-4\omega^2}}&=1 \implies
	\bar\omega = \omega_c = \SI{11.33}{\radian/\second}
	\end{align*}
	Τότε \( τ=\frac{1}{11.33\sqrt{0.1}}=0.279 \), και αν επαληθεύσουμε το διάγραμμα Bode
	παρατηρούμε ότι όντως επαληθεύεται η άσκηση, αφού ισχύει ότι \( \sin\phi = \frac{1-a}{1+a} \).
\end{enumgreekparen}
\end{exercise}

\newpage
\appendix

\section*{Παράρτημα}
\addcontentsline{toc}{section}{\protect\numberline{}Παράρτημα}

\phantomsection
\addcontentsline{toc}{subsection}{\protect\numberline{~}Ορισμοί}
\tcblistof[\subsection*]{defn}{Ορισμοί}

\phantomsection
\tcblistof[\subsection*]{thm}{Θεωρήματα}
\addcontentsline{toc}{subsection}{\protect\numberline{~}Θεωρήματα}

\pagebreak[4]

\begin{multicols}{2}[\phantomsection\subsection*{Τυπολόγιο}\addcontentsline{toc}{subsection}{\protect\numberline{~}Τυπολόγιο}{\footnotesize(\emph{δεν} επιτρέπεται στις εξετάσεις)}]
{\footnotesize
	\setlength{\abovedisplayskip}{2pt}
	%\setlength{\belowdisplayskip}{15pt}
	%\setlength{\abovedisplayshortskip}{0pt}
	%\setlength{\belowdisplayshortskip}{0pt}
	\setitemize{itemsep=-10pt,topsep=0pt,parsep=0pt,partopsep=0pt}
	%\setlength\itemsep{-15pt}
	\paragraph{Συναρτήσεις μεταφοράς}
	\begin{align*}
	H(s) &= \frac{K(s+z_1)\cdots(s+z_m)}{(s+p_1)\cdots(s+p_n)} \\
	H(s) &= \frac{G(1+s\tau_{n+1})\cdots(1+s\tau_{n+m})}{(1+s\tau_1)\cdots(1+s\tau_n)}
	\quad \text{όπου } G=\frac{kz_1\cdots z_m}{p_1\cdots p_m}
	\end{align*}
	\begin{align*}
	T(s) &= \frac{H}{1+HG} \\ T_d(s) &= \frac{1}{1+HG} \\ T_n(s) &= \frac{H}{1+HG}
	\\ y &= T\cdot r + T_d\cdot d + T_n\cdot n
	\end{align*}
	
	\paragraph{Σφάλματα (ΑΒ\(\to \)ΚΒ)}
	\[
	e(s) = r(s)-y(s)
	\]
	\begin{alignat*}{3}
	e_{ssp} = \frac{1}{1+K_p} && e_{ssv} = \frac{1}{K_v} && e_{ssa} = \frac{1}{K_a} \\
	K_p = \lim_{s\to 0}H(s) &&\quad K_v = \lim_{s\to 0}sH(s) && \quad K_a = \lim_{s\to 0}s^2H(s)\\
	\sfrac{1}{s} && \sfrac{1}{s^2} && \sfrac{1}{s^3}
	\end{alignat*}
	
	\paragraph{Πρωτοβάθμια συστήματα}
	\begin{alignat*}{2}
	\text{\tiny 10\%-90\% } && t_r &\approx 2.2τ \\
	\text{\tiny 98\% } && t_s &\approx 4τ
	\end{alignat*}
	\paragraph{Δευτεροβάθμια συστήματα}
	\[
	\frac{\omega_n^2}{(s+σ)^2 + \omega_d^2} = \frac{\omega_n^2}{s^2+2ζ\omega_n s +\omega_n^2}
	\]
	με ρίζες \( -σ \pm j\omega_d \).
	
	\begin{tabular}{cc}
		\(\displaystyle \begin{aligned}
		σ &= ζ\omega_n \\
		\omega_d &= \omega_n\sqrt{1-ζ^2}
		\end{aligned}\) & \(\displaystyle\
		\begin{cases}
		ζ < 1 & \text{ συζυγείς}\\ζ=1 & \text{ διπλός } \mathbb R\\ζ > 1 & \text{ δύο πόλοι } \mathbb{R}
		\end{cases}
		\)
	\end{tabular}
	\[
	\underset{ζ>1}{y(t)} = y_{\mathrm{ss}} \textstyle
	\left[
	1+\frac{p_1p_2}{p_1-p_2}
	\left(
	\frac{e^{p_1t}}{p_1}
	-
	\frac{e^{p_2t}}{p_2}
	\right)
	\right]
	\]\[ \underset{ζ < 1}{y(t)}= \textstyle
	y_{\mathrm{ss}}\left[
	1 - \frac{e^{-ζ\omega_nt}}{\sqrt{1-ζ^2}}
	\cdot \sin\left(\omega_d t + \tan^{-1}\frac{\sqrt{1-ζ^2}}{ζ}\right)
	\right]\]
	\subparagraph{Συζυγείς μιγαδικοί πόλοι}
	\begin{align*}
	t_s &\approx \frac{4}{ζ\omega_n}\\
	t_r &= \frac{π-θ}{\omega_d} \quad \text{(1\textsuperscript{η} φορά $y_{ss}$)} \\
	t_p &= \frac{π}{\omega_d}\\
	M_p &=
	e^{-
		\frac{ζπ}{\sqrt{1-ζ^2}}
	}
	= e^{-σ t_p} \\
	\cos θ &= ζ
	\end{align*}
	\paragraph{Περιθώρια}
	\textbf{Φάσης}: \( \ang{180} + \measuredangle A(j\omega_c) \)\quad (θέλω \(>0\))\\
	\textbf{Πλάτους}: Από κάτω προς τα πάνω στις \( \ang{-180} \)

	\columnbreak
	\setlength\parskip{-5pt}

	\paragraph{Bode}
	\subparagraph{Για ολοκληρωτή \(Gs^ν\)}
	\begin{align*}
	|H_0| &= 20\log G + 20ν\log ω \\
	\measuredangle &= ν\cdot 90\degree
	\end{align*}
	\subparagraph{Πρώτου βαθμού \(\frac{s}{ρ}+1\)}
	\begin{align*}
	|H_1| &= \begin{cases}
	0 \qquad & \text{αν } \omega < p \\
	20\log ω -20\log p \qquad & \text{αν } \omega > p
	\end{cases} \\
	\measuredangle &= \begin{cases}
	0\degree \qquad & \text{αν } \omega < 0.1p \\
	45\degree + 45\degree \log\frac{\omega}{p} \qquad & \text{αν } 0.1p < \omega < 10p \\
	90\degree \qquad & \text{αν } \omega > 10p
	\end{cases}
	\end{align*}
	\subparagraph{Δεύτερου βαθμού \( \frac{s^2}{\omega_n^2}+\frac{2ζs}{\omega_n}+1 \)}
	\begin{align*}
	|H_2| &=  \begin{cases}
	0&\qquad \text{αν } \omega < \omega_n \\
	40\log \omega - 40\log \omega_n &\qquad \text{αν } \omega > \omega_n
	\end{cases} \\
	\measuredangle &= \begin{cases}
	0\degree &\qquad \text{αν } \omega< 0.1\omega_n\\
	90\degree +90\degree\log\frac{\omega}{\omega_n} &\qquad 
	\text{αν }0.1\omega_n < \omega < 10\omega_n \\
	180\degree &\qquad \text{αν } \omega>10\omega_n
	\end{cases}\\
	\omega_b &= \omega_n \left[
	1-2ζ^2+\sqrt{2-4ζ^2+4ζ^4}
	\right]^{\sfrac{1}{2} }\\
	\omega_r &= \omega_n\sqrt{1-2ζ^2} \qquad ζ < 0.707\\
	M_r &= \frac{1}{2ζ\sqrt{1-ζ^2}}
	\end{align*}
	\paragraph{Nyquist  (ΑΒ\(\to \)ΚΒ)}
	\[
	N=Z-P
	\]
	(\(N\) ωρολογιακές περικυκλώσεις \(+1\), \(Z\) \textbf{α}σταθείς \textbf{π}όλοι \textbf{κ}λειστού, \( P\) \textbf{α}σταθείς \textbf{π}όλοι \textbf{α}νοιχτού) 
	\paragraph{Γ.Τ Ριζών  (ΑΒ\(\to \)ΚΒ)}
	\begin{itemize}
		\item Πλήθος πόλων = πλήθος κλάδων\\
		\item Πλήθος μηδενικών = πλήθος κλάδων \( \to \) μηδενικό \\
		\item Πόλοι \( - \) μηδενικά = κλάδοι \( \to\infty \) \\
		\item Τμήματα \(\mathbb R \) άξονα \( \ni \) \textbf{δεξιά} αφήνουν περιττούς \( \times \) \& \( \circ \)
		\vspace{-\itemsep}
		\item Ασύμπτωτες: \[
		\displaystyle \sigma_A = \frac{\sum pi - \sum z_i}{n-m}\qquad\theta_i=\frac{(2i+1)\cdot\ang{180}}{n-m}
		\]
		\vspace{2pt}
		\item Σημεία θλάσης:
		\[
		\od{H_p}{s} = 0 \qquad \text{ή} \qquad \od{k}{s} = 0
		\]
		\vspace{2pt}
		\item Γωνία αναχώρησης:
		\[
		\sum\measuredangle (s-z_i)-\sum\measuredangle(s-p_i) = \ang{180}
		\]
	\end{itemize}
	
	\paragraph{Χρήσιμες πληροφορίες}
	\begin{gather*}
	\tan^{-1}(x) + \tan^{-1}(y) = \tan^{-1} \left( \textstyle\frac{x+y}{1-xy} \right)	\\
	\left|\frac{A}{1+A}\right| \approx |A| \quad\text{για μικρά |A|}\\
	\left|\frac{1}{1+A}\right| \approx \frac{1}{|A|} \quad\text{για μεγάλα |A|}\\
	\end{gather*}
	}
\end{multicols}

\end{document}
